[
  {
    "title": "Abstract",
    "subsections": [
      {
        "content": "Federal Information Processing Standard 201-3 (FIPS 201-3) defines the requirements for Personal Identity Verification (PIV) life cycle activities, including identity proofing, registration, PIV Card issuance, and PIV Card usage. FIPS 201-3 also defines the structure of an identity credential that includes cryptographic keys. This document contains the technical specifications needed for the mandatory and optional cryptographic keys specified in FIPS 201-3, as well as the supporting infrastructure specified in FIPS 201-3 and the related NIST Special Publication (SP) 800-73, Interfaces for Personal Identity Verification, and SP 800-76, Biometric Specifications for Personal Identity Verification, which rely on cryptographic functions."
      },
      {
        "title": "1. Introduction",
        "content": [
          {
            "text": "Homeland Security Presidential Directive-12 (HSPD-12) mandated the creation of new standards for interoperable identity credentials for physical and logical access to Federal Government locations and systems. Federal Information Processing Standard 201 (FIPS 201), Personal Identity Verification (PIV) of Federal Employees and Contractors, was developed to establish standards for identity credentials [FIPS201]. This document, NIST Special Publication (SP) 800-78-5, specifies the cryptographic algorithms and key sizes for PIV systems and is a companion document to FIPS 201-3."
          },
          {
            "subsection": "1.1. Purpose",
            "text": []
          },
          {
            "text": "FIPS 201-3 defines the requirements for PIV life cycle activities, including identity proofing, registration, PIV Card issuance, and PIV Card usage. FIPS 201-3 also defines the structure of an identity credential that includes cryptographic keys. This document contains the technical specifications needed for the mandatory and optional cryptographic keys specified in FIPS 201-3, as well as the supporting infrastructure specified in FIPS 201-3 and the related SP 800-73, Interfaces for Personal Identity Verification [SP800-73], and SP 800-76, Biometric Specifications for Personal Identity Verification [SP800-76], which rely on cryptographic functions."
          },
          {
            "subsection": "1.2. Scope",
            "text": []
          },
          {
            "text": "The scope of this recommendation encompasses the PIV Card, infrastructure components that support issuance and management of the PIV Card, and applications that rely on the credentials supported by the PIV Card to provide security services. This recommendation identifies acceptable symmetric and asymmetric encryption algorithms, digital signature algorithms, key establishment schemes, and message digest algorithms and specifies mechanisms to identify the algorithms associated with PIV keys or digital signatures. Algorithms and key sizes have been selected for consistency with applicable federal standards and to ensure adequate cryptographic strength for PIV applications."
          },
          {
            "subsection": "1.3. Audience and Assumptions",
            "text": []
          },
          {
            "text": "This document is intended for federal agencies and implementers of PIV systems. Readers are# Assumed Knowledge"
          },
          {
            "text": "Assumed to have a working knowledge of cryptography and public key infrastructure (PKI) technology."
          }
        ]
      },
      {
        "title": "1. Document Overview",
        "content": [
          {
            "text": "The document is organized as follows:"
          },
          {
            "text": "Section 1, Introduction, provides the purpose, scope, audience, and assumptions of the document and outlines its structure.\nSection 2, Application of Cryptography in FIPS 201-3, identifies the cryptographic mechanisms and objects that employ cryptography, as specified in FIPS 201-3 and its supporting documents.\nSection 3, On-Card Cryptographic Requirements, describes the cryptographic requirements for cryptographic keys and authentication information stored on the PIV Card.\nSection 4, Certificate Status Information, describes the cryptographic requirements for status information generated by PKI certification authorities (CA) and Online Certificate Status Protocol (OCSP) responders.\nSection 5, PIV Card Application Administration Keys, describes the cryptographic requirements for managing information stored on the PIV Card.\nSection 6, Identifiers for PIV Card Interfaces, specifies key reference values and algorithm identifiers for the application programming interface and card commands defined in [SP800-73].\nSection 7, Cryptographic Algorithm Validation Testing Requirements, specifies the cryptographic algorithm validation testing that must be performed on the PIV Card based on the keys and algorithms that it supports.\nThe References section contains the list of documents used as references in this recommendation.\nAppendix A, List of Symbols, Abbreviations, and Acronyms, contains the list of acronyms used in this document.\nAppendix B, Change Log, describes the changes made to SP 800-78 since its initial release."
          }
        ]
      },
      {
        "title": "2. Application of Cryptography in FIPS 201-3",
        "content": [
          {
            "text": "FIPS 201-3 employs cryptographic mechanisms to authenticate cardholders, secure information stored on the PIV Card, and secure the supporting infrastructure. FIPS 201-3 and its supporting documents specify a suite of keys to be stored on the PIV Card for personal identity verification, digital signature generation, and key management. The PIV cryptographic keys specified in FIPS 201-3 and SP 800-73 are:"
          },
          {
            "text": "The asymmetric PIV Authentication key,\nAn asymmetric Card Authentication key,\nA symmetric Card Authentication key (deprecated),\nAn asymmetric digital signature key for signing documents and messages,\nAn asymmetric key management key that supports key establishment or key transport and up to 20 retired key management keys,\nA symmetric PIV Card Application Administration Key, and\nAn asymmetric PIV Secure Messaging key that supports the establishment of session.# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "keys for use with secure messaging and cardholder authentication using the SM-AUTH",
        "content": [
          {
            "text": "authentication mechanism as defined in [SP800-73]. The cryptographic algorithms, key sizes, and parameters that may be used for these keys are specified in Sec. 3.1. PIV Cards must implement private key computations for one or more of the algorithms identified in this section."
          },
          {
            "text": "Cryptographically protected objects specified in FIPS 201-3, SP 800-73, and SP 800-76 include:"
          },
          {
            "text": "The X.509 certificates for each asymmetric key on the PIV Card, except for the PIV Secure Messaging key,\nA secure messaging card verifiable certificate (CVC) for the PIV Secure Messaging key,\nAn Intermediate CVC for the public key needed to verify the signature on the secure messaging CVC,\nA digitally signed Card Holder Unique Identifier (CHUID),\nDigitally signed biometrics using the Common Biometric Exchange Formats Framework (CBEFF) signature block, and\nThe SP 800-73 Security Object, which is a digitally signed hash table."
          },
          {
            "text": "Sec. 3.2 specifies the cryptographic algorithms, key sizes, and parameters that may be used to protect these objects. Certification authorities (CA) and card management systems that protect these objects must support one or more of the cryptographic algorithms, key sizes, and parameters specified in Sec. 3.2."
          },
          {
            "text": "Applications may be designed to use any or all of the cryptographic keys and objects stored on the PIV Card. Where maximum interoperability is required, applications should support all of the identified algorithms, key sizes, and parameters specified in Sec. 3.1 and 3.2."
          },
          {
            "text": "FIPS 201-3 requires CAs and Online Certificate Status Protocol (OCSP) responders to generate and distribute digitally signed certificate revocation lists (CRL) and OCSP status messages, respectively. These certificate status mechanisms support validation of the PIV Card, the PIV cardholder, the cardholder's digital signature key, and the cardholder's key management key."
          },
          {
            "text": "The signed certificate status mechanisms specified in FIPS 201-3 are:"
          },
          {
            "text": "X.509 CRLs that specify the status of a group of X.509 certificates and\nOCSP status response messages that specify the status of a particular X.509 certificate."
          },
          {
            "text": "The cryptographic algorithms, key sizes, and parameters that may be used to sign these mechanisms are specified in Sec. 4, which also describes rules for encoding the signatures to ensure interoperability."
          },
          {
            "text": "FIPS 201-3 permits optional card management operations. These operations may only be performed after the PIV Card authenticates the card management system. Card management systems are authenticated through the use of PIV Card Application Administration Keys. The cryptographic algorithms and key sizes that may be used for these keys are specified in Sec. 5."
          }
        ]
      },
      {
        "title": "3. On-Card Cryptographic Requirements",
        "content": [
          {
            "text": "FIPS 201-3 identifies a suite of objects that are stored on the PIV Card for use in authentication.# Mechanisms or Other Security Protocols"
          },
          {
            "text": "These objects may be divided into three classes: cryptographic keys, signed authentication information stored on the PIV Card, and message digests of information stored on the PIV Card. Cryptographic requirements for PIV keys are detailed in Sec. 3.1. Cryptographic requirements for other stored objects are detailed in Sec. 3.2."
          }
        ]
      },
      {
        "title": "3.1. PIV Cryptographic Keys",
        "content": [
          {
            "text": "FIPS 201-3 and SP 800-73 specify six types of cryptographic keys to be used as credentials by the PIV cardholder:"
          },
          {
            "text": "The mandatory PIV Authentication key,\nThe mandatory asymmetric Card Authentication key,\nAn optional symmetric Card Authentication key (deprecated),\nA conditionally mandatory digital signature key,\nA conditionally mandatory key management key, and\nAn optional asymmetric key to establish session keys for secure messaging and to authenticate the cardholder using the SM-AUTH authentication mechanism."
          },
          {
            "text": "All cryptographic algorithms employed shall provide at least 112 bits of security strength. Cryptographic keys that will remain in use after 2030 should provide 128 bits of security strength. Federal departments and agencies should consider potential cryptographic key length migrations as part of their moderate to long-term cryptographic transition and modernization plans, including the need to plan and invest for a future migration to post-quantum algorithms. Capital investments for PIV issuance and relying party systems should be selected with an emphasis on ensuring a timely migration to post-quantum algorithms once standards, technologies, and services are available. If a migration to longer cryptographic keys would require significant resources or infrastructure upgrades, federal departments and agencies may elect to defer these improvements until the post-quantum migration. Post-quantum algorithms will be specified in a future revision of this document once foundational standards supporting their use have been adopted."
          },
          {
            "text": "Table 1 establishes specific requirements for cryptographic algorithms and key sizes for each key type. In addition to the key sizes, keys must be generated using secure parameters. Rivest-Shamir-Adleman (RSA) keys must be generated using a public exponent of 65537. Elliptic curve keys must correspond to one of the following recommended curves from [FIPS186]:"
          },
          {
            "text": "Curve P-256 or\nCurve P-384."
          },
          {
            "text": "Elliptic curve keys are a faster option than RSA-based keys for the Card Authentication key for physical access since elliptic curve private key computation time is significantly shorter than RSA-based private key computation time. There is no phaseout date specified for either curve. If the PIV Card Application supports the virtual contact interface [SP800-73] and the digital signature key, the key management key, or any of the retired key management keys are elliptic curve keys that correspond to Curve P-384, then the PIV Secure Messaging key shall use P-384. Otherwise, it may use P-256 or P-384.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "While this specification requires that the RSA public exponent associated with PIV keys be 65537, applications should be able to process RSA public keys that have any public exponent that is an odd positive integer greater than or equal to 65537 and less than 2256. This specification requires the key management key to be an RSA key transport key or an Elliptic Curve Diffie-Hellman (ECDH) key. The specifications for RSA key transport are [PKCS1] and [SP800-56B], and the specification for ECDH key agreement is [SP800-56A]."
          }
        ]
      },
      {
        "title": "3.2. Authentication Information Stored on the PIV Card",
        "content": [
          {
            "subsection": "3.2.1. Specification of Digital Signatures on Authentication Information",
            "text": []
          },
          {
            "text": "FIPS 201-3 requires the use of digital signatures to protect the integrity and authenticity of information stored on the PIV Card. FIPS 201-3 and SP 800-73 require digital signatures on the following objects stored on the PIV Card:"
          },
          {
            "text": "X.509 public key certificates,\nThe optional secure messaging card verifiable certificate (CVC),\nThe optional intermediate CVC,\nThe CHUID,\nBiometric information (e.g., fingerprints), and\nThe SP 800-73-4 Security Object."
          },
          {
            "text": "Approved digital signature algorithms are specified in [FIPS186]. Table 2 provides specific requirements for public key algorithms as well as key sizes, hash algorithms, and padding schemes for generating digital signatures for digitally signed information stored on the PIV Card. Agencies are cautioned that generating digital signatures with elliptic curve algorithms may initially limit interoperability."
          },
          {
            "text": "RSA signatures may use either the PKCS #1 v1.5 padding scheme or the Probabilistic Signature Scheme (PSS) padding, as specified in [FIPS186] through reference to [PKCS1]. The PSS padding scheme object identifier (OID) is independent of the hash algorithm. The hash algorithm is specified as a parameter [PKCS1]."
          },
          {
            "text": "The secure messaging CVC shall be signed using ECDSA (Curve P-256) with SHA-256 if it contains an ECDH (Curve P-256) subject public key and shall be signed using ECDSA (Curve P-384) with SHA-384 otherwise. The Intermediate CVC shall be signed using RSA with SHA-256 and PKCS #1 v1.5 padding."
          },
          {
            "text": "FIPS 201-3, SP 800-73, and SP 800-76 specify formats for the CHUID, the Security Object, the biometric information, and X.509 public key certificates, which rely on OIDs to specify which signature algorithm was used to generate the digital signature. The object identifiers specified in Table 3 must be used in FIPS 201-3 implementations to identify the signature algorithm."
          },
          {
            "subsection": "3.2.2. Specification of Public Keys in X.509 Certificates",
            "text": []
          },
          {
            "text": "FIPS 201-3 requires the generation and storage of an X.509 certificate to correspond with each asymmetric private key contained on the PIV Card, except for the PIV Secure Messaging key. X.509 certificates include object identifiers to specify the cryptographic algorithm associated with a public key. Table 4 specifies the object identifiers that may be used in certificates to# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "Indicate the algorithm for a subject public key.",
        "content": [
          {
            "text": "A single object identifier is specified in Table 4 for all elliptic curve keys. An additional object identifier must be supplied in a parameters field to indicate the elliptic curve associated with the key. Table 5 identifies the named curves and associated OIDs."
          }
        ]
      },
      {
        "title": "3.2.3. Specification of Message Digests in the SP 800-73-4 Security Object",
        "content": [
          {
            "text": "SP 800-73 mandates the inclusion of a Security Object consistent with the Authenticity/Integrity Code defined by the International Civil Aviation Organization (ICAO) in [MRTD]. This object contains message digests of other digital information stored on the PIV Card and is digitally signed. This specification requires that the message digests of digital information be computed using the same hash algorithm used to generate the digital signature on the Security Object. The set of acceptable algorithms is specified in Table 2. The Security Object format identifies the hash algorithm used when computing the message digests by including an object identifier. The appropriate object identifiers are identified in Table 6."
          }
        ]
      },
      {
        "title": "4. Certificate Status Information",
        "content": [
          {
            "text": "The FIPS 201-3 functional component PIV Card Issuance and Management Subsystem generates and distributes status information for PIV asymmetric keys other than PIV Secure Messaging keys. FIPS 201-2 mandates two formats for certificate status information:\n1. X.509 CRLs and\n2. OCSP status response messages."
          },
          {
            "text": "The CRLs and OCSP status responses shall be digitally signed to support authentication and integrity using a key size and hash algorithm that satisfy the requirements for signing PIV information, as specified in Table 2, and that are at least as large as the key size and hash algorithm used to sign the certificate. CRLs and OCSP messages rely on object identifiers to specify which signature algorithm was used to generate the digital signature. The object identifiers specified in Table 3 must be used in CRLs and OCSP messages to identify the signature algorithm."
          }
        ]
      },
      {
        "title": "5. PIV Card Application Administration Keys",
        "content": [
          {
            "text": "PIV Cards may support card activation by the card management system to support card personalization and post-issuance card updates. PIV Cards that support card personalization and post-issuance updates perform a challenge-response protocol using a symmetric cryptographic key (i.e., the PIV Card Application Administration Key) to authenticate the card management system. After successful authentication, the card management system can modify information stored on the PIV Card. Table 7 establishes specific requirements for cryptographic algorithms and key sizes for PIV Card Application Administration Keys."
          }
        ]
      },
      {
        "title": "6. Identifiers for PIV Card Interfaces",
        "content": [
          {
            "text": "SP 800-73 defines an application programming interface, the PIV Client Application Programming Interface (Part 3), and a set of mandatory card commands, the PIV Card Application Card Command Interface (Part 2). The command syntaxes for these interfaces identify PIV keys using one-byte key references, and their associated algorithms.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "(or suites of algorithms) are specified using one-byte algorithm identifiers. The same identifiers are used in both interfaces."
          }
        ]
      },
      {
        "title": "6.1 Key Reference Values",
        "content": [
          {
            "text": "A PIV Card key reference is a one-byte identifier that specifies a cryptographic key according to its PIV Key Type. Table 8 defines the key reference values used on the PIV interfaces for PIV Key Types."
          }
        ]
      },
      {
        "title": "6.2 PIV Card Algorithm Identifiers",
        "content": [
          {
            "text": "A PIV Card algorithm identifier is a one-byte identifier that specifies a cryptographic algorithm and key size or a suite of algorithms and key sizes. For symmetric cryptographic operations, the algorithm identifier also specifies a mode of operation (i.e., ECB). Table 9 lists the algorithm identifiers for the cryptographic algorithms that may be recognized on the PIV interfaces. All other algorithm identifier values are reserved for future use."
          },
          {
            "text": "Note that 3 Key Triple DES \u2013 ECB with identifier '00' and '03' is deprecated and will be removed in the next revision of this document."
          },
          {
            "text": "Algorithm identifiers '27' and '2E' represent suites of algorithms and key sizes for use with secure messaging and key establishment. Cipher Suite 2 (CS2) is used to establish session keys and for secure messaging when the PIV Secure Messaging key is an ECDH (Curve P-256) key. Cipher Suite 7 (CS7) is used to establish session keys and for secure messaging when the PIV Secure Messaging key is an ECDH (Curve P-384) key. Details of secure messaging, the key establishment protocol, and the algorithms and key sizes for these two cipher suites are specified in SP 800-73-4, Part 2."
          }
        ]
      },
      {
        "title": "6.3 Algorithm Identifiers for PIV Key Types",
        "content": [
          {
            "text": "Table 10 summarizes the set of algorithms supported for each key reference value. All cryptographic algorithms employed shall provide at least 112 bits of security strength. Cryptographic keys that will remain in use after 2030 should provide 128 bits of security strength. Federal departments and agencies should consider potential cryptographic key length migrations as part of their moderate to long-term cryptographic transition and modernization plans, including the need to plan and invest for a future migration to post-quantum algorithms. Capital investments for PIV issuance and relying party systems should be selected with an emphasis on ensuring a timely migration to post-quantum algorithms once standards, technologies, and services are available. If a migration to longer cryptographic keys would require significant resources or infrastructure upgrades, federal departments and agencies may elect to defer these improvements until the post-quantum migration. Post-quantum algorithms will be specified in a future revision of this document.# once foundational standards supporting their use have been adopted."
          }
        ]
      }
    ]
  }
]