[
  {
    "title": "Executive Summary",
    "subsections": [
      {
        "content": "A wireless local area network (WLAN) enables access to computing resources for devices that are not physically connected to a network. WLANs typically operate over a fairly limited range, such as an office building or building campus, and usually are implemented as extensions to existing wired local area networks to enhance user mobility. This guide seeks to assist organizations in better understanding the most commonly used family of standards for WLANs\u2014Institute of Electrical and Electronics Engineers (IEEE) 802.11\u2014focusing on the security enhancements introduced in the IEEE 802.11i amendment. In particular, this guide explains the security features and provides specific recommendations to ensure the security of the operating environment."
      },
      {
        "content": "Before IEEE 802.11i was finalized, IEEE 802.11 relied on a security method known as Wired Equivalent Privacy (WEP), which has several well-documented security problems. The IEEE 802.11i amendment introduces a range of new security features that are designed to overcome the shortcomings of WEP. It introduces the concept of a Robust Security Network (RSN), which is defined as a wireless security network that allows the creation of Robust Security Network Associations (RSNA) only. RSNAs are wireless connections that provide moderate to high levels of assurance against WLAN security threats through use of a variety of cryptographic techniques. This guide describes the operation of RSNs, including the steps needed to establish an RSNA and the flows of information between RSN components."
      },
      {
        "content": "The three types of RSN components are stations (STA), which are wireless endpoint devices such as laptops and wireless handheld devices (e.g. PDAs, text messaging devices and smart phones); access points (AP), which are network devices that allow STAs to communicate wirelessly and to connect to another network, typically an organization's wired infrastructure; and authentication servers (AS), which provide authentication services to STAs. STAs and APs are also found in pre-RSN WLANs, but ASs are a new WLAN component introduced by the RSN framework."
      },
      {
        "content": "NIST recommends that Federal agencies implement the following recommendations to assist in establishing and maintaining robust security for their IEEE 802.11i-based WLANs. Personnel responsible for their implementation and maintenance should read the corresponding sections of the document to ensure they have an adequate understanding of important related issues."
      },
      {
        "content": "This publication covers IEEE 802.11i-based wireless LANs only. It does not replace NIST Special Publication (SP) 800-48, Wireless Network Security: 802.11, Bluetooth and Handheld Devices, which addresses IEEE 802.11b and 802.11g-based wireless LANs, Bluetooth implementations, and wireless handheld devices (e.g., text messaging devices, PDAs, smart phones). Organizations with existing IEEE 802.11b or 802.11g implementations should continue to use the recommendations in SP 800-48 to secure them; they should also review this publication to understand the new IEEE 802.11i technology and how it.# Current Page Raw OCR Text"
      },
      {
        "title": "Overview",
        "content": [
          {
            "text": "Addresses the shortcomings of the Wired Equivalent Privacy (WEP) protocol used to secure IEEE 802.11b and 802.11g networks. Organizations that are considering the deployment of new wireless LANs should be evaluating IEEE 802.11i-based products and following the recommendations for IEEE 802.11i implementations in this publication."
          },
          {
            "text": "Organizations should ensure that all WLAN components use Federal Information Processing Standards (FIPS)-approved cryptographic algorithms to protect the confidentiality and integrity of WLAN communications."
          }
        ]
      },
      {
        "title": "IEEE 802.11i Amendment",
        "content": [
          {
            "text": "The IEEE 802.11i amendment defines two data confidentiality and integrity protocols for RSNAs: Temporal Key Integrity Protocol (TKIP) and Counter Mode with Cipher Block Chaining Message Authentication Code Protocol (CCMP). This guide discusses both protocols at length, as well as the cryptographic keys created and used by these protocols. Federal agencies are required to use FIPS-approved cryptographic algorithms that are contained in FIPS-validated cryptographic modules."
          },
          {
            "text": "Of WEP, TKIP, and CCMP, only CCMP uses a core cryptographic algorithm that is FIPS-approved, the Advanced Encryption Standard (AES). For other security features, CCMP offers stronger assurance than WEP and TKIP. Accordingly, NIST requires the use of CCMP for securing Federal agencies' IEEE 802.11-based WLANs. For legacy IEEE 802.11 equipment that does not provide CCMP, auxiliary security protection is required; one possibility is the use of an IPsec VPN, using FIPS-approved cryptographic algorithms. NIST SP 800-48 contains specific recommendations for securing legacy IEEE 802.11 implementations."
          }
        ]
      },
      {
        "title": "EAP Methods",
        "content": [
          {
            "text": "Organizations should select IEEE 802.11 RSN authentication methods for their environment carefully. IEEE 802.11 RSN uses the Extensible Authentication Protocol (EAP) for the authentication phase of establishing an RSNA. EAP supports a wide variety of authentication methods, also called EAP methods. They include authentication based on passwords, certificates, smart cards, and tokens. EAP methods also can include combinations of authentication techniques, such as a certificate followed by a password, or the option of using either a smart card or a token. This flexibility allows EAP to integrate with nearly any environment to which a WLAN might connect. Organizations have considerable discretion in choosing which EAP methods to employ; a poor EAP method choice or implementation could seriously weaken an IEEE 802.11 RSN's protections."
          },
          {
            "text": "Because of the extensible nature of EAP, dozens of EAP methods exist, and others are being developed continually. However, many EAP methods do not satisfy the necessary security requirements for WLANs; for example, EAP methods that do not generate cryptographic keying material cannot be used for WLANs. In general, the current EAP methods that can satisfy WLAN security requirements are based on the Transport Layer Security (TLS) protocol. A primary distinction between TLS-based EAP methods...# Current Page Raw OCR Text"
          }
        ]
      },
      {
        "title": "Public Key Infrastructure (PKI) Support",
        "content": [
          {
            "text": "is the level of public key infrastructure (PKI) support required; the EAP-TLS method requires an enterprise PKI implementation and certificates deployed to each STA, while most other TLS methods require certificates on each AS only. Organizations should use the EAP-TLS method whenever possible."
          }
        ]
      },
      {
        "title": "EAP Methods and Standards",
        "content": [
          {
            "text": "Because some EAP methods are not yet official standards and new methods are being developed, organizations are encouraged to obtain the latest available information on EAP methods and standards when planning an IEEE 802.11 RSN implementation. Additionally, organizations should ensure that the cryptographic modules implementing the TLS algorithm for each product under consideration are FIPS-validated."
          }
        ]
      },
      {
        "title": "WLAN Equipment Selection",
        "content": [
          {
            "text": "Before selecting WLAN equipment, organizations should review their existing identity management infrastructure, authentication requirements, and security policy to determine the EAP method or methods that are most appropriate in their environments, then purchase systems that support the chosen EAP methods, and implement and maintain them carefully. This publication provides detailed guidance on planning EAP implementations. It discusses the most common EAP methods, explains how organizations can select EAP methods, and examines additional EAP security considerations. Organizations should integrate their existing authentication technology with their IEEE 802.11 RSN WLAN to the extent feasible."
          }
        ]
      },
      {
        "title": "Pre-Shared Keys (PSK) vs. IEEE 802.1X and EAP",
        "content": [
          {
            "text": "Although the RSN framework supports the use of pre-shared keys (PSK), organizations should choose to implement the IEEE 802.1X standard and EAP for authentication instead of using PSKs because of the resources needed for proper PSK administration and the security risks involved. IEEE 802.1X and EAP authentication requires an organization to use an AS, which may necessitate the use of a PKI. An organization that already has ASs for Web, e-mail, file and print services, and other authentication needs, should consider integrating this technology into its RSN solution. Most leading network operating systems and directory solutions offer the support needed for RSN integration."
          }
        ]
      },
      {
        "title": "Communication Security",
        "content": [
          {
            "text": "Organizations should ensure that the confidentiality and integrity of communications between access points and authentication servers are protected sufficiently. The data confidentiality and integrity protocol (such as CCMP) used by an IEEE 802.11 RSN protects communications between STAs and APs. However, IEEE 802.11 and its related standards explicitly state that protection of the communications between the AP and AS is out of their scope. Therefore, organizations deploying RSNs should ensure that communications between each AP and its corresponding ASs are protected sufficiently through cryptography. Also, because of the importance of the ASs, organizations should pay particular attention to establishing and maintaining their security through operating system configuration, firewall rules, and other security controls."
          }
        ]
      },
      {
        "title": "Security Certification",
        "content": [
          {
            "text": "Organizations establishing IEEE 802.11 RSNs should use technologies that have the appropriate security certification from NIST and interoperability certification from the Wi-Fi Alliance. To implement IEEE 802.11 RSNs, organizations may need to update or replace existing IEEE 802.11.# WLAN Security Considerations"
          },
          {
            "text": "Equipment and software that cannot support RSNAs, as well as purchase additional equipment. The Wi-Fi Alliance, a non-profit industry consortium of WLAN equipment and software vendors, has established the Wi-Fi Protected Access 2 (WPA2) certification program to give consumers of WLAN products assurance that their IEEE 802.11i systems can interoperate with similar equipment from other vendors. Federal agencies should procure WPA2 products that use FIPS-approved encryption algorithms and have been FIPS-validated. Organizations that plan to use authentication servers as part of their IEEE 802.11 RSN implementations should procure products with the WPA2 Enterprise level certification. Also, because the WPA2 certification is expanded periodically to test for interoperability with additional EAP methods, organizations should obtain the latest WPA2 information before making procurement decisions."
          },
          {
            "text": "Organizations should ensure that WLAN security considerations are incorporated into each phase of the WLAN life cycle when establishing and maintaining IEEE 802.11 RSNs. This guide presents extensive guidance on IEEE 802.11 RSN planning and implementation. It describes a life cycle model for WLANs and presents best practice recommendations related to WLAN security for each phase in the life cycle. WLAN security considerations for each phase include the following:"
          }
        ]
      },
      {
        "title": "Phase 1: Initiation",
        "content": [
          {
            "text": "This phase includes the tasks that an organization should perform before it starts to design its WLAN solution. These include developing a WLAN use policy, performing a WLAN risk assessment, and specifying business and functional requirements for the solution, such as mandating RSNAs for all WLAN connections."
          }
        ]
      },
      {
        "title": "Phase 2: Acquisition/Development",
        "content": [
          {
            "text": "For the purposes of this guide, the Acquisition/Development phase is split into the following two phases:"
          },
          {
            "subsection": "Phase 2a: Planning and Design",
            "text": []
          },
          {
            "text": "In this phase, WLAN network architects specify the technical characteristics of the WLAN solution, such as authentication methods, and related network components, such as firewall rulesets. The WLAN network architects should also conduct a site survey to help determine the architecture of the solution and how the WLAN should be integrated with the existing authentication infrastructure, including PKI."
          },
          {
            "subsection": "Phase 2b: Procurement",
            "text": []
          },
          {
            "text": "This phase involves specifying the number and type of WLAN components that must be purchased, the feature sets they must support (e.g., FIPS-validated encryption modules), and any certifications they must hold (e.g., WPA2 Enterprise)."
          }
        ]
      },
      {
        "title": "Phase 3: Implementation",
        "content": [
          {
            "text": "In this phase, procured equipment is first configured to meet operational and security requirements, and then installed and activated on a production network, with appropriate event logging enabled."
          }
        ]
      },
      {
        "title": "Phase 4: Operations/Maintenance",
        "content": [
          {
            "text": "This phase includes security-related tasks that an organization should perform on an ongoing basis once the WLAN is operational, including patching, periodic security assessment, log reviews, and incident handling."
          }
        ]
      }
    ]
  },
  {
    "title": "or its components",
    "subsections": [
      {
        "content": "have been retired, including preserving information to meet legal requirements, sanitizing media that might contain sensitive material, and disposing of equipment properly."
      },
      {
        "title": "1. Introduction",
        "content": [
          {
            "subsection": "1.1 Authority",
            "text": []
          },
          {
            "text": "The National Institute of Standards and Technology (NIST) developed this document in furtherance of its statutory responsibilities under the Federal Information Security Management Act (FISMA) of 2002, Public Law 107-347. NIST is responsible for developing standards and guidelines, including minimum requirements, for providing adequate information security for all agency operations and assets; but such standards and guidelines shall not apply to national security systems. This guideline is consistent with the requirements of the Office of Management and Budget (OMB) Circular A-130, Section 8b(3), \"Securing Agency Information Systems,\" as analyzed in A-130, Appendix IV: Analysis of Key Sections. Supplemental information is provided in A-130, Appendix III. This guideline has been prepared for use by Federal agencies. It may be used by nongovernmental organizations on a voluntary basis and is not subject to copyright, though attribution is desired. Nothing in this document should be taken to contradict standards and guidelines made mandatory and binding on Federal agencies by the Secretary of Commerce under statutory authority, nor should these guidelines be interpreted as altering or superseding the existing authorities of the Secretary of Commerce, Director of the OMB, or any other Federal official."
          },
          {
            "subsection": "1.2 Purpose and Scope",
            "text": []
          },
          {
            "text": "This publication seeks to assist organizations in understanding, selecting, and implementing technologies based on Institute of Electrical and Electronics Engineers (IEEE) 802.11i, part of the IEEE 802.11 family of wireless networking standards. The document explains at length the security features and capabilities associated with IEEE 802.11i through its framework for Robust Security Networks (RSN), and provides extensive guidance on the planning and deployment of RSNs. The document also discusses previous IEEE 802.11 security measures and their shortcomings."
          },
          {
            "subsection": "1.3 Audience",
            "text": []
          },
          {
            "text": "This document has been created for those who are responsible for ensuring the security of wireless local area networks (WLAN). The guide should also be useful for network and security engineers and administrators who are responsible for designing, implementing, securing, and maintaining IEEE 802.11i implementations."
          },
          {
            "subsection": "1.4 Document Structure",
            "text": []
          },
          {
            "text": "The remainder of this document is organized into the following nine major sections:\n- Section 2 provides an overview of wireless networking, focusing on the IEEE 802.11 family of WLAN standards, and explains the basic IEEE 802.11 WLAN components and architectural models.\n- Section 3 gives an overview of IEEE 802.11 security, including a review of the security features and weaknesses of IEEE 802.11 before the introduction of the IEEE 802.11i.\n```# Amendment Overview"
          },
          {
            "text": "It also introduces the major security-related components that are defined in IEEE 802.11i."
          }
        ]
      },
      {
        "title": "Section Summaries",
        "content": [
          {
            "subsection": "Section 4",
            "text": []
          },
          {
            "text": "Introduces the concepts of Robust Security Networks (RSN) and Robust Security Network Associations (RSNA). It also discusses the RSN data confidentiality and integrity protocols, and the cryptographic keys created and used by these protocols."
          },
          {
            "subsection": "Section 5",
            "text": []
          },
          {
            "text": "Describes the five phases that occur during RSN communication, starting with the discovery of a WLAN and ending in connection termination. It also discusses the types of frames used to carry information between RSN components, and depicts the flows of frames between components during each phase of RSN operation."
          },
          {
            "subsection": "Section 6",
            "text": []
          },
          {
            "text": "Provides guidance on planning an Extensible Authentication Protocol (EAP) implementation, which is necessary for most enterprise RSN deployments. It discusses the most common EAP methods, explains how organizations can select EAP methods appropriate to their environments, examines additional EAP security considerations, and introduces the EAP architectural model and related support requirements."
          },
          {
            "subsection": "Section 7",
            "text": []
          },
          {
            "text": "Describes FIPS 140-2 certification as it applies to 802.11 wireless networks. It also provides an overview of the security specifications developed by the Wi-Fi Alliance, which conducts a certification program for the interoperability of WLAN products. The certifications are intended to help organizations select WLAN products that can support RSNs."
          },
          {
            "subsection": "Section 8",
            "text": []
          },
          {
            "text": "Presents best practice recommendations related to WLAN security."
          },
          {
            "subsection": "Section 9",
            "text": []
          },
          {
            "text": "Presents three case studies that illustrate how organizations might plan, design, and implement RSNs in different scenarios, such as migrating a WLAN from pre-RSN to RSN technology, and designing a new WLAN that meets RSN requirements."
          },
          {
            "subsection": "Section 10",
            "text": []
          },
          {
            "text": "Summarizes the major concepts and recommendations presented in Sections 2 through 8 of the document."
          },
          {
            "subsection": "Section 11",
            "text": []
          },
          {
            "text": "Provides a brief overview of possible extensions to IEEE 802.11i that are currently being developed."
          }
        ]
      },
      {
        "title": "Appendices",
        "content": [
          {
            "text": "The document also contains appendices with supporting material."
          },
          {
            "text": "\nAppendix A contains an acronym list.\nAppendix B lists the document's references and other sources of information that may be of interest to readers.\nAppendix C identifies online resources that may be helpful for better understanding IEEE 802.11i and IEEE 802.11i security.\n"
          }
        ]
      },
      {
        "title": "1.5 How to Navigate This Document",
        "content": [
          {
            "text": "This document is intended to be used by readers with various levels of experience and technical knowledge, as well as different interests in IEEE 802.11i. For example, computer security program managers might want to learn the basic IEEE 802.11i concepts and terminology, while network and security engineers might want to know as many details about the technical configuration of IEEE 802.11i technologies as possible. The lists below provide general recommendations as to which sections and sub-sections of the guide should be read, based on the reader's objectives. Readers who are unsure about the relevance or appropriateness of a particular section should read its introduction and summary to gain a better understanding.# Better Understanding of What the Section Contains"
          },
          {
            "text": "\n\nPractical Guidance on Implementing IEEE 802.11i Security. Readers who want to know how to implement IEEE 802.11i security should read Sections 7 and 8, as well as the Section 9 case studies that most closely match their needs.\n\n\nBasic Knowledge of IEEE 802.11i and RSNs. Readers who want to understand the basics of IEEE 802.11i and RSNs, and are not interested in detailed technical explanations of protocols and RSN operation, should do the following:\n\nRead Sections 2 and 3.\n\nSkim Sections 4 through 6, reading each section summary carefully.\n\n\nDetailed Knowledge of IEEE 802.11i and RSNs. Readers who are seeking solid knowledge of IEEE 802.11i should read Sections 2 through 7, skimming any parts that contain familiar content.\n\n\nAll the Details of IEEE 802.11i and RSNs. Readers who want to learn as much as possible should read the entire document.\n\n"
          },
          {
            "text": "Practical Guidance on Implementing IEEE 802.11i Security. Readers who want to know how to implement IEEE 802.11i security should read Sections 7 and 8, as well as the Section 9 case studies that most closely match their needs."
          },
          {
            "text": "Basic Knowledge of IEEE 802.11i and RSNs. Readers who want to understand the basics of IEEE 802.11i and RSNs, and are not interested in detailed technical explanations of protocols and RSN operation, should do the following:"
          },
          {
            "text": "Skim Sections 4 through 6, reading each section summary carefully."
          },
          {
            "text": "Detailed Knowledge of IEEE 802.11i and RSNs. Readers who are seeking solid knowledge of IEEE 802.11i should read Sections 2 through 7, skimming any parts that contain familiar content."
          },
          {
            "text": "All the Details of IEEE 802.11i and RSNs. Readers who want to learn as much as possible should read the entire document."
          }
        ]
      },
      {
        "title": "2. Overview of Wireless Networking",
        "content": [
          {
            "text": "Wireless networking enables devices with wireless capabilities to use computing resources without being physically connected to a network. The devices simply need to be within a certain distance (known as the range) of the wireless network infrastructure. A wireless local area network (WLAN) is a group of wireless networking nodes within a limited geographic area that is capable of radio communications. WLANs are typically used by devices within a fairly limited range, such as an office building or building campus, and are usually implemented as extensions to existing wired local area networks to provide enhanced user mobility."
          },
          {
            "text": "Since the beginning of wireless networking, many standards and technologies have been developed for WLANs. One of the most active standards organizations that address wireless networking is the Institute of Electrical and Electronics Engineers (IEEE). This section of the guide provides an overview of wireless networking and focuses on the IEEE 802.11 family of WLAN standards. Section 2.1 discusses the history of IEEE 802.11 and provides examples of alternative wireless networking standards. Section 2.2 explains the basic IEEE 802.11 WLAN components and architectural models, which lays a foundation for subsequent sections of the guide. Readers who are already familiar with the basics of WLANs and IEEE 802.11 might wish to skip this section."
          },
          {
            "subsection": "2.1 History of Wireless Networking Standards",
            "text": []
          },
          {
            "text": "WLAN technologies were first available in late 1990, when vendors began introducing products that operated within the 900 megahertz (MHz) frequency band. These solutions, which used non-standard, proprietary designs, provided data transfer rates of approximately 1 megabit per second (Mbps). This was significantly slower than the 10 Mbps speed provided by most wired local area networks (LAN) at that time. In 1992, vendors began selling WLAN products that used the 2.4 gigahertz (GHz) band. Although these products provided higher data transfer rates than 900 MHz band products, they also used proprietary designs. The need for interoperability among different brands of WLAN products led to several...# Organizations Developing Wireless Networking Standards"
          }
        ]
      },
      {
        "title": "Section 2.1.1: IEEE 802.11 Standards",
        "content": [
          {
            "text": "In 1997, IEEE ratified the 802.11 standard for WLANs. The IEEE 802.11 standard supports three transmission methods, including radio transmission within the 2.4 GHz band. In 1999, IEEE ratified two amendments to the 802.11 standard\u2014802.11a and 802.11b\u2014that define radio transmission methods, and WLAN equipment based on IEEE 802.11b quickly became the dominant wireless technology. IEEE 802.11b equipment transmits in the 2.4 GHz band, offering data rates of up to 11 Mbps. IEEE 802.11b was intended to provide performance, throughput, and security features comparable to wired LANs. In 2003, IEEE released the 802.11g amendment, which specifies a radio transmission method that uses the 2.4 GHz band and can support data rates of up to 54 Mbps. Additionally, IEEE 802.11g-compliant products are backward compatible with IEEE 802.11b-compliant products. Table 2-1 compares the basic characteristics of IEEE 802.11, 802.11a, 802.11b, and 802.11g. 802.11 wireless networking is also known as Wi-Fi\u00ae."
          },
          {
            "text": "Table 2-1 does not include all current and pending 802.11 amendments. For example, in November 2005, IEEE ratified IEEE 802.11e, which provides quality of service enhancements to IEEE 802.11 that improve the delivery of multimedia content. The IEEE 802.11n project is specifying IEEE 802.11 enhancements that will enable data throughput of at least 100 Mbps. Final working group approval is expected in January 2008, with an interim Wi-Fi certification sometime in 2007; products based on the 802.11n draft are currently available."
          },
          {
            "text": "The IEEE 802.11 variants listed in Table 2-1 all include security features known collectively as Wired Equivalent Privacy (WEP) that are supposed to provide a level of security comparable to that of wired LANs. As described in Section 3, IEEE 802.11 configurations that rely on WEP have several well-documented security problems. The IEEE acknowledged the scope of the problems and developed short-term and long-term strategies for rectifying the situation. In June 2004, the IEEE finalized the 802.11i amendment, which is designed to overcome the shortcomings of WEP. IEEE 802.11i specifies security components that work in conjunction with all the IEEE 802.11 radio standards, such as IEEE 802.11a, 802.11b, and 802.11g; any future 802.11 physical layer will also be compatible with 802.11i. Section 3 presents additional information on the IEEE 802.11i amendment."
          }
        ]
      },
      {
        "title": "Section 2.1.2: Wi-Fi Alliance Certification",
        "content": [
          {
            "text": "While IEEE was examining the shortcomings of IEEE 802.11 security and starting to develop the 802.11i amendment, a non-profit industry consortium of WLAN equipment and software vendors called the Wi-Fi Alliance developed an interoperability certification program for WLAN products. The Wi-Fi Alliance felt it was necessary to create an interim solution that could be deployed using existing IEEE 802.11 hardware while IEEE worked on finalizing the 802.11i amendment. Accordingly, the Alliance created# Wi-Fi Protected Access (WPA)"
          },
          {
            "text": "Wi-Fi Protected Access (WPA), which was published in October 2002; it is essentially a subset of the draft IEEE 802.11i requirements available at that time. The most significant difference between WPA and the IEEE 802.11i drafts is that WPA does not require support for Advanced Encryption Standard (AES), a strong encryption algorithm, because many existing IEEE 802.11 hardware components cannot support computationally intensive encryption without additional hardware components."
          },
          {
            "text": "In conjunction with the ratification of the IEEE 802.11i amendment, the Wi-Fi Alliance introduced WPA2, its term for interoperable equipment that is capable of supporting IEEE 802.11i requirements. The Wi-Fi Alliance began testing IEEE 802.11i products for WPA2 certification shortly after the IEEE 802.11i amendment was finalized. Section 7 provides more information on WPA and WPA2."
          }
        ]
      },
      {
        "title": "2.1.3 Other Wireless Standards",
        "content": [
          {
            "text": "In addition to the IEEE 802.11 and WPA standards, other wireless standards are also in use. These standards are unrelated to IEEE 802.11, but are presented in this section to provide context and illustrate how IEEE 802.11 and other standards meet different needs. The following list describes the major wireless architecture categories and provides examples of selected key current and emerging wireless standards."
          },
          {
            "text": "\nWireless personal area networks (WPAN): small-scale wireless networks that require little or no infrastructure. A WPAN is typically used by a few devices in a single room instead of connecting the devices with cables. For example, WPANs can provide print services or enable a wireless keyboard or mouse to communicate with a computer. Examples of WPAN standards include the following:\nIEEE 802.15.1 (Bluetooth). This WPAN standard is designed for wireless networking between small portable devices. The original Bluetooth operated at 2.4 GHz and has a maximum data rate of approximately 720 kilobits per second (Kbps); Bluetooth 2.0 can reach 3 Mbps.\nIEEE 802.15.3 (High-Rate Ultrawideband; WiMedia, Wireless USB). This is a low-cost, low power consumption WPAN standard that uses a wide range of GHz frequencies to avoid interference with other wireless transmissions. It can achieve data rates of up to 480 Mbps over short ranges and can support the full range of WPAN applications. One expected use of this technology is the ability to detect shapes through physical barriers such as walls and boxes, which could be useful for applications ranging from law enforcement to search and rescue operations.\n\nIEEE 802.15.4 (Low-Rate Ultrawideband; ZigBee). This is a simple protocol for lightweight WPANs. It is most commonly used for monitoring and control products, such as climate control systems and building lighting.\n\n\nWireless local area networks (WLAN). IEEE 802.11 is the dominant WLAN standard, but others have also been defined. For example, the European Telecommunications# Standards\n\n"
          },
          {
            "text": "IEEE 802.15.4 (Low-Rate Ultrawideband; ZigBee). This is a simple protocol for lightweight WPANs. It is most commonly used for monitoring and control products, such as climate control systems and building lighting."
          },
          {
            "text": "Wireless local area networks (WLAN). IEEE 802.11 is the dominant WLAN standard, but others have also been defined. For example, the European Telecommunications# Standards"
          },
          {
            "text": "The Institute (ETSI) has published the High Performance Radio Local Area Network (HIPERLAN) WLAN standard that transmits data in the 5 GHz band and operates at data rates of approximately 23.5 Mbps. However, HIPERLAN appears to have been supplanted by IEEE 802.11 in the commercial arena."
          },
          {
            "text": "\n\nWireless metropolitan area networks (WMAN): networks that can provide connectivity to users located in multiple facilities that are generally within a few miles of each other. Many WMAN implementations provide wireless broadband access to customers in metropolitan areas. For example, IEEE 802.16e (better known as WiMAX) is a WMAN standard that transmits in the 10 to 66 GHz band range. An IEEE 802.16a addendum allows for large data transmissions with minimal interference. WiMAX provides throughput of up to 75 Mbps, with a range of up to 30 miles for fixed line-of-site communication. However, there is generally a tradeoff; 75 Mbps throughput is possible at half a mile, but at 30 miles the throughput is much lower.\n\n\nWireless wide area networks (WWAN): networks that connect individuals and devices over large geographic areas, often globally. WWANs are typically used for cellular voice and data communications, as well as satellite communications.\n\n"
          },
          {
            "text": "Wireless metropolitan area networks (WMAN): networks that can provide connectivity to users located in multiple facilities that are generally within a few miles of each other. Many WMAN implementations provide wireless broadband access to customers in metropolitan areas. For example, IEEE 802.16e (better known as WiMAX) is a WMAN standard that transmits in the 10 to 66 GHz band range. An IEEE 802.16a addendum allows for large data transmissions with minimal interference. WiMAX provides throughput of up to 75 Mbps, with a range of up to 30 miles for fixed line-of-site communication. However, there is generally a tradeoff; 75 Mbps throughput is possible at half a mile, but at 30 miles the throughput is much lower."
          },
          {
            "text": "Wireless wide area networks (WWAN): networks that connect individuals and devices over large geographic areas, often globally. WWANs are typically used for cellular voice and data communications, as well as satellite communications."
          }
        ]
      },
      {
        "title": "2.2 IEEE 802.11 Network Components and Architectural Models",
        "content": [
          {
            "text": "IEEE 802.11 has two fundamental architectural components, as follows:"
          },
          {
            "text": "\n\nStation (STA). A STA is a wireless endpoint device. Typical examples of STAs are laptop computers, personal digital assistants (PDA), mobile phones, and other consumer electronic devices with IEEE 802.11 capabilities.\n\n\nAccess Point (AP). An AP logically connects STAs with a distribution system (DS), which is typically an organization's wired infrastructure. APs can also logically connect wireless STAs with each other without accessing a distribution system.\n\n"
          },
          {
            "text": "Station (STA). A STA is a wireless endpoint device. Typical examples of STAs are laptop computers, personal digital assistants (PDA), mobile phones, and other consumer electronic devices with IEEE 802.11 capabilities."
          },
          {
            "text": "Access Point (AP). An AP logically connects STAs with a distribution system (DS), which is typically an organization's wired infrastructure. APs can also logically connect wireless STAs with each other without accessing a distribution system."
          },
          {
            "text": "The IEEE 802.11 standard also defines the following two WLAN design structures or configurations, which are discussed in more detail in Sections 2.2.1 and 2.2.2:"
          },
          {
            "text": "\n\nAd Hoc Mode. The ad hoc mode does not use APs. Ad hoc mode is sometimes referred to as infrastructureless because only peer-to-peer STAs are involved in the communications.\n\n\nInfrastructure Mode. In infrastructure mode, an AP connects wireless STAs to each other or to a distribution system, typically a wired network. Infrastructure mode is the most commonly used mode for WLANs.\n\n"
          },
          {
            "text": "Ad Hoc Mode. The ad hoc mode does not use APs. Ad hoc mode is sometimes referred to as infrastructureless because only peer-to-peer STAs are involved in the communications."
          },
          {
            "text": "Infrastructure Mode. In infrastructure mode, an AP connects wireless STAs to each other or to a distribution system, typically a wired network. Infrastructure mode is the most commonly used mode for WLANs."
          },
          {
            "subsection": "2.2.1 Ad Hoc Mode",
            "text": []
          },
          {
            "text": "The ad hoc mode (or topology) is depicted conceptually in Figure 2-1. This mode of operation, also known as peer-to-peer mode, is possible when two or more STAs are able to communicate directly to one another. Figure 2-1 shows three devices communicating with each other in a peer-to-peer fashion without any infrastructure. A set of STAs configured in this ad hoc manner is known as an independent basic service set (IBSS)."
          },
          {
            "text": "Today, a STA is most often thought of as a simple laptop with an inexpensive network interface card.# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "(NIC) that provides wireless connectivity; however, many other types of devices could also be STAs.",
        "content": [
          {
            "text": "In Figure 2-1, the STAs in the IBSS are a mobile phone, a laptop, and a PDA. IEEE 802.11 and its variants continue to increase in popularity; scanners, printers, digital cameras and other portable devices can also be STAs. The circular shape in Figure 2-1 depicts the IBSS. It is helpful to consider this as the radio frequency coverage area within which the stations can remain in communication. A fundamental property of IBSS is that it defines no routing or forwarding, so, based on the bare IEEE 802.11i spec, all the devices must be within radio range of one another."
          },
          {
            "text": "One of the key advantages of ad hoc WLANs is that theoretically they can be formed any time and anywhere, allowing multiple users to create wireless connections cheaply, quickly, and easily with minimal hardware and user maintenance. In practice, many different types of ad hoc networks are possible, and the IEEE 802.11 specification allows all of them. Since it does not give the details of how to form a network, but rather only how to establish the links in a network, ad hoc mode as specified by 802.11 is incomplete for any particular use. This means that different products built on it typically are not interoperable, because there has not yet been standardization on any of these possible networks."
          },
          {
            "text": "An ad hoc network can be created for many reasons, such as allowing the sharing of files or the rapid exchange of e-mail. However, an ad hoc WLAN cannot communicate with external networks. A further complication is that an ad hoc network can interfere with the operation of an AP-based infrastructure mode network (see next section) that exists within the same wireless space."
          }
        ]
      },
      {
        "title": "2.2.2 Infrastructure Mode",
        "content": [
          {
            "text": "In infrastructure mode, an IEEE 802.11 WLAN comprises one or more Basic Service Sets (BSS), the basic building blocks of a WLAN. A BSS includes an AP and one or more STAs. The AP in a BSS connects the STAs to the DS. The DS is the means by which STAs can communicate with the organization's wired LANs and external networks such as the Internet. The IEEE 802.11 infrastructure mode is depicted in Figure 2-2."
          },
          {
            "text": "The DS and use of multiple BSSs and their associated APs allow for the creation of wireless networks of arbitrary size and complexity. In the IEEE 802.11 specification, this type of multi-BSS network is referred to as an extended service set (ESS). Figure 2-3 conceptually depicts a network with both wired and wireless capabilities. It shows three APs with their corresponding BSSs, which comprise an ESS; the ESS is attached to the wired infrastructure. In turn, the wired infrastructure is connected through a perimeter firewall to the Internet. This architecture could permit various STAs, such as laptops and PDAs, to provide Internet connectivity for their users."
          }
        ]
      },
      {
        "title": "2.3 Summary",
        "content": [
          {
            "text": "WLANs are usually implemented as extensions to existing wired LANs, and are used by devices within a fairly limited range, such as an office building. The need for interoperability among different brands of WLAN products led to the development of various WLAN standards. IEEE 802.11 is the dominant.# WLAN Standard"
          },
          {
            "text": "At the time that the IEEE 802.11i amendment was finalized, WLAN equipment based on IEEE 802.11b was the most popular; it was intended to provide performance, throughput, and security features comparable to wired LANs. Unfortunately, IEEE 802.11 technologies that rely on WEP have several well-documented security problems, which are described in Section 3. To address these, IEEE amended 802.11 with 802.11i, which was approved in June 2004. The subsequent sections of this guide cover IEEE 802.11i features and security considerations in depth."
          },
          {
            "text": "This section also explains the basic IEEE 802.11 network components and architectural models, as a foundation for understanding other sections of this guide. The major concepts introduced in this section are as follows:"
          }
        ]
      },
      {
        "title": "Major Concepts",
        "content": [
          {
            "text": "\nStation (STA). A STA is a wireless endpoint device, such as a laptop, PDA, or mobile phone.\nAccess Point (AP). An AP logically connects STAs with a distribution system, which is typically an organization's wired network infrastructure. APs can also logically connect wireless STAs with each other without accessing a distribution system.\nAd Hoc Mode. This is a wireless network configuration that does not use APs; STAs communicate directly with each other.\nInfrastructure Mode. This wireless network configuration requires APs and is the most commonly used mode for WLANs. All STAs connect with an AP, and the AP transfers frames among the STAs and the distribution system.\nIndependent Basic Service Set (IBSS). An IBSS is a set of STAs configured in ad hoc mode.\nBasic Service Set (BSS). A BSS is composed of an AP and one or more STAs configured in infrastructure mode. Each of the STAs associate directly with the AP. A BSS is the basic building block of a WLAN.\nDistribution System (DS). A DS is an infrastructure, typically a wired LAN, that connects individual BSSs to each other.\nExtended Service Set (ESS). An ESS is a WLAN comprising more than one BSS connected by a DS.\n"
          }
        ]
      },
      {
        "title": "Overview of IEEE 802.11 Security",
        "content": [
          {
            "text": "This section provides an overview of IEEE 802.11 security. It begins by explaining the main security concerns and threats against WLANs. Next, it reviews the security features and weaknesses of IEEE 802.11 before the introduction of the IEEE 802.11i amendment to the IEEE 802.11 WLAN standard, and the IEEE 802.11i framework for Robust Security Networks (RSN). The review of pre-RSN IEEE 802.11 security demonstrates the shortcomings of the standard and the motivation behind the development of the IEEE 802.11i amendment and the RSN framework, which is intended to provide strong authentication for WLAN devices and strong protection for WLAN communications. The section then introduces the major security-related components that are defined in the IEEE 802.11i amendment."
          },
          {
            "text": "This publication covers IEEE 802.11i-based wireless LANs only. It does not replace NIST Special Publication (SP) 800-48, Wireless Network Security: 802.11, Bluetooth and Handheld Devices, which# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "addresses IEEE 802.11b and 802.11g-based wireless LANs, Bluetooth implementations, and wireless handheld devices (e.g., text messaging devices, PDAs, smart phones). Organizations with existing IEEE 802.11b or 802.11g implementations should continue to use the recommendations in SP 800-48 to secure them; they should also review this publication to understand the new IEEE 802.11i technology and how it addresses the shortcomings of the WEP protocol used to secure IEEE 802.11b and 802.11g networks. Organizations that are considering the deployment of new wireless LANs should be evaluating IEEE 802.11i-based products and following the recommendations for IEEE 802.11i implementations in this publication. This section is intended to provide a high-level overview of IEEE 802.11 security concepts; subsequent sections of the guide discuss individual concepts in much greater depth. Readers who are already familiar with IEEE 802.11 security and the basic additions of IEEE 802.11i might wish to skip this section."
          }
        ]
      },
      {
        "title": "3.1 WLAN Security Concerns",
        "content": [
          {
            "text": "Like other wireless technologies, WLANs typically need to support several security objectives. This is intended to be accomplished through a combination of security features built into the wireless networking standard. The most common security objectives for WLANs are as follows:"
          },
          {
            "text": "\nConfidentiality\u2014ensure that communication cannot be read by unauthorized parties\nIntegrity\u2014detect any intentional or unintentional changes to data that occur in transit\nAvailability\u2014ensure that devices and individuals can access a network and its resources whenever needed\nAccess Control\u2014restrict the rights of devices or individuals to access a network or resources within a network.\n"
          },
          {
            "text": "The security objectives for wireless and wired LANs are the same, as are the major high-level categories of threats that they face. Table 3-1 provides a list of the main categories of threats against LANs. Most WLAN threats typically involve an attacker with access to the radio link between a STA and an AP or between two STAs. Several of the threats listed in Table 3-1 rely on an attacker's ability to intercept and inject network communications. This highlights the most significant difference between protecting wireless and wired LANs: the relative ease of intercepting network communications and inserting new ones from what can only be presumed as the authentic source. In a wired LAN, an attacker would have to gain physical access to the LAN or remotely compromise systems on the LAN; in a wireless LAN, an attacker simply needs to be within range of the WLAN infrastructure. In addition, an attacker can have the advantage of using highly sensitive directional antennas, which can greatly extend the effective range of the wireless LAN beyond the standardized range."
          }
        ]
      },
      {
        "title": "3.2 History of Pre-RSN IEEE 802.11 Security",
        "content": [
          {
            "text": "Prior to the IEEE 802.11i amendment and its RSN framework, IEEE 802.11 had a number of serious security weaknesses. Many vendors have added proprietary features to their IEEE 802.11 implementations to compensate for security flaws in the standard, but# Proprietary Features and Pre-RSN Security"
          },
          {
            "text": "Proprietary features often prevent interoperability. This section explains pre-RSN security features and shortcomings as a basis for understanding the motivation behind RSN. Sections 3.2.1 through 3.2.5 discuss pre-RSN IEEE 802.11 access control and authentication, encryption, data integrity, replay protection, and availability, respectively."
          }
        ]
      },
      {
        "title": "3.2.1 Access Control and Authentication",
        "content": [
          {
            "text": "The original IEEE 802.11 specification defines two means to validate the identities of wireless devices attempting to gain access to a WLAN, open system authentication and shared key authentication; neither of these alternatives is secure. IEEE 802.11 implementations are required to support open system authentication; shared key authentication support is optional. Open system authentication is effectively a null authentication mechanism that does not provide true identity verification. In practice, a STA is authenticated to an AP simply by providing the following information:"
          },
          {
            "text": "\n\nService Set Identifier (SSID) for the AP. The SSID is a name assigned to a WLAN; it allows STAs to distinguish one WLAN from another. SSIDs are broadcast in plaintext in wireless communications, so an eavesdropper can easily learn the SSID for a WLAN. However, the SSID is not an access control feature, and was never intended to be used for that purpose.\n\n\nMedia Access Control (MAC) address for the STA. A MAC address is a (hopefully) unique 48-bit value that is permanently assigned to a particular wireless network interface. Many implementations of IEEE 802.11 allow administrators to specify a list of authorized MAC addresses; the AP will permit devices with those MAC addresses only to use the WLAN. This is known as MAC address filtering. However, since the MAC address is not encrypted, it is simple to intercept traffic and identify MAC addresses that are allowed past the MAC filter. Unfortunately, almost all WLAN adapters allow applications to set the MAC address, so it is relatively trivial to spoof a MAC address, meaning attackers can gain unauthorized access easily. Additionally, the AP is not authenticated to the STA by open system authentication. Therefore, the STA has to trust that it is communicating to the real AP and not an impostor AP that is using the same SSID. Therefore, open system authentication does not provide reasonable assurance of any identities, and can be misused easily to gain unauthorized access to a WLAN or trick users into connecting to a malicious WLAN.\n\n"
          },
          {
            "text": "Service Set Identifier (SSID) for the AP. The SSID is a name assigned to a WLAN; it allows STAs to distinguish one WLAN from another. SSIDs are broadcast in plaintext in wireless communications, so an eavesdropper can easily learn the SSID for a WLAN. However, the SSID is not an access control feature, and was never intended to be used for that purpose."
          },
          {
            "text": "Media Access Control (MAC) address for the STA. A MAC address is a (hopefully) unique 48-bit value that is permanently assigned to a particular wireless network interface. Many implementations of IEEE 802.11 allow administrators to specify a list of authorized MAC addresses; the AP will permit devices with those MAC addresses only to use the WLAN. This is known as MAC address filtering. However, since the MAC address is not encrypted, it is simple to intercept traffic and identify MAC addresses that are allowed past the MAC filter. Unfortunately, almost all WLAN adapters allow applications to set the MAC address, so it is relatively trivial to spoof a MAC address, meaning attackers can gain unauthorized access easily. Additionally, the AP is not authenticated to the STA by open system authentication. Therefore, the STA has to trust that it is communicating to the real AP and not an impostor AP that is using the same SSID. Therefore, open system authentication does not provide reasonable assurance of any identities, and can be misused easily to gain unauthorized access to a WLAN or trick users into connecting to a malicious WLAN."
          },
          {
            "text": "Shared key authentication was supposed to be more robust than open system authentication; in fact, it is equally insecure. As the name implies, shared key authentication is based on a secret cryptographic key known as a Wired Equivalent Privacy (WEP) key; this key is shared by legitimate STAs and APs. (WEP is described in more detail in Section 3.2.2.) Shared key authentication uses a simple challenge-response scheme based on whether the STA seeking WLAN access knows the WEP key. As shown in Figure 3-1, the STA initiates an Authentication Request with the AP, and the AP generates a...# Current Page Raw OCR Text"
          }
        ]
      },
      {
        "title": "Random 128-bit Challenge Value",
        "content": [
          {
            "text": "The challenge value and sends it to the STA. Using the WEP key, the STA encrypts the challenge and returns the result to the AP. The AP decrypts the result using the same WEP key and allows the STA access only if the decrypted value is the same as the challenge."
          }
        ]
      },
      {
        "title": "Cryptographic Computations",
        "content": [
          {
            "text": "The cryptographic computations are performed using the RC4 stream cipher algorithm, which generates a pseudo-random data sequence known as a key stream. To encrypt or decrypt data, the key stream is combined with the data."
          }
        ]
      },
      {
        "title": "Weaknesses of Shared Key Authentication",
        "content": [
          {
            "text": "Shared key authentication is still weak because the AP is not authenticated to the STA, so there is no assurance that the STA is communicating with a legitimate AP. Also, simple unilateral challenge-response schemes have long been known to be weak unless they are carefully designed, with sufficient entropy in the challenge, keys of the appropriate length, a strong hash function, and secure protocol design."
          },
          {
            "text": "Although the challenge-response messages used for shared key authentication can prevent successful replay of authentication traffic, the challenge-response process can be compromised by methods such as man-in-the-middle attacks and off-line brute force or dictionary attacks."
          }
        ]
      },
      {
        "title": "Additional Vulnerabilities",
        "content": [
          {
            "text": "Additional vulnerabilities in IEEE 802.11's shared key authentication are known and documented. For example, an attacker can eavesdrop, capturing and viewing the cleartext challenge value and the encrypted response. The attacker can then analyze the two pieces of information to determine the WEP key stream."
          },
          {
            "text": "Some organizations prefer using open system authentication because shared key authentication provides so much information to eavesdroppers about the WEP key that it jeopardizes the confidentiality and integrity that should be provided to the communications by the WEP key."
          }
        ]
      },
      {
        "title": "Limitations of Shared Key Authentication",
        "content": [
          {
            "text": "Another significant limitation of shared key authentication is that it authenticates the identity of devices but not users. If an attacker gains access to a STA containing a WEP key, the attacker can use that key on any other WEP-capable device to be authenticated and gain access to the WLAN."
          },
          {
            "text": "Another major problem with shared key authentication is that pre-RSN IEEE 802.11 requires all devices on a WLAN to use the same WEP key or the same small set of keys. This reduces accountability and complicates troubleshooting and incident response efforts. If the WEP key is compromised, it needs to be replaced as quickly as possible to prevent further malicious acts, because WEP keys are used not only for access control, but also to protect confidentiality and integrity (as described in Sections 3.2.2 and 3.2.3)."
          }
        ]
      },
      {
        "title": "Key Management Issues",
        "content": [
          {
            "text": "Unfortunately, IEEE 802.11 does not specify any support for key management. When a WEP key needs to be changed, the WLAN administrators have to implement their own methods for generating and distributing a new key. The key needs to be replaced on all STAs and APs, which is a manual process for many WLAN products."
          },
          {
            "text": "WLAN administrators also need to implement methods for archiving, auditing, and destroying keys. Key management problems often limit the scalability of IEEE 802.11 WLANs."
          }
        ]
      },
      {
        "title": "Implementation Weaknesses",
        "content": [
          {
            "text": "In some cases, shared key authentication is weakened by implementations that use poor WEP keys. For example, some implementations use the WLAN product's default WEP key or set a trivial key, such as all.# CURRENT PAGE RAW OCR TEXT"
          }
        ]
      }
    ]
  },
  {
    "title": "CURRENT_PAGE_RAW_OCR_TEXT",
    "subsections": [
      {
        "content": "with randomly generated data."
      },
      {
        "title": "3.2.3 Data Integrity",
        "content": [
          {
            "text": "WEP performs data integrity checking for messages transmitted between STAs and APs. WEP is designed to reject any messages that have been changed in transit, such as by a man-in-the-middle attack."
          },
          {
            "text": "WEP data integrity is based on a simple encrypted checksum\u2014a 32-bit cyclic redundancy check (CRC-32) computed on each payload prior to transmission. The payload and checksum are encrypted using the RC4 key stream and transmitted. The receiver decrypts them, recomputes the checksum on the received payload, and compares it with the transmitted checksum. If the checksums are not the same, the transmitted data frame has been altered in transit, and the frame is discarded."
          },
          {
            "text": "Unfortunately, CRC-32 is subject to bit flipping attacks, which means that an attacker knows which CRC-32 bits will change when message bits are altered. WEP attempts to counter this problem by encrypting the CRC-32 to produce an integrity check value (ICV). The creators of WEP believed that an enciphered CRC-32 would be less subject to tampering. However, they did not realize that a property of stream ciphers such as WEP's RC4 is that bit flipping survives the encryption process\u2014the same bits flip whether or not encryption is used. Therefore, the WEP ICV offers no additional protection against bit flipping."
          },
          {
            "text": "Integrity should be provided by a cryptographic checksum rather than a CRC. Also known as keyed hashes or message authentication codes (MAC), cryptographic checksums prevent bit flipping attacks because they are designed so that any change to the original message results in significant and unpredictable changes to the resulting checksum. CRCs are generally more efficient computationally than cryptographic checksums, but are only designed to protect against random bit errors, not intentional forgeries, so they do not provide the same level of integrity protection."
          }
        ]
      },
      {
        "title": "3.2.4",
        "content": []
      },
      {
        "title": "3.2.5",
        "content": [
          {
            "subsection": "Replay Protection",
            "text": []
          },
          {
            "text": "The cryptographic implementation provides no protection against replay attacks because it does not include features such as an incrementing counter, timestamp, or other temporal data that would make replayed traffic easily detectable."
          },
          {
            "subsection": "Availability",
            "text": []
          },
          {
            "text": "Individuals who do not have physical access to the WLAN infrastructure can cause a denial of service for the WLAN. One threat is known as jamming, which involves a device that emits electromagnetic energy on the WLAN's frequencies. The energy makes the frequencies unusable by the WLAN, causing a denial of service. Jamming can be performed intentionally by an attacker or unintentionally by a non-WLAN device transmitting on the same frequency. Another threat against availability is flooding, which involves an attacker sending large numbers of messages to an AP at such a high rate that the AP cannot process them, or other STAs cannot access the channel, causing a partial or total denial of service. These threats are difficult to counter in any radio-based communications; thus, the IEEE 802.11 standard does not\n```# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "provide any defense against jamming or flooding.",
        "content": [
          {
            "text": "Also, as described in Section 3.2.1, attackers can establish rogue APs; if STAs mistakenly attach to a rogue AP instead of a legitimate one, this could make the legitimate WLAN effectively unavailable to users. Although 802.11i protects data frames, it does not offer protection to control or management frames. An attacker can exploit the fact that management frames are not authenticated to deauthenticate a client or to disassociate a client from the network."
          }
        ]
      }
    ]
  },
  {
    "title": "for WLANs as well.",
    "subsections": [
      {
        "content": "The IEEE 802.1X framework provides the means to block user access until authentication is successful, thereby controlling access to WLAN resources."
      },
      {
        "content": "The IEEE 802.1X standard defines several terms related to authentication. The authenticator is an entity at one end of a point-to-point LAN segment that facilitates authentication of the entity attached to the other end of that link. For example, the AP in Figure 3-2 serves as an authenticator. The supplicant is the entity being authenticated. The STA may be viewed as a supplicant. The authentication server (AS) is an entity that provides an authentication service to an authenticator. This service determines from the credentials provided by the supplicant whether the supplicant is authorized to access the services provided by the authenticator. The AS provides these authentication services and delivers session keys to each AP in the wireless network; each STA either receives session keys from the AS or derives the session keys itself. The AS either authenticates the STA and AP itself, or provides information to the STA and AP so that they may authenticate each other. The AS typically lies inside the DS, as depicted in Figure 3-2."
      },
      {
        "content": "When employing a solution based on the IEEE 802.11i standard, the AS most often used for authentication is an Authentication, Authorization, and Accounting (AAA) server that uses the Remote Authentication Dial In User Service (RADIUS) or Diameter protocol to transport authentication-related traffic. This is discussed further in Section 4. The supplicant/authenticator model is intrinsically a unilateral rather than mutual authentication model: the supplicant authenticates to the network. IEEE 802.11i combats this bias by requiring that the EAP method used provides mutual authentication."
      },
      {
        "content": "Figure 3-3 provides a simple conceptual view of IEEE 802.1X that depicts all the fundamental IEEE 802.11i components: STAs, an AP, and an AS. In this example, the STAs are the supplicants, and the AP is the authenticator. Until successful authentication occurs between a STA and the AS, the STA's communications are blocked by the AP. Because the AP sits at the boundary between the wireless and wired networks, this prevents the unauthenticated STA from reaching the wired network. The technique used to block the communications is known as port-based access control. IEEE 802.1X can control data flows by distinguishing between EAP and non-EAP frames, then passing EAP frames through an uncontrolled port and non-EAP frames through a controlled port, which can block access. IEEE 802.11i extends this to block the AP's communication until keys are in place as well. Thus, the IEEE 802.11i extensions prevent a rogue access point from exchanging anything but EAP traffic with the STA's host."
      }
    ]
  },
  {
    "title": "Current Page Raw OCR Text",
    "subsections": [
      {
        "content": "is the relative ease of intercepting and injecting network communications."
      },
      {
        "title": "Pre-RSN IEEE 802.11 Security Features",
        "content": [
          {
            "text": "Pre-RSN IEEE 802.11 offers various features intended to provide security; unfortunately, these features contain serious known vulnerabilities that can be exploited to impair access control and authentication, encryption, data integrity checking, and availability. Examples include the following:"
          },
          {
            "subsection": "Access Control and Authentication",
            "text": []
          },
          {
            "text": "Pre-RSN IEEE 802.11 performs access control through either open system or shared key authentication. Open system authentication does not verify any claimed credentials from the STA, so it is generally suitable only for providing public access to a WLAN. Shared key authentication uses a challenge-response scheme, but it has weaknesses that can permit man-in-the-middle attacks and other compromises. Also, neither open system nor shared key authentication allows a STA to verify the identity of an AP, so attackers can set up rogue APs and trick STAs into using them, potentially impacting confidentiality, integrity, and availability."
          },
          {
            "subsection": "Encryption",
            "text": []
          },
          {
            "text": "WEP suffers from a number of cryptographic weaknesses that enable attackers with readily available software tools to decipher captured data, sometimes with as little as a few minutes of recorded traffic. The weaknesses are a result of the way WEP employs the RC4 encryption algorithm and the use of a 24-bit IV, which is too small to prevent recurring IVs on a busy WLAN."
          },
          {
            "subsection": "Data Integrity",
            "text": []
          },
          {
            "text": "WEP attempts to perform data integrity checking for messages and reject messages that have been changed in transit. WEP uses a simple non-cryptographic checksum to detect errors in data transmission and protects this checksum with a stream cipher. Unfortunately, stream ciphers offer no protection against bit-flipping attacks, which means that in many cases a determined adversary can alter both data and the corresponding checksums without detection."
          },
          {
            "subsection": "Availability",
            "text": []
          },
          {
            "text": "Individuals without physical access to the WLAN can impact its availability through two types of attacks: jamming and flooding. Jamming occurs when a device emits electromagnetic energy on the WLAN's frequency, making it unusable. Flooding involves an attacker sending large numbers of messages to an AP at a high rate to prevent the AP from processing traffic. The IEEE 802.11 standard offers no defense against jamming or flooding. Also, attackers can establish rogue APs, which could make the legitimate WLAN effectively unavailable to users."
          }
        ]
      },
      {
        "title": "IEEE 802.11i Specification",
        "content": [
          {
            "text": "The IEEE 802.11i specification introduces the concept of an RSN, which is a wireless network that allows the creation of RSNAs only. RSNAs are logical connections between communicating IEEE 802.11 entities established through the IEEE 802.11i 4-Way Handshake. RSNAs allow for the protection of data frames and provide enhanced security relative to the flawed WEP. The IEEE 802.1X framework specified by the IEEE 802.11i amendment provides the means to block user access.\n```# Current Page Raw OCR Text"
          },
          {
            "text": "Until authentication is successful, thereby controlling access to the WLAN resources. The technique used to block access is known as port-based access control; it involves the AP distinguishing between EAP and non-EAP frames, then passing EAP frames through an uncontrolled port and non-EAP frames through a controlled port, which can block access."
          },
          {
            "text": "The IEEE 802.1X standard defines several terms related to authentication: authenticator, supplicant, and authentication server. The authenticator is an entity such as an AP that facilitates an authentication attempt. The supplicant is an entity such as a STA that is authenticated by an authenticator. The authentication server (AS) is an entity that provides an authentication service to an authenticator. This service determines, from the credentials provided by the supplicant, whether the supplicant is authorized to access the services provided by the authenticator. The AS either authenticates the STA and AP itself, or it provides information to the STA and AP so that they may authenticate each other."
          }
        ]
      },
      {
        "title": "4. Security Framework for Robust Security Networks",
        "content": [
          {
            "text": "The IEEE 802.11i amendment allows for enhanced security features beyond WEP and the simple IEEE 802.11 shared key challenge-response authentication. The amendment introduces the concepts of Robust Security Networks (RSN) and Robust Security Network Associations (RSNA). This section explains these terms and describes a security framework for RSN. It also discusses the reasons for creating RSNs. It then explains what constitutes an RSN and an RSNA. The section discusses the cryptographic key hierarchies that relate keys and introduce the alternatives for key distribution. Finally, it describes the two RSN data confidentiality and integrity protocols defined in IEEE 802.11i\u2014Temporal Key Integrity Protocol (TKIP) and Counter Mode with Cipher Block Chaining Message Authentication Code Protocol (CCMP)\u2014and their security features."
          },
          {
            "text": "This section contains considerable detail on the internal operations of IEEE 802.11 WLANs. It includes detailed descriptions of encryption and decryption procedures, IEEE 802.11 network element message flows, and various protocols. Readers without a need for this technical detail might wish to skim or skip portions of this section, and then read the summary in Section 4.4 carefully."
          },
          {
            "subsection": "4.1 Features of RSNs",
            "text": []
          },
          {
            "text": "With the addition of the IEEE 802.11i amendment in 2004, IEEE 802.11 offers two general classes of security capabilities for IEEE 802.11 WLANs. The first class, pre-RSN security, includes the legacy security capabilities developed in the original IEEE 802.11 specification: open system or shared key authentication for validating the identity of a wireless station, and WEP for the confidentiality protection of traffic. The second class of security capabilities includes a number of security mechanisms to create RSNs. An RSN includes security enhancements to address all the known flaws of WEP and provide robust protection for the wireless link, including data integrity and confidentiality. Figure 4-1 provides a high-level taxonomy of the major pre-RSN and RSN security mechanisms."
          },
          {
            "text": "At a high level, RSN includes IEEE 802.1X port-based access control, key...# Management Techniques"
          },
          {
            "text": "The TKIP and CCMP data confidentiality and integrity protocols are described in Section 4.3. These protocols allow for the creation of several diverse types of security networks because of the numerous configuration options. RSN security is at the link level only, providing protection for traffic between a wireless STA and its associated AP, or between one wireless STA and another wireless STA. It does not provide end-to-end application-level security, such as between a STA and an e-mail or Web server on the DS, because communication between these entities requires more than just one link. To provide end-to-end security, organizations can implement network level security mechanisms such as Transport Layer Security (TLS) or IPsec. Also, RSN's security features apply only to the wireless portion of the overall network, not to communications on wired networks."
          },
          {
            "text": "As shown in Figure 4-2, the security provided in an RSN can apply to both IEEE 802.11 modes of operation, BSS (infrastructure mode) and IBSS (ad hoc mode). For infrastructure mode, additional measures need to be taken to provide end-to-end security."
          }
        ]
      },
      {
        "title": "RSN Definition",
        "content": [
          {
            "text": "The IEEE 802.11i amendment defines an RSN as a wireless network that allows the creation of RSN Associations (RSNA) only. An RSNA is a security relationship established by the IEEE 802.11i 4-Way Handshake, which is described in Section 5.5. The 4-Way Handshake validates that the parties to the protocol instance both possess a pairwise master key (PMK), synchronizes the installation of temporal keys, and confirms the selection of cipher suites. The PMK is the cornerstone for a number of security features absent from WEP. Complete robust security is considered to be possible only when all devices in the network use RSNAs. In practice, some networks have a mix of RSNAs and non-RSNA connections."
          },
          {
            "text": "A network that allows the creation of both pre-RSN associations (pre-RSNA) and RSNAs is referred to as a Transition Security Network (TSN). A TSN is intended to be an interim means to provide connectivity while an organization migrates to networks based exclusively on RSNAs."
          }
        ]
      }
    ]
  },
  {
    "title": "4.2 Key Hierarchies and Key Distribution and Management# Fundamental Cryptographic Keys in IEEE 802.11 WLANs",
    "subsections": [
      {
        "content": "Fundamental to any cryptographic system are the cryptographic keys used in the transformation (enciphering or deciphering) processes. Since cryptography is the security foundation of IEEE 802.11 WLANs, the security of keys is particularly important. NIST's 2-volume guidance document on Key Management, SP 800-57, includes general guidance as well as best practices recommendations. Keys typically need to meet the following requirements:"
      },
      {
        "content": "\nRandomly generated to reduce the probability that they can be determined by an adversary or that they will be reused\nChanged frequently to reduce the possibility of discovery through sophisticated cryptanalysis\nProtected while in storage, so that previous communications cannot be deciphered\nProtected during transmission\nErased completely when no longer needed.\n"
      },
      {
        "content": "These requirements are related to the security service known as key management, which is defined as \"the process of handling and controlling cryptographic keys and related material (such as initialization values) during their life cycle in a cryptographic system, including ordering, generating, distributing, storing, loading, escrowing, archiving, auditing, and destroying the material.\" The IEEE 802.11 specification provides guidelines for some general key requirements, but it leaves other areas open to interpretation and dependent on implementation. Section 7 provides additional guidance on these requirements."
      },
      {
        "content": "For pre-RSN IEEE 802.11 networks that used manual WEP keys, key management was non-existent. For instance, there was typically only one key (or a small number of keys) for all devices in the network, and there was no standard mechanism for distributing the keys. Networks using dynamic WEP did have basic key distribution protocols that were able to derive per-user session keys, but still retained all the weaknesses inherent in WEP. However, with RSNAs there are several inter-related keys that underlie the security functions of encryption, authentication, and integrity. IEEE 802.11i defines two key hierarchies for RSNAs that specify the inter-relations of the keys. The two key hierarchies are the Pairwise Key Hierarchy, which is designed for unicast traffic protection, and the Group Key Hierarchy, which is intended for multicast/broadcast traffic protection. Sections 4.2.1 and 4.2.2 describe these key hierarchies and explain the source of each key and the relationships among keys."
      },
      {
        "title": "4.2.1 Pairwise Key Hierarchy",
        "content": [
          {
            "text": "Figure 4-4 depicts the Pairwise Key Hierarchy. The two keys depicted at the top of the key hierarchy are known as root keys, which are used as the basis for generating additional keys required for various confidentiality and integrity protections. The root keys represent the two ways in which keys may be installed in IEEE 802.11 RSNA devices, as follows:"
          },
          {
            "text": "\nPre-Shared Key (PSK). A PSK is a static key delivered to the AS and the STA through an out-of-band mechanism, as shown in Figure 4-5. The PSK must be put into place before establishing an association. The PSK may be generated and installed in any number of ways, including proprietary automated public-key cryptographic approaches, and manual means such as a USB.# CURRENT_PAGE_RAW_OCR_TEXT\n"
          },
          {
            "text": "Device or a passphrase (which can be converted to a cryptographic key using one of a number of algorithms). If any of the PSKs are compromised, they must be re-distributed in the same way. The security of the WLAN is compromised if any of the PSKs does not possess sufficient cryptographic strength; the passphrase from which the PSK is generated must be long and complex, possibly randomly generated. The IEEE 802.11 standard does not specify how PSKs are to be generated or distributed, so these decisions are left to implementers. As a result, organizations should review any PSK approach carefully for possible vulnerabilities and evaluate its performance implications. Distributing PSKs in a large network might be infeasible. Due to client software limitations, a common practice is to assign a single PSK per SSID to enable roaming. In such a case, all users can decrypt the traffic of other users, even if the network is protected from outsiders."
          }
        ]
      },
      {
        "title": "Authentication, Authorization, and Accounting Key (AAAK)",
        "content": [
          {
            "text": "The AAA key, also known as the Master Session Key (MSK), is delivered to the AP through the Extensible Authentication Protocol (EAP) during the process of establishing an RSNA. Each time a user authenticates to the WLAN, the AAA key changes; the new key is then used for the duration of the user's session, which lasts until the key lifetime expires or the user reauthenticates. As discussed in Section 5, numerous authentication techniques can be used with EAP. Delivery of the AAA key relies on the key generation capability of the chosen EAP authentication method. All EAP authentication methods supporting IEEE 802.11 RSNs must have the ability to create the AAA key for RSN security features to function properly. Decisions on the appropriate EAP authentication methods are left to the implementers of STAs or the AS. As a result, organizations should carefully review any EAP authentication methods and AAA key generation approaches for possible vulnerabilities."
          },
          {
            "text": "As shown in Figure 4-4, the root key\u2014either the PSK or the AAAK\u2014is used to formulate the Pairwise Master Key (PMK). The PMK is a key-generating key used for the derivation of the Pairwise Transient Key (PTK), along with the MAC address of the STA and AP and nonces that each creates for the key generation process. Using the STA and AP addresses in the generation of the PTK provides protection against session hijacking and impersonation; using nonces provides additional random keying material. The PTK is composed of the following three keys:"
          },
          {
            "text": "\nEAP Over LAN (EAPOL) Key Confirmation Key (EAPOL-KCK), which is used to support the integrity and data origin authenticity of STA-to-AP control frames during operational setup of an RSN. It also performs an access control function: proof-of-possession of the PMK. An entity that possesses the PMK is authorized to use the link.\nEAPOL Key Encryption Key (EAPOL-KEK), which is used to protect the confidentiality of...# CURRENT_PAGE_RAW_OCR_TEXT\n"
          }
        ]
      },
      {
        "title": "Keys and Other Data During Some RSNA Procedures",
        "content": [
          {
            "text": "\nTemporal Key (TK), which is used to provide the actual protection for user traffic.\n"
          },
          {
            "text": "Figure 4-4 shows the bit length of each of these keys. The PSK is 256 bits long, and the AAAK is 256 bits long or greater. The TK has two different sizes depending on the data confidentiality and integrity protocol that is used (128 bits for CCMP, 256 bits for TKIP). This is due to differences in cryptographic approaches. Also shown beneath each key is the condition under which the key is generated. For instance, the PMK is created for each session following the EAP authentication process."
          },
          {
            "text": "Figure 4-4 also shows the Pseudo-Random Function (PRF), which is an algorithm that is used to generate the PTK from the PMK. It uses HMAC-SHA-1 with specific inputs: the PMK, two 256-bit nonces, and the addresses of the STA and AP. The PRF may be used in IEEE 802.11 for the generation of keys of bit lengths 128, 192, 256, 384, and 512."
          }
        ]
      },
      {
        "title": "4.2.2 Group Key Hierarchy",
        "content": [
          {
            "text": "The second key hierarchy defined by IEEE 802.11 is the Group Key Hierarchy, which is depicted in Figure 4-6 and consists of a single key, the Group Temporal Key (GTK). Unlike the PMK, which is generated using material from both supplicant and authenticator, the GTK is generated by the authenticator (AP) and transmitted to its associated STAs. Exactly how this GTK is generated is undefined and is likely to vary considerably in various vendor implementations, with possible implications for security. IEEE 802.11i, however, requires that its value is computationally indistinguishable from random."
          },
          {
            "text": "The GTK is a 256-bit value for TKIP, 128 bit value for CCMP, and 40- or 104-bit value for WEP. Figure 4-6 also shows the time or condition under which each key is changed."
          },
          {
            "text": "Table 4-1 presents all of the keys used in IEEE 802.11, as introduced by the IEEE 802.11i amendment."
          }
        ]
      },
      {
        "title": "4.3 Overview of RSN Data Confidentiality and Integrity Protocols",
        "content": [
          {
            "text": "The IEEE 802.11i amendment defines two RSNA data confidentiality and integrity protocols: Temporal Key Integrity Protocol (TKIP) and Counter Mode with Cipher Block Chaining MAC Protocol (CCMP). According to its designers, TKIP was created to allow already-deployed devices to address the numerous inadequacies of WEP. TKIP may be implemented through software updates; it does not require hardware replacement of AP and STAs. However, because TKIP uses RC4 and the Michael message integrity code (MIC) (described in Section 4.3.1.2), both of which have known weaknesses, TKIP is not suitable for high assurance environments. For these environments, CCMP is considered the better solution."
          },
          {
            "text": "However, CCMP requires computing resources that cannot be assumed on pre-RSN hardware. In nearly all cases, organizations seeking to deploy IEEE 802.11 RSNs based on CCMP will need to replace some of their existing IEEE 802.11 equipment. Support for CCMP is mandatory for any device claiming RSNA compliance, while TKIP support is optional. TKIP and CCMP are described further in Sections 4.3.1 and 4.3.2, respectively."
          }
        ]
      },
      {
        "title": "4.3.1 Temporal Key Integrity Protocol (TKIP)# TKIP Overview",
        "content": [
          {
            "text": "TKIP is a cipher suite for enhancing the WEP protocol on pre-RSN hardware without causing significant performance degradation. TKIP works within the processing constraints of first-generation STAs and APs, and therefore enables increased security without requiring hardware replacement. This section provides an overview of TKIP, lists TKIP security features, and briefly describes the TKIP encapsulation and decapsulation procedures, as well as the additional countermeasures that are available."
          }
        ]
      },
      {
        "title": "TKIP Security Features",
        "content": [
          {
            "text": "TKIP provides the following fundamental security features for IEEE 802.11 WLANs:"
          },
          {
            "text": "\nConfidentiality protection using the RC4 algorithm\nIntegrity protection against several types of attacks using the Michael message digest algorithm (through generation of a message integrity code [MIC])\nReplay prevention through a frame sequencing technique\nUse of a new encryption key for each frame to prevent attacks such as the Fluhrer-Mantin-Shamir (FMS) attack, which can compromise WEP-based WLANs\nImplementation of countermeasures whenever the STA or AP encounters a frame with a MIC error, which is a strong indication of an active attack.\n"
          },
          {
            "text": "Sections 4.3.1.1 and 4.3.1.2 briefly describe the TKIP encapsulation and decapsulation procedures, including countermeasures."
          },
          {
            "subsection": "4.3.1.1 TKIP Encapsulation",
            "text": []
          },
          {
            "text": "Encapsulation is the process of generating the cryptographic payload (ciphertext) from the plaintext data. The plaintext data comprises user traffic and the source and destination MAC addresses. TKIP encapsulation builds upon the WEP encapsulation technique, modifying WEP with additional features through software, to bolster security without requiring hardware changes. TKIP uses three distinct keys: two integrity keys and an encryption key. The primary characteristics of TKIP encapsulation are presented briefly as follows:"
          },
          {
            "text": "\nTwo 64-bit message integrity keys are used with the Michael message digest algorithm to produce a message integrity code (MIC). One key is used to provide integrity protection for each half-duplex data channel between the STA and AP. The MIC is computed over the user data, source and destination addresses, and priority bits to provide data integrity. Due to design constraints, an attacker can use sophisticated methods to forge information without detection. Accordingly, TKIP decapsulation employs additional countermeasures, as discussed in Section 4.3.1.2, to partially mitigate the risk of these attacks.\nA monotonically increasing TKIP Sequence Counter (TSC) is assigned to each frame. The TSC provides protection against replay attacks. If frames do not arrive in order, the receiver simply drops them.\nA two-phase cryptographic key-mixing process occurs to produce a new key for every frame that is transmitted. The process takes a session Temporal Key along with the dynamically changing TSC to create a dynamic WEP key.\nThe original user frame, the computed 64-bit MIC, and the transmitter address are encrypted using WEP (with RC4) and the per-frame WEP key. Dynamic key updates and other countermeasures provide additional security.# CURRENT_PAGE_RAW_OCR_TEXT\n"
          },
          {
            "text": "Although the destination and source addresses and priority and payload are used as inputs by the Michael algorithm, only the payload is encrypted. Because the frame header contains the source and destination addresses and priority, the MIC generated by Michael incorporates them. This prevents an adversary from modifying the frame header addresses to spoof the source or redirect the frame to an unauthorized destination. The TKIP encapsulation process also involves encrypting the MIC using WEP, which helps to hide information about the 64-bit MIC key."
          }
        ]
      },
      {
        "title": "4.3.1.2 TKIP Decapsulation and Countermeasures",
        "content": [
          {
            "text": "Decapsulation is the process to recover the content of protected frames\u2014that is, to decrypt a received ciphertext packet. During decapsulation, various checks are performed on the frames. For example, if the TSC indicates a violation of proper frame sequencing (it should be monotonically increasing), the frame is discarded. Also, the MIC is recomputed and compared with the MIC in the packet; if they do not match, the frame is discarded and TKIP countermeasures are invoked, which serve as a TKIP safety net."
          },
          {
            "text": "Although the Michael MIC offers increased message integrity protection in comparison with the legacy WEP and its use of an encrypted CRC, Michael is much weaker than what is usually required. Its objective is to provide reasonable levels of integrity assurance on pre-RSNA-compliant devices without requiring hardware upgrades. Michael is subject to a 229 differential cryptanalysis attack, meaning an attacker could expect to create a forgery in about 228 messages on average. Since the Michael MIC has known vulnerabilities, any failure of the message integrity check in TKIP represents a probable active attack. Therefore, TKIP employs additional countermeasures to help thwart these attacks. These countermeasures accomplish the following security goals:"
          },
          {
            "text": "\nLogging security events. MIC failures during decapsulation at the STA or AP likely mean an active attack. These are to be logged, and a system or security administrator should investigate.\nLimiting MIC failures. A receiving STA or AP that detects two failures within a 60-second period disables reception for 60 seconds, not allowing any new associations for STAs using TKIP. This suspense mechanism thwarts an adversary's attempts at numerous attacks in a short period, limiting what an active attacker can learn about any Michael key. The countermeasures effectively limit the adversary to random guessing attacks.\nChanging the PTK and GTK. Temporal keys are erased and must be re-initialized.\nBlocking the IEEE 802.1X ports. If IEEE 802.1X authentication is used, the state machine is initialized, thereby blocking the controlled ports.\n"
          }
        ]
      },
      {
        "title": "4.3.2 Counter Mode with Cipher Block Chaining MAC Protocol (CCMP)",
        "content": [
          {
            "text": "CCMP is the second data confidentiality and integrity protocol that may be negotiated as a cipher suite for the protection of user traffic in an RSNA. Like TKIP, CCMP was developed to address all known inadequacies of WEP; however, CCMP was developed without the constraint of requiring the use of existing hardware. CCMP is considered the long-term solution for the creation of RSNs for WLANs. It is mandatory for RSN compliance.# CCMP Overview"
          },
          {
            "text": "CCMP is based on CCM, a generic authenticated encryption block cipher mode of AES. CCM is a mode of operation defined for any block cipher with a 128-bit block size. CCM combines two well-known and proven cryptographic techniques to achieve robust security. First, CCM uses CTR for confidentiality and Cipher Block Chaining MAC (CBC-MAC) for both authentication and integrity protection. CCMP protects the integrity of both the packet data and portions of the IEEE 802.11 header."
          },
          {
            "text": "CCM for IEEE 802.11 employs a single 128-bit session key (TK) to protect the duplex data channel. The CCMP key space has size 2^128 and uses a 48-bit packet number (PN) to construct a nonce to prevent replay attacks. The construction of the nonce allows the key to be used for both integrity and confidentiality without compromising either."
          },
          {
            "text": "As the long-term IEEE 802.11 WLAN solution for confidentiality and integrity, CCMP uses CCM, which was specifically designed to possess the following characteristics:"
          },
          {
            "text": "\nA single cryptographic key for confidentiality and integrity to minimize complexity and maximize performance (minimize key scheduling time)\nIntegrity protection of the packet header and packet payload, in addition to providing confidentiality of the payload\nComputation of some cryptographic parameters prior to the receipt of packets to enable fast comparisons when they arrive, which reduces latency\nSmall footprint (hardware or software implementation size) to minimize costs\nSmall security-related packet overhead (minimal data expansion due to cryptographic padding and integrity field, for instance)\nNo encumbrance by any existing or pending patents.\n"
          }
        ]
      },
      {
        "title": "4.3.2.1 CCMP Encapsulation",
        "content": [
          {
            "text": "CCMP encapsulation is the process of generating the cryptographic payload (ciphertext) from the plaintext data. The plaintext data comprises user traffic and a MAC header. The primary steps of CCMP encapsulation are the following:"
          },
          {
            "text": "\nThe packet number (PN) maintained for the session is incremented.\nThe PN and other portions of the address field are combined to form the nonce.\nThe identifier for the Temporal Key, or KeyID, and the PN are combined to form the CCMP header.\nThe frame header is used to construct the Additional Authentication Data (AAD). The AAD is a 22-byte or 28-byte parameter comprising several fields, including several addresses and the quality-of-service control field, that are used as additional input into the CCM authentication process.\nThe AAD, nonce, and plaintext data are provided as inputs to CCM along with the Temporal Key to encrypt the data.\nThe packet header, the CCM header, and the ciphertext data are concatenated to form the ciphertext (or encapsulated) packet.\n"
          },
          {
            "text": "CCM is an \"authenticate-and-encrypt\" block cipher mode of AES. As such, it both encrypts and produces a MIC. As shown, the four inputs to the CCM processing are the following:"
          },
          {
            "text": "\n128-bit cryptographic key, TK\n48-bit nonce (derived for a 48-bit packet number, PN)# CURRENT_PAGE_RAW_OCR_TEXT\n"
          }
        ]
      },
      {
        "title": "Additional Authentication Data (AAD)",
        "content": [
          {
            "text": "\nVariable length packet (frame body) with header.\nCCM uses a new Temporal Key every session\u2014with every new STA-AP association. Unlike TKIP, the use of AES at the core of CCM obviates the need to have per-packet keys. As a result, the two-phase key mixing functions of TKIP encapsulation are not present in the CCMP encapsulation. Figure 4-7 depicts the CCMP encapsulation. This illustrates the various functions and their sequence in the encapsulation process.\nThe figure depicts the plaintext frame prior to transmission at the top, and the plaintext header and ciphertext output at the bottom, ready to send. The payload is transformed into encrypted data along with the integral MIC. For IEEE 802.11 WLANs, the length of the MIC is set to 8 bytes, shown as M=8 in the figure. The K=16 and L=2 denote the 16-byte AES key size and 2-byte maximum packet length field, respectively. Also, CCMP uses the 48-bit packet number as an IV. The increment PN function ensures that the packet number is new for every frame that is encrypted. The 48-bit packet number, which provides replay prevention, ensures that the lifetime of an AES key (the per session temporal key, TK) is longer than any possible STA-AP association.\n"
          }
        ]
      },
      {
        "title": "4.3.2.2 CCMP Decapsulation and Processing",
        "content": [
          {
            "text": "CCMP decapsulation is used to recover and decrypt a transmitted frame. The key steps of CCMP decapsulation are depicted in Figure 4-8 and summarized briefly as follows:"
          },
          {
            "text": "\nThe encrypted frame is parsed to re-construct the AAD and the nonce. The AAD is formed from the frame header.\nThe nonce is formed from the PN plus the A2 (transmit address) and Priority fields.\nCCM uses the Temporal key, AAD, nonce, MIC, and encrypted payload to recover the plaintext data and to verify the MIC. If the MIC integrity check fails, CCM will not return the plaintext.\nThe received frame header and the plaintext data are concatenated to form the plaintext frame.\nThe PN in the frame is validated against the PN maintained for the session. If the PN received is not greater than the session PN, the frame is simply discarded; this check prevents replay attacks.\n"
          }
        ]
      }
    ]
  },
  {
    "title": "CURRENT_PAGE_RAW_OCR_TEXT",
    "subsections": [
      {
        "content": "Intended for multicast/broadcast traffic protection. In the Pairwise Key Hierarchy, there are two ways in which keys may be installed in RSNA devices, as follows:"
      },
      {
        "title": "Pre-Shared Key (PSK)",
        "content": [
          {
            "text": "\nPre-Shared Key (PSK), which is a static key delivered to the AS and the STA through an out-of-band mechanism. The IEEE 802.11 standard does not specify how PSKs are to be generated or distributed, so these decisions are left to implementers. The security of the WLAN is compromised if any of the PSKs does not possess sufficient cryptographic strength. As a result, organizations should review any PSK approach carefully for possible vulnerabilities and evaluate its performance implications. Distributing PSKs in a large network might be infeasible.\n"
          }
        ]
      },
      {
        "title": "Authentication, Authorization, and Accounting (AAA) Key (AAAK)",
        "content": [
          {
            "text": "\nAuthentication, Authorization, and Accounting (AAA) Key (AAAK), also known as the Master Session Key (MSK), which is delivered to the AP through the Extensible Authentication Protocol (EAP) during the process of establishing an RSNA. Each time a user authenticates to the WLAN, the AAA key changes; the new key is then used for the duration of the user's session. Decisions on the appropriate EAP authentication methods are left to the implementers of STAs or the AS. As a result, organizations should carefully review any EAP authentication methods and AAA key generation approaches for possible vulnerabilities.\n"
          },
          {
            "text": "The IEEE 802.11i amendment defines the following two data confidentiality and integrity protocols for providing confidentiality and integrity for RSNAs:"
          }
        ]
      },
      {
        "title": "Temporal Key Integrity Protocol (TKIP)",
        "content": [
          {
            "text": "\nTemporal Key Integrity Protocol (TKIP). TKIP is intended as an interim solution for IEEE 802.11 WLANs to address the numerous inadequacies of WEP expeditiously. TKIP may be implemented through software updates; it does not require hardware replacement of APs and STAs.\n"
          }
        ]
      }
    ]
  },
  {
    "title": "5. Robust Security Networks Principles of Operation",
    "subsections": [
      {
        "content": "This section describes the general principles of operation for IEEE 802.11 RSNs. Section 5.1 begins by describing the flow of frames in establishing an association. The rest of Section 5.1 discusses the types of IEEE 802.11 frames used within an RSN, including the structure of data frames. Section 5.2 provides a high-level overview of the five phases of RSN operation, while Sections 5.3\n```# CURRENT_PAGE_RAW_OCR_TEXT"
      },
      {
        "content": "through 5.7 provide detailed descriptions of each phase. Readers who are looking for only an overview of IEEE 802.11 RSN operation without extensive technical details should read the beginning of Section 5.1 and all of Section 5.2, skim the rest of Section 5, and read the summary in Section 5.8."
      },
      {
        "title": "5.1 General Principles of IEEE 802.11 Operation",
        "content": [
          {
            "text": "The IEEE 802.11 media access control (MAC) protocol supplies the functionality in WLANs that is required to provide reliable delivery of user data over the potentially noisy, unreliable wireless media. The IEEE 802.11 MAC protocol implements a frame exchange protocol in which the STA receiving a frame either returns an acknowledgement to the frame's source that the frame was received correctly, or notifies the source of an error. The frame exchange protocol is executed by each STA in the WLAN; every STA receives, decodes, and responds to information in the MAC header for every frame that it receives, with the exception of certain broadcast, multicast, and beacon frames."
          },
          {
            "text": "Figure 5-1 depicts a typical two-frame flow for IEEE 802.11 WLAN communication that illustrates an Association Request and Response. First, the STA sends an Association Request frame to the AP, which is a request to connect to the WLAN with a Service Set Identifier (SSID) of \"NotSecure\". The SSID is a text name assigned to the WLAN. The AP with the matching SSID then responds to the STA with either success or failure. If the response indicates success, the result is an association (not yet an RSNA) between the AP and STA. Association is a record-keeping procedure that allows the DS to keep track of STA location, so that frames from the DS are forwarded to the correct STAs."
          },
          {
            "subsection": "5.1.1 IEEE 802.11 Frame Types",
            "text": []
          },
          {
            "text": "The IEEE 802.11 frame exchange protocol involves three types of frames, as follows:"
          },
          {
            "text": "\n\nData Frame. Data frames encapsulate packets from upper layer protocols, such as IP, which in turn might contain application data (e.g., e-mail, Web pages). Data frames allow for the delivery of the upper layer protocol packets to a STA or AP. RSNA security mechanisms protect these frames.\n\n\nManagement Frame. Management frames carry the information necessary for managing the MAC. They provide the ability to perform management functions such as authenticating or associating (the wireless equivalent to connecting or registering). These frames can easily be forged, since IEEE 802.11i does not protect management frames. IEEE 802.11w is working on a standard to protect some management frames.\n\n\nControl Frame. Control frames are used for requesting and controlling access to the wireless media. An example of a control frame is the acknowledgement frame, which is used after data frames to ensure reliability. Its primary purpose is to alert the sender that the last frame was received correctly and there is no need to retransmit. This simple positive acknowledgement following each frame is expected, or the frame is considered lost. These frames can easily be forged, since IEEE 802.11i does not protect control frames.\n\n"
          },
          {
            "text": "Data Frame. Data frames encapsulate packets from upper layer protocols, such as IP, which in turn might contain application data (e.g., e-mail, Web pages). Data frames allow for the delivery of the upper layer protocol packets to a STA or AP. RSNA security mechanisms protect these frames."
          },
          {
            "text": "Management Frame. Management frames carry the information necessary for managing the MAC. They provide the ability to perform management functions such as authenticating or associating (the wireless equivalent to connecting or registering). These frames can easily be forged, since IEEE 802.11i does not protect management frames. IEEE 802.11w is working on a standard to protect some management frames."
          },
          {
            "text": "Control Frame. Control frames are used for requesting and controlling access to the wireless media. An example of a control frame is the acknowledgement frame, which is used after data frames to ensure reliability. Its primary purpose is to alert the sender that the last frame was received correctly and there is no need to retransmit. This simple positive acknowledgement following each frame is expected, or the frame is considered lost. These frames can easily be forged, since IEEE 802.11i does not protect control frames."
          },
          {
            "text": "Table 5-1 lists the 11 subtypes of management frames, most of which are...# Applicable Only in IEEE 802.11"
          },
          {
            "text": "In infrastructure mode (i.e., when STAs connect to an AP rather than directly to other STAs). A brief description of each frame is provided in the table. All of these frame subtypes are part of pre-RSN IEEE 802.11; however, some have been modified by the IEEE 802.11i amendment to allow for the establishment of RSNs. The frames that have been modified are identified by a check."
          },
          {
            "text": "Figure 5-2 illustrates the flow of management frames in a frame exchange between three STAs and an AP in a single infrastructure BSS. The AP periodically sends a Beacon frame, alerting all stations that the WLAN is operating in the area. After completing an IEEE 802.11 authentication exchange, the STAs are then able to connect to the AP by associating with it. STA 1 and STA 2 perform the Association Request-Response frame exchange with the AP to accomplish the STA registration for later frame delivery from the DS. STA 3 joins the network after the beacon was transmitted. As a result, it sends a Probe Request frame\u2014an active request for WLANs in the area\u2014to determine the capabilities of the AP, and receives a Probe Response frame containing the requested information. Section 5.2 provides additional descriptions of the Beacon, Association, and Probe frames."
          }
        ]
      },
      {
        "title": "5.1.2 IEEE 802.11 Data Frame Structure",
        "content": [
          {
            "text": "Figure 5-3 depicts the IEEE 802.11 data frame structure. As shown, the data frame begins with a MAC header, which contains numerous fields for the transport of data in a WLAN. Most importantly, the header provides the MAC addresses of the source and destination, as well as the transmitter address, which identifies the address of the wireless network interface card that transmitted the frame onto the wireless medium, and the receiver address, which identifies the wireless station or group address that should process the frame. For example, when APs bridge wired LANs, a STA can send a message to a wired LAN end station connected to the AP, in which case the receiver address is the AP's address, and the destination address is the end station's address. Each STA and AP processes frames with a receiver address that matches its MAC address. Each AP also forwards frames to an attached LAN when a frame's destination address is different than the receiver address. In addition to the MAC addresses and other header fields, a data frame also contains a frame body, which is the encapsulated data from the higher layer protocol, and a frame check sequence (FCS), which is provided for error detection purposes."
          },
          {
            "text": "The following items briefly describe the frame body, FCS, and MAC header fields."
          },
          {
            "text": "\nFrame Body. This field, also called the Data field, holds a payload from a higher layer. The Frame Body field is variable in length, with a maximum size of 2312 octets.\nFCS. This field is used for error detection to detect random bit errors in the received frame. It contains the result of applying a 32-bit cyclic redundancy check (CRC-32) on the data. Because of this, the FCS is often called the CRC. The FCS calculation is performed on all data in the MAC header and frame body.\nFrame Control Field. As shown in Figure 5-3, this field defines a number of parameters for IEEE 802.11 operation. For example, it contains two bits used to identify the# Version of the IEEE 802.11 MAC\n"
          },
          {
            "text": "Another value within the field is the Protected Frame bit; if it is set to 1, the frame body is cryptographically protected using the negotiated ciphersuite (e.g., CCMP, TKIP, WEP). The Frame Control Field also indicates the frame type (e.g., management, control, data) and subtype (e.g., Association Request, Probe Response)."
          },
          {
            "text": "\nDuration/ID. This field is used by a STA to retrieve frames buffered at an AP. The field identifies the remaining duration in the frame exchange between a STA and AP.\nSequence Control. This field is used to allow a STA to identify received frames that are duplicates, and to assist it in reassembling fragmented frames.\nAddress Fields. The MAC header for a data frame contains four distinct address fields, although in some cases not all fields contain relevant addresses. The address fields identify the original source address (SA) and final destination address (DA) in a frame exchange, as well as the receiver address (RA). Depending on the function of the frame, the address fields also identify either the transmitter address (TA) or the BSS identifier (BSSID), which is typically the address of the AP. The sequence of the addresses in the MAC header depends on two things: whether the transmitting station is in an IBSS or an infrastructure BSS, and whether the communicating stations are part of the DS. Table 5-2 identifies the functions of each of the address fields for the four possible cases, as defined by the values for the To DS and From DS subfields.\n"
          }
        ]
      },
      {
        "title": "5.2 Phases of IEEE 802.11 RSN Operation",
        "content": [
          {
            "text": "This section provides an overview of the operation of an IEEE 802.11 RSN. By grouping the frame exchanges according to function, RSN operation may be thought of as occurring in five distinct phases, some of which also occur in pre-RSN IEEE 802.11 implementations. Figure 5-4 depicts the phases in an infrastructure mode configuration and maps them to the WLAN network components involved in each phase, as well as end stations outside the WLAN RSN in the distribution system (e.g., other computers in the wired network). The rectangles represent the sequence of frames between the network components. The following items briefly describe each of the phases."
          },
          {
            "text": "\nPhase 1: Discovery. An AP uses Beacons and Probe Responses to advertise its IEEE 802.11i security policy. The STA uses these to identify an AP for a WLAN with which it wishes to communicate. The STA associates with the AP, which it uses to select the cipher suite and authentication mechanism when the Beacons and Probe Responses present a choice.\nPhase 2: Authentication. During this phase, the STA and AS prove their identities to each other. The AP blocks non-authentication traffic between the STA and AS until the authentication transaction is successful. The AP does not participate in the authentication transaction other than forwarding traffic between the STA and AS.\nPhase 3: Key Generation and Distribution. The AP and the STA perform several operations that cause cryptographic keys to be generated and placed on the AP and the STA. Frames are# CURRENT_PAGE_RAW_OCR_TEXT\n"
          },
          {
            "text": "exchanged between the AP and STA only."
          }
        ]
      },
      {
        "title": "Phase 4: Protected Data Transfer",
        "content": [
          {
            "text": "Frames are exchanged between the STA and the end station through the AP. As denoted by the shading and the lock and key, secure data transfer occurs between the STA and the AP only; security is not provided end-to-end."
          }
        ]
      },
      {
        "title": "Phase 5: Connection Termination",
        "content": [
          {
            "text": "The AP and STA exchange frames. During this phase, the secure connection is torn down and the connection is restored to the original state. Sections 5.3 through 5.7 provide in-depth discussion of each phase."
          },
          {
            "subsection": "5.3 Discovery Phase",
            "text": []
          },
          {
            "text": "The discovery phase is the first phase in the process to establish RSNAs. During this phase, STAs discover the existence of a network with which to communicate. STAs locate and identify APs through the APs' periodic transmission of Beacon frames. A Beacon frame contains a timestamp, beacon interval, and capability information, which includes supported data rates and the SSID. Figure 5-5 depicts an ESS with three APs; each has a different SSID. Because the STA shown with the ellipse is within the range of all three APs, it can identify and connect (associate) with any of them."
          },
          {
            "text": "During the discovery phase, STAs and APs negotiate several things, including the SSID, supported data rates, and other technical operating parameters related to reliable communication, as well as a security policy. In general, 802.11i does not support extensive negotiation. The AP describes the options that it supports, and only clients that are configured for compatible options will attempt to connect. Many APs and STAs can only store a single configuration at a time. Section 5.3.1 provides a detailed explanation of the security policy negotiation process. Section 5.3.2 shows how frames used for negotiation flow between STAs and APs during the discovery phase."
          },
          {
            "text": "During the discovery phase, STAs and APs negotiate the following key security capabilities:\n- Confidentiality and integrity protocols for protecting unicast traffic\n- Authentication method for mutual authentication of the AP and AS\n- Cryptographic key management approach\n- Pre-authentication capabilities (described in more detail in Section 5.4.4)."
          },
          {
            "text": "Confidentiality and integrity protocols for protecting multicast/broadcast traffic are dictated by the AP, since all STAs in a multicast group must use the same cipher suite."
          },
          {
            "text": "The specification of the confidentiality and integrity protocol, along with the chosen key length (if variable), is known as the cipher suite. The same cipher suite options are available for protecting unicast traffic and multicast and broadcast traffic. The possible cipher suites allowed by the IEEE 802.11i amendment are as follows:\n- WEP, with either a 40-bit or 104-bit key\n- TKIP\n- CCMP, which is the default choice according to the 802.11i standard. In practice, many existing devices default to TKIP.\n- Vendor-specific methods (to allow for flexibility and expansion)."
          },
          {
            "text": "As listed below, there are three options for what the IEEE 802.11 standard refers to as Authentication and Key Management (AKM). An AKM suite defines the means by which the AP and STAs are mutually.# Current Page Raw OCR Text"
          }
        ]
      },
      {
        "title": "Authentication and Key Management",
        "content": [
          {
            "text": "Authenticated during initial operation and the means for deriving the root key shown in the Pairwise Key Hierarchy. RSNAs may be established for WLANs in either ad hoc mode (IBSS) or infrastructure mode (BSS) using any of the AKM suites. The possible AKM suites are as follows:"
          },
          {
            "text": "\n\nMutual authentication and key management over IEEE 802.1X or using pairwise master key security association (PMKSA) caching, which is discussed in more detail in Section 5.4.4. Authentication is accomplished with an EAP method. If a specific AKM suite is not supplied during security policy negotiation, this suite will be used as the default AKM suite.\n\n\nPre-shared key. No explicit authentication transaction takes place. If the PSK is unique for each STA, the STA and AP effectively authenticate each other by holding an identical pre-shared key, without which the data confidentiality and integrity services could not function properly. In practice, many PSK APs use a single PSK for every STA. This means that, rather than authenticating the client, the AP is verifying that the client is a member of an authorized group (the group that shares the key). The actual identity of the client has not been established, so this is not client authentication in the normal meaning of the term. However, the STA does authenticate the AP.\n\n\nProprietary suites developed by vendors; this allows for flexibility and expansion.\n\n"
          },
          {
            "text": "Mutual authentication and key management over IEEE 802.1X or using pairwise master key security association (PMKSA) caching, which is discussed in more detail in Section 5.4.4. Authentication is accomplished with an EAP method. If a specific AKM suite is not supplied during security policy negotiation, this suite will be used as the default AKM suite."
          },
          {
            "text": "Pre-shared key. No explicit authentication transaction takes place. If the PSK is unique for each STA, the STA and AP effectively authenticate each other by holding an identical pre-shared key, without which the data confidentiality and integrity services could not function properly. In practice, many PSK APs use a single PSK for every STA. This means that, rather than authenticating the client, the AP is verifying that the client is a member of an authorized group (the group that shares the key). The actual identity of the client has not been established, so this is not client authentication in the normal meaning of the term. However, the STA does authenticate the AP."
          },
          {
            "text": "Proprietary suites developed by vendors; this allows for flexibility and expansion."
          },
          {
            "text": "A security association between a STA and an AP is a relationship established between these two entities that enable them to protect data the exchange. Both entities store the security association information, which includes the set of security policies and cryptographic keys used to protect the data (e.g., SSID, the specific PMK, MAC addresses). An AP that is prepared to establish a RSNA will broadcast (advertise) its capabilities, including its supported encryption and authentication capabilities. The capabilities are included in a field called the RSN Information Element (RSNIE), which is part of Beacon and Probe Response frames. Figure 5-6 depicts the fields of the RSNIE. As shown, the RSNIE also conveys the group key cipher suite, pairwise cipher suite, and AKM suite. For example, an RSNIE could specify a group key cipher suite of CCMP, a pairwise cipher suite of CCMP, and an AKM suite of IEEE 802.1X. The RSN Capabilities field includes an indication of whether Pre-Authentication is possible and whether WEP with a default key is possible."
          }
        ]
      },
      {
        "title": "5.3.2 Discovery Phase Frame Flows",
        "content": [
          {
            "text": "Figure 5-7 depicts the flow of the three Request-Response pairs that comprise the discovery phase. In this scenario, the STA sends a Probe Request frame to locate an AP in the area. The AP responds with its capabilities in the RSNIE field of the Probe Response frame; this includes all of its enabled encryption and authentication capabilities. When the STA receives the Probe Response frame, it performs open system authentication\u2014null authentication\u2014with the AP. The purpose of this frame sequence, which provides no security, is simply to maintain backward compatibility with the IEEE 802.11 state machine.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "as implemented in existing IEEE 802.11 hardware. Following the authentication frame exchange, the STA then sends an Association Request frame to the AP. In this frame, the STA specifies one set of matching capabilities (one authentication and key management suite, one pairwise cipher suite, and one group key cipher suite) from among those advertised by the AP. If there is no match in capabilities between the AP and the STA, the AP refuses the Associate Request. The STA blocks it too, in case it has associated with a rogue AP or someone is inserting frames illicitly on its channel. As shown in the figure, the IEEE 802.1X controlled ports are blocked, and no user traffic goes beyond the AP. This process of mutually advertising and agreeing on the security capabilities is referred to as security policy negotiation."
          },
          {
            "text": "As an alternative to the frame flow depicted in Figure 5-7, the Probe Request-Response pair may be absent. If the STA had monitored one of the periodic Beacon frames from the AP, it would not have needed to request the parameters from the AP through a Probe Request. Therefore, a STA can discover an AP's security policy through either or both of two methods: passively monitoring for AP Beacon frames, and actively probing for all APs within range."
          },
          {
            "text": "Figure 5-8 depicts an example of security policy negotiation. As shown, the AP advertises its capabilities to the STA in a periodic Beacon frame, as set by the WLAN security policy. In this example, the AP informs the STA that it is capable of performing IEEE 802.1X authentication, CCMP for unicast traffic protection, and CCMP for broadcast traffic protection. The STA also indicates that it is capable of performing IEEE 802.1X authentication and CCMP for both types of traffic. At this point, the AP accepts the IEEE 802.1X and CCMP request, then self-configures these capabilities. It confirms its declaration with an Association Response frame, indicating the completion of security policy negotiation and the end of the discovery phase."
          },
          {
            "text": "During the discovery phase, a STA may decline to communicate with an AP or another STA that fails to disclose any of the following:"
          },
          {
            "text": "\nSecurity policy in the Beacon or Probe Response frames\nAuthorized SSID\nAuthorized encryption and authentication cipher suites.\n"
          },
          {
            "text": "The IEEE 802.11 standard does not specify the manner in which these conditions are handled. This remains undefined and is left as a design choice to the RSN technology manufacturer. Manufacturers typically design their products so that these conditions are configurable via policy."
          }
        ]
      },
      {
        "title": "5.3.3 Distinguishing RSN and Pre-RSN WLANs",
        "content": [
          {
            "text": "The outcome of the discovery phase is very important to the security posture of a WLAN. In an RSN, APs do not allow associations from pre-RSN STAs\u2014those STAs that do not support data confidentiality and integrity mechanisms beyond WEP and that cannot create PMK security associations. For example, an ESS might contain several IEEE 802.11 STAs and three APs. Suppose that all STAs within this ESS use pre-shared keying (as opposed to the IEEE 802.1X technique) and the CCMP security method for both unicast and broadcast traffic. These parameters are negotiated through the# Discovery Phase's Security Parameter Negotiation"
          },
          {
            "text": "Because the three APs have allowed only RSNAs with the seven STAs, they provide an RSN. In contrast, suppose that the STAs in the ESS do not all operate with CCMP; two are using pre-RSN capabilities. These stations, forming a Transition Security Network, are using WEP and shared key authentication. As a result, this WLAN is not an RSN, even though five of its STAs are operating with CCMP. The two STAs using pre-RSN capabilities create significant security holes that can negatively impact the security of the other components of the WLAN. Not only are the communications between the STA and AP not protected strongly, but also the AP must be configured to permit the use of pre-RSN capabilities. This could allow an attacker within range of the AP to establish unauthorized connections to it, potentially gaining access to other resources."
          }
        ]
      },
      {
        "title": "5.4 Authentication Phase",
        "content": [
          {
            "text": "Upon successful completion of the discovery phase, the STA and AP enter the second phase in the establishment of an RSNA: the authentication phase. This phase provides the means for a STA to prove its identity to the WLAN. This security service is critical for preventing unauthorized access to network resources. In an infrastructure WLAN, authentication provides protection against unauthorized users in the DS, since the AP is the entry point into the ESS. Improper authentication can undermine all security measures in an enterprise. Mutual authentication also allows the WLAN to prove its identity to the STA, which allows the STA to validate positively that it is communicating with a legitimate WLAN, as opposed to an unauthorized or \"rogue\" WLAN."
          },
          {
            "text": "Figure 5-9 depicts the concept of authentication that occurs during this phase. As shown, the authentication occurs between the STA and the AS, which is located in the DS. This authentication procedure is designed to disallow all stations from using the network except for those that are explicitly authorized to do so. It also provides a level of confidence to the STA's user that the STA is communicating with the legitimate network."
          },
          {
            "subsection": "5.4.1 The IEEE 802.1X Framework: Port-Based Access Control",
            "text": []
          },
          {
            "text": "As described in Section 3, the IEEE 802.11 standard uses the IEEE 802.1X standard to provide mutual authentication between STAs and ASs. IEEE 802.1X is a general-purpose, extensible framework for authenticating users. The actual authentication mechanism incorporated into the framework is implemented by the STA and the AS using EAP. EAP provides a framework that allows the use of multiple methods for achieving authentication, including static passwords, dynamic passwords (e.g., one-time passwords, token generators), and public key cryptography certificates (on the AS only or on both the AS and STAs). Dozens of standard and proprietary EAP methods exist; Section 6 provides more information on the most commonly used ones."
          },
          {
            "text": "IEEE 802.1X authentication has three main components: a client (also known as a supplicant), an authenticator, and an AS. The authenticator simply passes authentication traffic between the client and AS. IEEE 802.1X controls the flow of data between the DS and STAs by use of a...# Controlled/Uncontrolled Port Model"
          },
          {
            "text": "EAP authentication occurs through the IEEE 802.1X uncontrolled port on the authenticator; non-EAP data frames are passed or blocked via the IEEE 802.1X controlled port, depending upon the success or failure of IEEE 802.1X authentication (which includes EAP). This model is known as port-based access control. Using this concept, IEEE 802.1X achieves the objective of blocking access for unauthorized parties in an IEEE 802.11 WLAN."
          },
          {
            "text": "The authentication message flows between the client and the authenticator typically use the EAP over LAN (EAPOL) protocol. RADIUS is the protocol most commonly used to transport EAP messages between the authenticator and the AS. The steps in a typical successful IEEE 802.1X authentication exchange when RADIUS is used to support authentication-related traffic on the DS are as follows:"
          },
          {
            "text": "\nThe supplicant (client) may start the exchange with an optional EAPOL-Start message.\nThe EAP exchange begins with the authenticator issuing an EAP-Request/Identity frame to the supplicant.\nThe supplicant replies with an EAP-Response/Identity frame, which the AP receives over the uncontrolled port. The packet is then encapsulated in RADIUS over EAP and passed on to the RADIUS server as a RADIUS-Access-Request packet.\nThe AAA server replies with a RADIUS-Access-Challenge packet, which is passed on to the supplicant as an EAP-Request. This request is of the appropriate authentication type and contains relevant challenge information.\nThe supplicant formulates an EAP-Response message and sends it to the authenticator. The response is translated by the authenticator into a Radius-Access-Request, with the response to the challenge as a data field. Steps 4 and 5 may be repeated multiple times, depending on the EAP method in use. For TLS tunneling methods, it is common for authentication to require 10-20 round trips.\nThe AAA server grants access with a Radius-Access-Accept packet. The authenticator issues an EAP-Success frame. (Some protocols require confirmation of the EAP success inside the TLS tunnel for authenticity validation.) The controlled port is authorized, and the user may begin to access the network.\nDuring the termination phase, when the supplicant is finished accessing the network, it may send an optional EAPOL-Logoff message to restore the controlled port to an unauthorized state.\n"
          },
          {
            "text": "Figure 5-10 depicts the authentication frame flow in an IEEE 802.11 RSNA. As shown, authentication occurs between the STA and AS, with the AP assisting in the networking dialog. The IEEE 802.1X controlled port is blocked before the EAP authentication procedures take place. The EAP authentication process, which occurs over the IEEE 802.1X uncontrolled port, starts when the AP sends the EAP-Request frame to the STA, or the STA sends the EAPOL-Start frame. EAP frames pass between the STA and the AS via the uncontrolled ports."
          },
          {
            "text": "At the conclusion of the authentication dialog, the AP controlled port is still blocked to general users.# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "Traffic Authentication",
        "content": [
          {
            "text": "Although the authentication is successful, the ports remain blocked until the temporal keys are installed in the STA and AP, which occurs during the 4-Way Handshake. This blocking keeps unauthorized traffic from entering the DS and prevents any traffic from the DS from being transmitted wirelessly. The STA may also initiate an IEEE 802.1X authentication frame exchange. In this case, the exchange is the same, with the exception that the STA initiates it by issuing an EAPOL-Start message to the AP."
          },
          {
            "text": "After the seven-step authentication process has been completed, the AAA key is installed in the STA and the AS. As discussed in Section 4.2.1, the AAA key serves as a root key to enable the generation of other keys used to secure communications between the STA and the AP. The AAA key for this particular STA is the foundation of security, and its compromise would be devastating to the overall security of the system. The IEEE 802.11 standard does not describe specifically how the MSK is delivered to the AS and STA; it relies on EAP to handle this. RFC 3580, \"IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines,\" specifies the method for MSK delivery. Although the IEEE standard does not prescribe a method for secure MSK delivery and installation, it does indicate the importance of the connection between the AS and AP."
          }
        ]
      },
      {
        "title": "5.4.2 Authentication with the PSK",
        "content": [
          {
            "text": "Typically, the authentication phase provides mutual authentication of a STA and an AS in an RSNA and delivers the Master Session Key to the AP and, sometimes, to the STA. However, in an RSNA that has negotiated the PSK AKM during the discovery phase, the authentication phase is not required, because the shared key has already been distributed and installed in an out-of-band manner that has implicitly provided authentication. Therefore, when the AKM is PSK, the authentication phase is skipped entirely, as shown in Figure 5-11. However, the IEEE 802.1X controlled ports are still blocked, preventing users' traffic from being passed to the DS."
          }
        ]
      },
      {
        "title": "5.4.3 AS to AP Connections",
        "content": [
          {
            "text": "As shown in Figure 5-4 and Figure 5-11, following the authentication phase of operation, the AS delivers the AAA key to the AP. The data flows from the two network elements are depicted in Figure 5-11 by the dashed rectangle labeled AS-AP Key Distribution. As described in Section 4.2.1, the AAA key is the basis of the Pairwise Transient Key (PTK) and other keys (i.e., TK, EAPOL-KEK, and EAPOL-KCK)."
          },
          {
            "text": "The interface between the AS and the AP\u2014to allow the distribution of the AAA key and support mutual authentication\u2014is not fully defined in the IEEE 802.11i specification. However, RADIUS and Diameter are the protocols most likely to be used to support authentication traffic between an AS and AP. Although the details of the communications interface between the AS and the AP are outside the scope of the IEEE 802.11i amendment, the amendment does contain several requirements for the interface to ensure that the security of an RSN is not compromised. Specifically, the communication link between the AS and AP must provide the following:# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "Robust, mutual authentication between the AS and AP",
        "content": [
          {
            "text": "\nAn end-to-end channel between the AS and the authenticator for the mutual authentication\nThe ability to transfer the cryptographic key generated by the AS to the AP securely. As shown in Figure 5-12, the AS to AP communication must provide confidentiality and integrity, and the AS must prevent key compromise during storage.\n"
          },
          {
            "text": "The AS is a critical component of overall RSN security. The IEEE 802.11 standard assumes the following with respect to the AS:\n- It does not expose or compromise the PMK (a subset of the AAA key) to other entities besides the AP.\n- It does not masquerade as a STA to the AP.\n- It does not masquerade as an AP to the STA."
          },
          {
            "text": "Figure 5-13 depicts a typical enterprise environment with numerous STAs and APs, plus a single AS to provide authentication services during the third phase of RSN establishment. A AAA server running RADIUS is commonly used as the AS, but other types of AAA servers such as those supporting Diameter may also perform the service. In some small or single AP implementations, the AS may be physically integrated into the AP. In that case, there is no external communication for EAP authentication or for delivery of the AAA key."
          }
        ]
      },
      {
        "title": "5.4.4 Pre-Authentication and PMKSA Caching",
        "content": [
          {
            "text": "Pre-Authentication and PMKSA caching (also referred to as PMK caching or Proactive Key Caching) are mechanisms that improve performance, particularly in roaming scenarios. In Pre-Authentication, a STA can initiate an EAP over IEEE 802.1X authentication transaction with an AP outside of radio range using an association with another AP and the DS for communication. This procedure creates a PMKSA between the STA and remote AP. The PMKSA is cached (i.e., stored in a state table in memory) on both the STA and remote AP. When the STA enters within range of the previously remote AP, it can initiate a 4-Way Handshake without a successful IEEE 802.1X and EAP authentication transaction, which occurred earlier over the DS. The Pre-Authentication capability enables roaming STAs to start data communications more quickly than if full authentication were required for every association. Although pre-authentication is defined in 802.11i, it is not widely implemented."
          },
          {
            "text": "PMKSA caching can also be enabled to improve performance even in the absence of Pre-Authentication. If a STA in a fixed location often loses its connection to an AP due to radio interference or other reasons, PMKSAs can enable quick reassociation without requiring the full authentication process. If PMKSA caching is enabled, the STA supplies a list of PMKSAs to the authenticator during an association or reassociation frame exchange. If the authenticator finds a match, then IEEE 802.1X and EAP authentication is not necessary, and the STA and AP can start the 4-Way Handshake using the cached PMKSA. If the AP does not have a corresponding PMKSA for the supplicant, then it will require the full IEEE 802.1X and EAP authentication process. If the 4-Way Handshake fails, both sides can remove the associated cached PMKSA.# 5.5 Key Generation and Distribution"
          },
          {
            "text": "Following the successful completion of the authentication phase, the STA and AP perform a series of functions that position cryptographic keys in both entities. This phase is called the key generation and distribution (KGD) phase. It provides the final step in authentication and allows the STA and AP to derive keys that make secure data transfer possible. The KGD phase has several purposes, including the following:"
          },
          {
            "text": "\nConfirming the existence of the Pairwise Master Key (PMK)\nEnsuring the security association keys are new\nDeriving and synchronizing the installation of traffic encryption keys (temporal keys) in the AP and STA\nDistributing a group key for multicast and broadcast traffic protection\nConfirming the cipher suite selection.\n"
          },
          {
            "text": "The KGD phase includes two types of handshakes: a 4-Way Handshake and a Group Handshake. The Group Handshake is necessary only when STAs participate in multicast or broadcast traffic. Both types of handshakes employ the following fundamental security features:"
          },
          {
            "text": "\nMessage integrity checking, to protect against tampering and to validate the source of traffic\nMessage encryption, to protect against unauthorized disclosure of data.\n"
          },
          {
            "text": "The confidentiality and integrity algorithms used for both handshakes are configurable to either of the following:"
          },
          {
            "text": "\nRC4 Encryption with HMAC-MD5. RC4 is the well-known stream cipher that forms the basis of WEP. RC4 uses the 128-bit EAPOL-KEK derived from the PTK using the PRF.\nAES Key Wrap with HMAC-SHA-1-128. The AES Key Wrap was designed specifically to encrypt keying material (cryptographic keys). The key wrap parses data into n blocks of 64-bits and \"wraps\" (encrypts) the key contents. The key wrap uses the AES codebook mode along with the EAPOL-KEK derived from the PTK.\n"
          },
          {
            "text": "Both RC4 and the AES Key Wrap use the HMAC along with the EAPOL-KCK derived from the PTK using the PRF to provide integrity during the 4-Way Handshake. As discussed in Section 2, Federal agencies are required to use encryption algorithms that are FIPS-approved. RC4 encryption and MD5 are not FIPS-approved, but AES and SHA-1 are, so NIST requires that Federal agencies use AES Key Wrap with HMAC-SHA-1-128 instead of RC4 encryption with HMAC-MD5."
          }
        ]
      },
      {
        "title": "5.5.1 4-Way Handshake",
        "content": [
          {
            "text": "The KGD phase begins with the 4-Way Handshake, which is depicted in Figure 5-14. During the handshake, four frames are exchanged between the STA and the AP. To generate data for the frames and verify data received in frames, both the STA and the AP perform several computations. At the successful conclusion of the 4-Way Handshake, the AP and STA have been mutually authenticated. At that point, the IEEE 802.1X controlled ports are opened to allow the flow of frames for data traffic."
          },
          {
            "text": "Frames 2, 3 and 4 in the exchange are protected from modification using a message integrity code (MIC) applied to the frames. This message integrity feature, which is mandatory for all frames except the first frame, is performed by computing a message integrity check over the entire frame and sending the MIC.# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "along with the frame.",
        "content": [
          {
            "text": "Although Frame 1 is not integrity-protected, any modification to it can be detected by the subsequent checking mechanisms. Message encryption is performed to protect critical data from unauthorized disclosure. It may also be used in frame 2 to encrypt the RSNIE; however, this is optional."
          }
        ]
      },
      {
        "title": "5.5.2 Group Key Handshake",
        "content": [
          {
            "text": "The Group Key Handshake is used by the AP to send a new GTK to a STA. It may occur immediately after the 4-Way Handshake or upon STA initiation. It is necessary to support multicast or broadcast traffic. Figure 5-15 depicts the simple two-frame Group Key Handshake. After the Group Key Handshake is complete, the AP and STA are ready for operation. The Group Key Handshake also may be used to distribute subsequent GTKs. The AP can use the handshake to update the GTK in STAs under the following conditions:\n- On disassociation or deauthentication of a STA\n- Upon occurrence of an event on the STA that triggers an update, such as a configuration change in the STA's local security policy."
          },
          {
            "text": "The GMK used to derive the GTK may be updated in the AP at a time interval configured into the system. Periodic updating of the GMK may be included in the security policy for the WLAN. Organizations should update the GMK to prevent exposure of subsequent traffic between STAs and the AP, if the GMK is ever compromised."
          }
        ]
      },
      {
        "title": "5.6 Protected Data Exchange",
        "content": [
          {
            "text": "The fourth phase in the operation of an RSN is the protected data exchange phase. Before this phase, the AP and STA have already done the following:\n- Become associated and negotiated a security policy (discovery phase)\n- Mutually authenticated using EAP and derived a Master Session Key using the uncontrolled IEEE 802.1X port, or implicitly authenticated through a previously installed preshared key (authentication phase)\n- Generated, distributed and confirmed the session keys through the 4-Way Handshake (KGD phase)\n- Derived a pairwise transient key and unblocked the IEEE 802.1X ports (KGD phase)."
          },
          {
            "text": "These actions have prepared the AP and STA to communicate securely. During the protected data exchange phase, the AP and STA may now share data securely. The traffic between the AP and STA is protected using the data confidentiality and integrity algorithms chosen during the discovery phase. IEEE 802.11i supports three methods of data transfer: unicast, multicast, and broadcast."
          },
          {
            "text": "For RSNs, unicast (also called \"directed\") is the type of data transfer used most often during the protected data exchange phase. Unicast data transfer can occur when a unique association exists between the AP and the STA and a pairwise transient key is used for the protection of the traffic. Protections afforded unicast frames include encryption, integrity protection, and replay protection. Additionally, because data forgery is a major security concern in WLANs, unicast frames are equipped with a data origin authentication mechanism that prevents masquerading attacks. The mechanism allows a STA to confirm whether or not a received data frame originated from the claimed STA.# The broadcast and multicast data transfer mechanisms"
          },
          {
            "text": "The broadcast and multicast data transfer mechanisms (also called \"group\") allow for common data to be transferred to multiple devices efficiently. Communication between the AP and the STAs is protected using CCMP. Unique Group Key Handshakes with each STA insert the GTK used with CCMP to protect the data exchanges. Because all STAs share the same GTK, a single breach of the GTK affects all STAs."
          }
        ]
      },
      {
        "title": "5.7 Connection Termination",
        "content": [
          {
            "text": "The fifth and final phase in the operation of an RSNA is the connection termination phase. During this phase, the association between the STA and the AP is deleted, and the wireless connection is terminated. This phase provides the elegant teardown of a connection and a restoration to an initialized state. During the connection termination phase, the following events occur:"
          },
          {
            "text": "\nThe AP deauthenticates the STA.\nThe security associations, used internally by the AP to keep track of associations between STAs and APs, are deleted.\nThe temporal keys used for encrypting and protecting the integrity of data traffic are deleted.\nThe IEEE 802.1X controlled port returns to a blocked state so that user traffic cannot pass.\n"
          },
          {
            "text": "The connection termination phase may be entered in several ways, including the following:"
          },
          {
            "text": "\nRadio communication between the STA and AP is lost (e.g., STA moves out of range).\nThe 4-Way Handshake or Group Key Handshake times out during execution.\nThe RSNIE check during the 4-Way Handshake fails.\nThe user powers down the STA or disables the NIC.\nThe security policy indicates a termination of the connection (implementation-specific).\n"
          },
          {
            "text": "This phase restores the AP and STA to an initialized state. If further communication is subsequently required, then these devices begin anew at the discovery phase with the re-discovery of the available resources and capabilities."
          }
        ]
      },
      {
        "title": "5.8 Summary",
        "content": [
          {
            "text": "IEEE 802.11 defines how frames are exchanged between STAs and APs. There are three types of IEEE 802.11 frames, as follows:"
          },
          {
            "text": "\nData frames, which encapsulate packets from upper layer protocols, such as IP, which in turn might contain application data (e.g., e-mail, Web pages).\nManagement frames, which include informational probes and beacons, and messages related to the management of association and authentication events.\nControl frames, which are used for requesting and controlling access to the wireless media, such as sending an acknowledgement after receiving a data frame.\n"
          },
          {
            "text": "By grouping the IEEE 802.11 frame exchanges by function, IEEE 802.11 operation may be thought of as occurring in the following five distinct phases:"
          },
          {
            "text": "\nPhase 1: Discovery. The STA identifies an AP for a WLAN with which it wishes to communicate. The STA locates an AP either by receiving one of the AP's periodic transmissions of Beacon frames, or by sending a Probe Request to solicit a Probe Response from an AP. After the STA has identified an AP, the STA and the AP exchange frames to negotiate various parameters for their communications. By the end of the phase, the STA and AP have established.# Security Policy Overview\n"
          },
          {
            "text": "A security policy that specifies several key security capabilities, such as data confidentiality and integrity protocols for protecting traffic, an authentication method, and a key distribution approach."
          }
        ]
      },
      {
        "title": "Phase 2: Authentication",
        "content": [
          {
            "text": "During this phase, the STA and AS prove their identities to each other. The authentication frames pass through the AP, which also blocks non-authentication traffic from the STA using IEEE 802.1X port-based access control. The actual authentication mechanism is implemented by the STA and AS using EAP, which provides a framework that allows the use of multiple methods for achieving authentication, including static passwords, dynamic passwords, and public key cryptography certificates. After authentication has been completed, the AAA key is installed in the STA and AS; it serves as a root key to enable the generation of other keys used to secure communications between the STA and AP."
          }
        ]
      },
      {
        "title": "Phase 3: Key Generation and Distribution (KGD)",
        "content": [
          {
            "text": "During the KGD phase, the AP and the STA perform several operations that cause cryptographic keys to be generated and placed on the AP and the STA. The KGD phase employs two types of handshakes: a 4-Way Handshake and a Group Key Handshake. Both employ message encryption and integrity checking, using one of two confidentiality and integrity algorithms. For both types of handshakes, NIST requires the use of AES Key Wrap with HMAC-SHA-1-128 instead of RC4 encryption with HMAC-MD5 because AES and SHA-1 are FIPS-approved algorithms, and RC4 and MD5 are not."
          }
        ]
      },
      {
        "title": "Phase 4: Protected Data Transfer",
        "content": [
          {
            "text": "The STA and AP share data securely, using the security policy and cryptographic keys established during the first three phases. Because secure data transfer occurs between the STA and the AP only, organizations need to consider carefully the security of the data during the rest of its transit (e.g., on the DS)."
          }
        ]
      },
      {
        "title": "Phase 5: Connection Termination",
        "content": [
          {
            "text": "During this phase, the STA and AP tear down their secure connection and delete their association, thereby terminating their wireless connection."
          }
        ]
      },
      {
        "title": "RSN Framework Introduction",
        "content": [
          {
            "text": "The RSN framework introduces the authentication phase, the key generation and distribution phase, and the connection termination phase into IEEE 802.11 operation. Before the IEEE 802.11i amendment, IEEE 802.11 operation involved rudimentary authentication, but only as part of the discovery phase. The RSN framework also introduces new elements and techniques into the other phases, but the basic nature of the dialog remains the same."
          },
          {
            "text": "Organizations that want to establish IEEE 802.11 RSNs should configure their APs so that they permit the establishment of RSNAs only. During the discovery phase, if an AP permits a WEP-based association with any STA, then not only is that association not an RSNA, but the WLAN is no longer an RSN. All associations must be RSNAs for the WLAN to be considered an RSN. Allowing any WEP-based associations creates significant security holes that can negatively impact the security of the other components of the WLAN. The communications between some STAs and APs will not be protected.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "strongly, and having APs configured to permit the use of pre-RSN capabilities could allow attackers within range of the AP to establish unauthorized connections to it, potentially gaining access to other resources."
          }
        ]
      },
      {
        "title": "6. Extensible Authentication Protocol",
        "content": [
          {
            "text": "As discussed in Section 4, the Extensible Authentication Protocol (EAP) is used during the authentication phase of an IEEE 802.11 RSN. It provides the authentication framework for IEEE 802.11 RSNs that use 802.1X port-based access control. EAP was first officially defined in RFC 2284, which was released in March 1998. It was revised in June 2004 with the release of RFC 3748. The original EAP RFC focuses primarily on the EAP packet format and message types. The subsequent RFC includes significant new material on the EAP framework, security considerations, and interaction with other protocols."
          },
          {
            "text": "The protocol was developed to provide authentication services for Point-to-Point Protocol (PPP), the primary link-layer protocol for dial-up connections to IP networks. Before EAP, PPP employed the authentication services of Password Authentication Protocol (PAP) and Challenge-Handshake Authentication Protocol (CHAP). Increasingly, there was a demand to support additional deployed authentication methods, such as One Time Passwords or tokens that issue passcodes. Rather than add new authentication methods to PPP, a protocol was created that could be adapted to new authentication methods as they became available. EAP is the outcome of that effort. As EAP deployment spread to other environments, security flaws were discovered. Attempts were made to define generic EAP security requirements, as well as the security needs applicable to specific environments."
          },
          {
            "text": "EAP supports a wide variety of authentication methods, also called EAP methods. These methods include authentication based on passwords, certificates, smart cards, and tokens. EAP methods can also include combinations of authentication techniques, such as a certificate followed by a password, or the option of using either a smart card or a token. This flexibility means that EAP can integrate with nearly any environment to which a WLAN might connect. EAP's pass-through feature enables an AP to forward authentication messages to and from a back-end authentication infrastructure consisting of one or a small number of ASs, which greatly enhances the scalability and performance of the RSN solution. EAP is also used to enable both peers (supplicant and AS) to agree on the keying material and to distribute the key material that serves as the basis for nearly all of the RSN security protections. The keying material can be mutually derived or distributed by the AS. Subsequently, the AS distributes the keying material to the AP. The keying material is used as (loose) authorization from the AS to AP to signal the AP that the STA is authorized to gain access to the WLAN. The protocol most commonly used to transport back-end EAP authentication and key distribution traffic is RADIUS. In this configuration, EAP conversations are carried within RADIUS packets."
          },
          {
            "text": "The EAP method or methods deployed in an IEEE 802.11 RSN are critical in determining the security of# The Resulting Solution"
          },
          {
            "text": "IEEE 802.11 does not specify a particular authentication method for RSNs, which gives organizations considerable discretion in choosing which authentication method to employ. However, IEEE 802.11i describes the basic EAP assumptions and requirements that are necessary to enable the IEEE 802.11i security model to hold up. If an organization chooses a weak authentication method or implements a strong method improperly, the EAP implementation could seriously weaken the RSN protections. Moreover, if the EAP implementation is also used to support integrated or single sign-on in an enterprise, security breaches could compromise other network assets as well."
          },
          {
            "text": "This section provides guidance to assist organizations in planning their EAP implementations. The section first discusses common EAP methods and explains how organizations can select EAP methods appropriate to their environment. The section next examines additional EAP security considerations. The last part of the section introduces the EAP architectural model and related support requirements."
          }
        ]
      },
      {
        "title": "6.1 EAP Methods",
        "content": [
          {
            "text": "EAP methods perform the authentication transaction and generate the key material used to protect subsequent communications. Because of the extensible nature of EAP, dozens of EAP methods exist, and others are being developed. The specifications for some of the EAP methods most commonly used in WLAN environments are available publicly as peer-reviewed or privately submitted IETF Internet-Drafts or RFCs. This enables software developers from various organizations to write implementations of the EAP methods for WLAN products. Once an EAP method is expected to be in common use, the Internet Assigned Numbers Authority (IANA) assigns it a method type code, which effectively adds it to a universally accepted directory of EAP methods. To date, IANA has allocated method type codes to approximately 40 EAP methods. The EAP software on each device knows which method to invoke based on the method type code in the incoming EAP packet."
          },
          {
            "text": "EAP methods support a number of different types of authentication. For example, authentication might involve a user-defined password entered into a dialog box, a one-time password read from a hardware token, or a certificate stored on a smart card or USB device. Also, while authentication between a STA and an AS is mutual, it is not necessarily symmetric. For example, the AS might authenticate to the STA using a certificate, but the STA might authenticate to the AS with a user-supplied biometric. In all these cases, the nature of the authentication depends on the EAP method employed."
          },
          {
            "text": "To protect against certain types of attacks, EAP only allows one authentication method to be used in each EAP conversation, but complex authentication architectures can still be supported within this framework. EAP multiplexing is the ability of an EAP server to handle multiple EAP methods and distinguish between each EAP conversation when more than one is occurring at the same time. EAP multiplexing enables an organization to require different authentication methods for different applications or user populations. EAP tunneling allows the nesting of one or more EAP methods within another EAP method.# EAP Methods and Their Requirements"
          },
          {
            "text": "which in effect requires one type of authentication to be dependent on another in the context of a single EAP conversation. For example, through the use of EAP tunneling, a STA may use one or more techniques to authenticate to the AS, while the AS uses another technique to authenticate to the STA. As discussed later in this section, many of the leading EAP methods for WLAN are tunneled methods."
          },
          {
            "text": "The remainder of this section discusses how EAP methods are used in practice and describes particular EAP methods and their relative advantages and disadvantages. Section 6.1.1 reviews the EAP method requirements for WLANs. Section 6.1.2 discusses the baseline EAP methods included in RFC 3748, and Section 6.1.3 describes the EAP methods most commonly used in WLAN environments. Finally, Section 6.1.4 summarizes and compares the EAP methods discussed in Sections 6.1.2 and 6.1.3."
          }
        ]
      },
      {
        "title": "6.1.1 EAP Method Requirements for WLANs",
        "content": [
          {
            "text": "EAP methods can support authentication in a wide range of environments, including dial-up networking services and cellular telephony, but not all EAP methods are appropriate for IEEE 802.11 RSNs. This section reviews EAP method requirements for WLANs. It is based largely on RFC 4017, Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs, which is expected to guide industry development of new EAP methods for WLAN applications."
          },
          {
            "text": "Some EAP methods have security features that other methods do not. To help people understand the level of security that an EAP method provides, RFC 3748 includes a list of security claims, which are essentially security protection goals that an EAP method might meet. Since the publication of RFC 3748 in June 2004, EAP methods entering the IETF RFC process must include a statement of which RFC 3748 security claims apply to the method and which do not. In addition, the specification for the EAP method should include a justification for the claims that it makes, perhaps through a formal proof, so that users of the EAP method can assess the level of assurance behind the claim. RFC 4017 identifies the security claims that are mandatory, recommended, and optional for WLANs. Table 6-1 summarizes the result of that effort."
          },
          {
            "text": "In the context of an IEEE 802.11 RSN, man-in-the-middle attack resistance can be among the most difficult of the claims to establish. In a typical configuration, the AP resides between the STA and AS, and the AS authenticates the AP, using the RADIUS shared secret, during the EAP exchange. An authorized and weakly authenticated man-in-the-middle exists under normal operating conditions. In this environment, an attacker can easily defeat weak authentication methods by setting up a rogue AP. Therefore, it is critical that appropriate EAP methods be selected to eliminate this risk. As Section 6.1.2 explains, the EAP methods defined in RFC 3748 are vulnerable to man-in-the-middle attacks. Section 6.1.3 discusses EAP methods that can eliminate the risk of such attacks if implemented properly."
          }
        ]
      },
      {
        "title": "6.1.2 RFC 3748-Defined EAP Methods",
        "content": [
          {
            "text": "RFC 3748 establishes how EAP functions and also defines the following three EAP methods, which are# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "described later in this section:"
          },
          {
            "text": "\nMD5-Challenge\nOne-Time Password (OTP)\nGeneric Token Card (GTC).\n"
          },
          {
            "text": "Other IETF RFCs and Internet-Drafts define additional EAP methods. RFC 3748 requires that all EAP implementations support the MD5-Challenge method; support for the other two methods is optional. None of the RFC 3748 methods can meet any of the WLAN-required security claims. In some cases, however, the RFC 3748 methods are tunneled within the TLS methods discussed in Section 6.1.3. Therefore, they can still support IEEE 802.11 RSN associations in the context of other methods that meet the WLAN-required security claims, but these are the only circumstances in which they can be used safely. The RFC 3748 methods are often referred to as legacy methods because more sophisticated EAP methods have been developed since the publication of RFC 3748, but MD5-Challenge in particular remains widely used, particularly in conjunction with other more secure authentication methods. These methods are also used on wired networks, where the eavesdropping threat is believed to be much lower."
          }
        ]
      },
      {
        "title": "6.1.2.1 MD5-Challenge",
        "content": [
          {
            "text": "The MD5-Challenge method is based on the Challenge-Handshake Authentication Protocol (CHAP) defined in RFC 1994. The EAP RFC, RFC 3748, requires implementations to support MD5-Challenge. However, IEEE 802.11i requires the EAP method to support mutual authentication in order to avoid man-in-the-middle attacks. It cites MD5-Challenge as an example of a method that does not meet this requirement."
          },
          {
            "text": "Like other challenge-response methods, the primary advantage of MD5-Challenge is that passwords are never transmitted in clear text. Instead, the AS provides the STA with challenge text that the STA inputs into the MD5 algorithm along with the password. The resulting MD5 hash value is sent back to the AS, which performs the same operation as the STA. The MD5 algorithm ensures that the AS's hash value will match the response only if the STA has the correct password."
          },
          {
            "text": "Unfortunately, challenge-response methods are vulnerable to offline dictionary attacks and man-in-the-middle attacks unless they are carefully designed, with sufficient entropy in the challenge, keys of the appropriate length, a strong hash function, and secure protocol design. In the offline dictionary attack, the attacker captures both the challenge and the response and then iteratively cycles through the entries in a dictionary of likely passwords, inputting the challenge and each dictionary entry into the MD5 algorithm to find a match with the response. If the attacker finds a match, the entry that produced the match is the password. In the man-in-the-middle attack, the attacker impersonates the STA to the AS and the AS to the STA. This configuration allows the attacker to get the correct response from the STA without the AS ever knowing that it did not originate from an authorized entity."
          },
          {
            "text": "To mitigate the risk of dictionary and man-in-the-middle attacks, challenge-response methods such as MD5-Challenge can be tunneled within a method that encrypts the entire challenge-response sequence. In this scenario, the clear text challenge is encrypted, and the encrypted response is encrypted a second time.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "time. This approach is a common configuration for WLANs that rely on IEEE 802.1X port-based access control and is designed to help prevent dictionary and man-in-the-middle attacks. Unfortunately, the method used to establish the encrypted tunnel may itself be vulnerable to a man-in-the-middle attack, unless the tunnel establishment employs a method based on mutual authentication. If such an attack is successful, then the encrypted tunnel no longer hides information from the adversary because the adversary established the tunnel in performing the attack and has the keys necessary to encrypt and decrypt EAP traffic. Organizations should be aware that it is not possible to eliminate completely the risk of successful dictionary or man-in-the-middle attacks for challenge-response methods."
          }
        ]
      },
      {
        "title": "6.1.2.2 One-Time Password (OTP)",
        "content": [
          {
            "text": "The OTP method, which is based on RFC 2289 and RFC 2243, involves the use of an identical OTP generator on the peer and authenticator. The generator iterates a secure hash function a specified number of times using a passphrase and random seed as the initial input. After each successful authentication transaction, the number of iterations is reduced by one, resulting in a unique series of passwords. The OTP generator can reside on a hardware token or in software on a client computer (e.g., a STA). The OTP method cannot make any of the WLAN required security claims, but potentially could be used if it were tunneled within another method that can support the required claims."
          }
        ]
      },
      {
        "title": "6.1.2.3 Generic Token Card (GTC)",
        "content": [
          {
            "text": "The GTC method is used for hardware token schemes that require user input. The EAP Request contains a displayable message, and the EAP Response contains the token-generated information needed for authentication. Like MD5-Challenge and OTP, GTC does not support any of the required WLAN security claims, but could be used if it were tunneled within another method that can support the required claims."
          }
        ]
      },
      {
        "title": "6.1.3 TLS-Based EAP Methods",
        "content": [
          {
            "text": "The EAP methods defined in RFC 3748 have a number of serious security shortcomings; one of the most significant is that they do not generate key material. Without key material, the WLAN software on the STA and AP cannot apply protections to the traffic between STA and AP, as required for WLAN security. Consequently, IEEE 802.11 RSN solutions must deploy EAP methods other than those defined in RFC 3748 for the networks to be operational, regardless of the level of security desired. RFC 3748 states that due to the complexity of developing key generation algorithms, EAP methods should be based on well-established and analyzed key establishment and generation techniques. In practice, this recommendation limits potential methods to those based on the following key establishment and generation protocol: Transport Layer Security (TLS), a revision of Secure Sockets Layer (SSL), which is most commonly used to secure Web site communications."
          },
          {
            "text": "TLS has emerged as the dominant protocol for EAP methods that support IEEE 802.11 RSNs. TLS can use public key certificates for authentication and secure transfer of key material; it also supports# Authentication via Pre-Shared Keys"
          },
          {
            "text": "TLS is designed either to authenticate a server to a client or to mutually authenticate the client and server to each other. For a device to be authenticated using TLS, it must host a public key certificate or be provisioned with a pre-shared key. In an IEEE 802.11 RSN context, if TLS using certificates is used only to authenticate the AS and generate key material, then only the AS must possess a certificate. In addition, the STA needs to have a copy of the AS's certificate in order to authenticate the AS. In this scenario, the AS must authenticate the STA using one or more additional EAP methods tunneled within the TLS session. However, if TLS with certificates is used for mutual authentication, then both the STA and the AS must have certificates. Mutual TLS authentication generally is more secure than one-way TLS authentication coupled with one or more additional EAP methods."
          }
        ]
      }
    ]
  },
  {
    "title": "CURRENT_PAGE_RAW_OCR_TEXT",
    "subsections": [
      {
        "content": "be frustrated if performance suffers as a result."
      },
      {
        "title": "Figure 6-1",
        "content": [
          {
            "text": "shows a hypothetical WLAN that uses the EAP-TLS method for authentication. Certificates are located on all of the STAs and the AS. In an infrastructure with several thousand STAs and only several ASs, the need for client certificates greatly increases the level of PKI support required. Several WLAN vendors support EAP-TLS in their STA software. Microsoft also supports a version of EAP-TLS in its Windows XP operating system."
          },
          {
            "subsection": "6.1.3.2 EAP-TTLS",
            "text": []
          },
          {
            "text": "EAP-TTLS extends EAP-TLS to allow for one-way TLS authentication in addition to mutual TLS authentication. When one-way authentication is used, the AS is authenticated to the STA in a TLS handshake, which also creates an encrypted tunnel between the STA and AS. The tunnel is then used to protect a second authentication transaction in which the STA is authenticated to the AS. In EAP-TTLS, this second transaction is called an inner authentication method and occurs in what are termed InnerApplication messages. These messages consist of a series of attribute-value pairs (AVP) that describe the inner application and specify the standard protocols and algorithms that support it. The AVP format is compatible with RADIUS, thereby enabling easy integration with existing authentication protocols that RADIUS supports. The AVP format is extensible, allowing new inner applications and corresponding AVPs to be defined as needed. Currently supported inner applications include EAP methods, CHAP, and PAP. When the inner application is another EAP method, it is referred to as the inner EAP method."
          },
          {
            "text": "The use of EAP-TTLS is similar to Web sites that establish a protected channel, and then prompt for a username and password. The client computer first uses TLS to validate the Web server's certificate and establish an encrypted session with the server. At that point, passwords sent to the Web server are encrypted and therefore protected from eavesdropping. EAP-TTLS operates in a similar manner; the STA validates the AS's certificate and uses the resulting TLS session to transfer user credentials securely."
          }
        ]
      },
      {
        "title": "Figure 6-2",
        "content": [
          {
            "text": "shows a hypothetical WLAN that uses the EAP-TTLS method for authentication. The configuration is identical to the EAP-TLS example in Figure 6-1, but in this case a certificate is present on the AS only."
          },
          {
            "text": "An advantage of EAP-TTLS relative to EAP-TLS is that it can support legacy authentication methods, using them as the inner authentication method. For example, if an organization has mature security processes and a large investment in an existing identity management system based on passwords, tokens, or biometrics, then it might make sense to leverage that system for its WLANs. It might appear that eliminating the requirement for certificates on STAs (the clients) greatly reduces the administrative complexity of the required supporting PKI; installing certificates on a small number of ASs is considerably easier than installing them on hundreds or thousands of computers or smart cards. However,\n```# Current Page Raw OCR Text"
          },
          {
            "text": "The root certificate must be delivered securely to every client to prevent man-in-the-middle attacks. Many desktop operating systems include system management tools for the distribution of root certificates to clients. Alternatively, root certificate distribution can be accomplished by the IT department when configuring computers for end users."
          },
          {
            "text": "The TLS tunnel protects the inner application from several attack types, including replay attacks and dictionary attacks. Unfortunately, it does not always offer strong assurance against man-in-the-middle attacks. Another shortcoming of EAP-TTLS is that it is only as strong as the inner application authentication method that occurs within the TLS tunnel. For instance, if EAP-TTLS is used with a legacy system that allows weak passwords, then that implementation of EAP-TTLS is weak, which in turn means the IEEE 802.1X port-based access control that relies on that implementation of EAP-TTLS is weak. In a cascading fashion, the strength of nearly all elements' RSN protections is rooted in the strength of the EAP-TTLS inner application to authenticate the STA, which is left unspecified. Therefore, organizations that implement EAP-TTLS should carefully consider the risks associated with any candidate method before deploying it."
          }
        ]
      },
      {
        "title": "6.1.3.3 PEAP",
        "content": [
          {
            "text": "PEAP is the product of a joint development effort by engineers from Microsoft, Cisco Systems, and Extundo. PEAP's characteristics are very similar to EAP-TTLS. Like EAP-TTLS, PEAP uses certificates and leverages TLS only to verify the AS's identity to the STA and establish a secure communications channel to protect the transaction in which the STA authenticates to the AS. As with EAP-TTLS, no client certificates are required; however, provisioning the root certificate on each and every client is a mandatory security requirement."
          },
          {
            "text": "The main difference between EAP-TTLS and PEAP is that PEAP's tunneled authentication transaction is another EAP method rather than an exchange of AVPs. These tunneled EAP methods, also called inner EAP methods, might be an RFC 3748 method or a more recently developed EAP method. In practice, this distinction usually is not important because both EAP-TTLS and PEAP can run on any network topology or protocol, are compatible with RADIUS, and can interoperate with any AP, none of which require method-specific code."
          },
          {
            "text": "Given the similarities between EAP-TTLS and PEAP, it is possible that one will emerge as a de facto standard while the other becomes superfluous, but it is unclear which is more likely to become the standard at this time. A number of vendors are implementing EAP-TTLS in their WLAN products, and EAP-TTLS client software is available for most major operating systems (e.g., Linux, Mac OS, Microsoft Windows). PEAP has strong support from both Microsoft and Cisco Systems, which could encourage other vendors to implement PEAP in their solutions. In addition, Microsoft Windows XP provides native support for PEAP, but not EAP-TTLS. Organizations that require EAP-TTLS for Windows XP STAs need to procure third-party software; an open-source EAP-TTLS plug-in is...# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "available for the native Windows supplicant. Also, the Windows version of PEAP supports MS-CHAPv2 only, which currently limits its use to authentication with Microsoft domains or Active Directory. Organizations that need PEAP to interoperate with third-party ASs need to procure compatible third-party PEAP client software. Unfortunately, there are different non-interoperable implementations of PEAP, so organizations should take care that their server and client versions are compatible; they must also be compatible with the method used to store user accounts on the backend authentication database. Both versions should also fulfill the organization's security requirements. New industry developments could change the relative merits of each method. Neither EAP-TTLS nor PEAP has been approved as an IETF standard; EAP-TTLS is defined in an Internet-Draft, but the PEAP Internet Draft has expired. Given the rapid changes in this area, organizations are encouraged to obtain the latest information before selecting one of these methods."
          }
        ]
      },
      {
        "title": "6.1.3.4 EAP-FAST",
        "content": [
          {
            "text": "EAP-FAST was developed by Cisco Systems. What distinguishes EAP-FAST from other TLS-based methods is that it establishes the encrypted tunnel using what it calls a Protected Access Credential (PAC), which is effectively a pre-shared key; alternatively, a public key certificate can be used. The tunnel is then used to protect an inner EAP method, much like PEAP. The use of PACs eliminates the need to have certificates on either the STA or AS. The protocol also includes mechanisms for refreshing PACs after a successful authentication. EAP-FAST is especially suitable for unsophisticated devices that might not have the computing power to perform TLS handshakes frequently without adversely impacting the user's experience. For example, EAP-FAST might enable household appliances, vending machines, and other small devices not typically connected to WLANs today to participate in IEEE 802.11 RSNs more cheaply and efficiently than they could with other EAP methods."
          },
          {
            "text": "The major problem with EAP-FAST is initializing each STA with its first PAC. Provisioning initial PACs is not easier than provisioning certificates. Cisco has implemented features on its WLAN equipment that can provision PACs securely, but they involve having a digital certificate on the AS, which must be installed on each client before it can be used. Given these limitations, EAP-FAST in practice has similar PKI requirements to EAP-TTLS and PEAP, even if the certificates are not used in the EAP conversation itself. The alternative, easier method of PAC provisioning does not require certificates, but is also not secure. Currently, Cisco is the only vendor supporting EAP-FAST, but it might gain wider appeal if it becomes an official IETF standard."
          }
        ]
      },
      {
        "title": "6.1.4 Summary of EAP Methods and Security Claims",
        "content": [
          {
            "text": "Table 6-2 reviews the security claims of each of the EAP methods discussed in Sections 6.1.2 and 6.1.3. None of the RFC 3748 EAP methods can make any of the relevant security claims, but these methods can serve as an inner EAP method when tunneled inside one of the TLS methods. As Table 6-2 shows, the TLS methods provide similar security claims, primarily because TLS protections.# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "offer the basis for most of these claims.",
        "content": [
          {
            "text": "The main difference between them is the level of PKI support required, which is summarized in Table 6-3. Also, EAP-FAST can be configured to use non-certificate-based shared secrets such as pre-shared keys. Another difference between the methods is the level of vendor support they receive. EAP-TTLS and PEAP are emerging as the industry-preferred EAP methods for WLANs. EAP-FAST is currently a Cisco-proprietary approach but could gain a wider following if its Internet Draft progresses to RFC status."
          }
        ]
      },
      {
        "title": "6.2 Developing an EAP Method Strategy",
        "content": [
          {
            "text": "None of the EAP methods offers the best solution for all environments; the selection of an EAP method depends on several factors, including whether an organization intends to leverage existing enterprise authentication infrastructure for its WLAN authentication transactions. If an existing user database is to be used, the EAP method must be compatible with the format in which user credentials are stored. Nothing in the standards that define RSNs\u2014including IEEE 802.11i, IEEE 802.1X, and EAP\u2014requires that STAs and ASs support more than one EAP method. However, the Wi-Fi Alliance requires EAP-TLS for certification. Some products support more options than others. Accordingly, organizations should thoroughly understand their authentication requirements before designing RSNs and procuring WLAN equipment. They should also be aware of any security policy or infrastructure limitations inherent in the existing authentication infrastructure that they might want to leverage for RSN authentication. For example, if they currently maintain a AAA server that by policy is configured to support either tokens or certificates, but not passwords, then they might seek STAs that can work within those constraints. If a password-based system over EAP is selected, the cryptographic protection of the outer TLS tunnel should be extended as far as possible, preferably all the way to the authentication server, but at least to a trusted secure network. This applies to both TTLS and PEAP. Finally, they may want to conduct a risk assessment of various options of EAP methods before selecting one. Some questions that organizations should address before choosing an EAP method are discussed in Table 6-4."
          }
        ]
      },
      {
        "title": "6.3 EAP Security Considerations",
        "content": [
          {
            "text": "The RSN framework specifies the use of IEEE 802.1X authentication and EAP, but leaves a number of critical security implementation details to the discretion of the organization implementing the framework. Potential problems include an adversary impersonating an AP, capturing wireless authentication traffic as it travels over the network between the AP and AS, and exploiting AS security vulnerabilities. This section discusses some of the risks associated with improper implementations and how to mitigate those risks."
          },
          {
            "subsection": "6.3.1 Secure STA Configuration",
            "text": []
          },
          {
            "text": "EAP authentication methods such as EAP-TLS, EAP-TTLS, EAP-FAST, and PEAP use certificates to authenticate the AS to the STA. One potential pitfall to this approach is that it enables an adversary to impersonate the WLAN infrastructure if that adversary can present a valid certificate, and if WLAN clients are not configured properly. It is common for a WLAN client to be# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "configured by default to",
        "content": [
          {
            "text": "accept certificates signed by any certification authority (CA) for which it has a corresponding CA certificate. In most cases, a variety of third-party CA certificates are already installed on the client. This allows an attacker to impersonate the WLAN infrastructure successfully with an SSID and a valid certificate signed by any of the third-party CAs that the client recognizes. Once the attacker has tricked the client into associating with the bogus AP, it might be able to capture the authentication credentials needed to access the real infrastructure. In this scenario, the security of the RSN is circumvented simply as a result of having multiple CA certificates on the STA, which is a common configuration on many computers."
          },
          {
            "text": "To prevent this situation, STAs should be configured to authenticate to specific servers only, not just any server with a valid certificate. Ideally, servers should be identified by their fully qualified domain name (e.g., as1.xyzAgency.gov) so that the name listed in the AS's certificate can be compared with the name specified in the STA's configuration. STAs should also be configured to accept certificates only from the CA that signed the server certificates. With these two controls in place, the attacker would either have to breach the CA or get it to provide it a certificate with the same name as the authentication server. Both of these attacks are considerably more difficult to execute successfully than the relatively trivial one described earlier. As an additional security measure, an organization might consider using its own CA rather than that of a third-party vendor, if it does not trust the third party to implement the proper controls. This approach requires installing the organization's CA certificate on each STA."
          },
          {
            "text": "Figure 6-3 shows an example of certificate restrictions on a computer running Microsoft Windows XP Professional. The computer is configured to use EAP-TLS when connecting to a certain SSID, and to accept server certificates signed by either the Symantec Root CA or the Thawte Personal Basic CA. Nothing in the IEEE 802.11i specification or related standards requires a configuration like this one, but it is essential when a client authenticates the WLAN infrastructure using certificates. Organizations deploying RSNs should consider carefully the configuration of their STAs before activating a new wireless RSN."
          }
        ]
      },
      {
        "title": "6.3.2 Unprotected Links",
        "content": [
          {
            "text": "The infrastructure supporting an RSN authentication transaction consists of three components: a STA, an AP, and an AS. IEEE 802.11i provides a rigorous approach to securing the communications link between the STA and the AP. IEEE 802.1X port-based access control ensures that entities on the STA-side of the AP cannot reach the AS-side of the AP prior to successful authentication. However, both standards explicitly state that protection of the communications link between the AP and the AS is out of their scope. Therefore, organizations deploying RSNs must focus on this gap to ensure the end-to-end security of the WLAN solution."
          },
          {
            "text": "Figure 6-4 illustrates the problem. EAP traffic can be transmitted in the clear between the AP and AS and still not violate IEEE 802.11i.# Specifications"
          },
          {
            "text": "If attackers have access to that communications link, they might be able to view or manipulate traffic in a manner that would allow them to compromise WLAN security. Also, since the key is distributed from the AS to the AP, the key distribution mechanism must be secure. To prevent attackers from viewing or manipulating traffic, organizations should ensure that traffic between the AP and AS is protected sufficiently through cryptography. Ways to accomplish this are as follows:"
          },
          {
            "text": "\nEstablish a dedicated virtual private network (VPN) between the AP and AS using a VPN protocol such as IPsec.\nUse tunneled EAP methods only, such as EAP-TLS, EAP-TTLS, EAP-FAST, and PEAP.\nUse appropriate key wrapping mechanisms to distribute the key.\n"
          }
        ]
      },
      {
        "title": "6.3.3 Attacks on the Authentication Server",
        "content": [
          {
            "text": "Operating system security was not a major concern for pre-RSN WLANs because of the limited functionality of most APs. In an RSN, the core STA authentication function is performed on a separate authentication server, which typically runs on a sophisticated operating system such as UNIX, Linux, or Windows. A breach of the operating system or an application or service with operating system privileges could lead to a complete compromise of RSN security. Accordingly, WLAN security should include hardening of the servers that support the authentication process."
          }
        ]
      },
      {
        "title": "6.4 EAP Multiplexing Model and Related Support Requirements",
        "content": [
          {
            "text": "This section provides additional information on the conceptual architecture of EAP for readers seeking a better understanding of how EAP works and how it interacts with other protocols. Readers who do not need this information should skip this section and proceed to Section 6.5."
          },
          {
            "text": "RFC 3748 provides a framework for EAP using a four-layer conceptual model described in Table 6-5. It is called the EAP multiplexing model because it describes how EAP can handle multiple EAP methods in the same EAP implementation."
          },
          {
            "text": "In a typical IEEE 802.11 RSN configuration, communication flows through the four layers as shown in Figure 6-5. Messages traveling between layers within a device are transported logically within the device's EAP software implementation. Flows between devices occur over a network using lower-layer protocols. Communication flows occur in both directions, as shown by the arrows in the figure. For example, when the EAP method on the AS generates a request, the EAP method on the STA responds to that request. When the AS receives the response, it replies with either a success or failure message, accompanied by key material in the case of success. The Peer/Authenticator layer on each device determines whether to pass the message through (in the case of an AP) or forward it to the appropriate EAP method (in the case of the STA and AS). The EAP layer packages the messages for the lower layer protocols, which are typically IEEE 802.11 or RADIUS."
          },
          {
            "text": "EAP implementations differ considerably for the method and lower layers, but are very similar for the middle two layers. Organizations need to determine how to implement the method and lower layers in their environments, which involves selecting one or more EAP methods (discussed previously in Section 6.2) and establishing the protocols that the AS will use to transport.# Authentication Messages"
          },
          {
            "text": "Typical support requirements and configurations for each of the key WLAN components are discussed in Table 6-6. The AP does not need to support EAP methods, but it must support the lower layer communications protocols of both the STA and AS."
          },
          {
            "text": "An important concept at the lower layer is EAP encapsulation, which describes how EAP packets are transferred between peer and authenticator. The encapsulation method can differ depending on the network environment. The most common form of EAP encapsulation in IP networks is EAP over RADIUS. In a typical WLAN configuration, the AS either hosts the AAA database or acts as a \"front end\" to the real user database, which might be Active Directory, LDAP, Kerberos, or numerous other alternatives; the AS uses RADIUS to communicate with STAs and other devices. For this reason, the AS is often called the RADIUS or AAA server."
          },
          {
            "text": "In some implementations, the STA does not have access to IP network services until it successfully authenticates with an AS. When IP services are unavailable, the most common approach is to use EAP over LAN (EAPOL) encapsulation, which enables EAP to be transported in the frames of IEEE 802 link layer protocols. EAPOL is defined in IEEE 802.1X. The WLAN vendor's EAP implementation typically will determine whether the transport mechanism is EAP over RADIUS or EAPOL."
          }
        ]
      },
      {
        "title": "6.5 Summary",
        "content": [
          {
            "text": "Defined in RFC 3748, EAP is used during the authentication phase of an IEEE 802.11 RSN and provides the authentication framework for IEEE 802.11 RSNs that use IEEE 802.1X port-based access control. EAP can be adapted to new authentication methods as they become available and can operate over a variety of different network and link layer protocols, including IP and IEEE 802-series medium access protocols. For these reasons, EAP is well-suited to providing authentication services for WLANs."
          },
          {
            "text": "EAP defines the stages of an EAP conversation that consists of one or more EAP methods. The EAP methods perform the authentication transaction and generate key material. While the basic rules of the EAP conversation are common to all EAP implementations, the EAP methods can vary from one implementation to another, requiring different levels of user interaction, using different authentication methods, and employing different cipher suites. This flexibility has benefits, but it may also introduce risk. To maintain security, organizations should select EAP methods appropriate to their environment."
          },
          {
            "text": "IANA has defined numerous EAP method types, but not all of these are appropriate for WLAN applications. For example, RFC 3748 defines three methods\u2014MD5-Challenge, One-Time Password, and Generic Token Card\u2014but none of these can satisfy the necessary security requirements for WLANs. TLS-based methods such as EAP-TLS, EAP-TTLS, PEAP, and EAP-FAST provide more robust alternatives that can satisfy these requirements. The primary distinction between them is the level of PKI support required. EAP-TLS requires both STAs and ASs to possess valid certificates. EAP-TTLS and PEAP can support configurations with AS certificates only. EAP-FAST can support.# EAP Authentication"
          },
          {
            "text": "with certificates or, alternatively, with no certificates, instead using PACs, a type of pre-shared keys. Before organizations select WLAN equipment, they should review their existing identity management infrastructure, authentication requirements, and security policy to determine the EAP method or methods that are most appropriate in their environment, then purchase systems that support the chosen EAP methods."
          },
          {
            "text": "Many EAP methods are currently defined only in IETF Internet-Drafts and thus are not yet official standards. Organizations are encouraged to obtain the latest available information before making final determinations on their IEEE 802.11 RSN authentication architecture and product procurement."
          }
        ]
      },
      {
        "title": "7. FIPS and WLAN Product Certifications",
        "content": [
          {
            "text": "Federal agencies are required to use FIPS-approved cryptographic algorithms that are contained in FIPS-validated cryptographic modules. As mentioned in Section 2.1.2, Wi-Fi Protected Access (WPA) and WPA2 are security specifications developed by the Wi-Fi Alliance, a consortium of wireless product vendors that certifies the interoperability of WLAN products through its Wi-Fi CERTIFIED\u2122 testing and branding program. This section describes FIPS 140-2 certification as it applies to 802.11 wireless networks. It also provides an overview of the Wi-Fi Alliance certification programs, with an emphasis on WPA and WPA2. Organizations planning to deploy RSNs should understand the FIPS requirements and the WPA and WPA2 certifications so that they can procure products with the certification levels that best match their WLAN requirements."
          },
          {
            "subsection": "7.1 FIPS 140-2 Certification",
            "text": []
          },
          {
            "text": "If a Federal Government wireless network requires security protection, then the data traversing the network must be protected in one of two ways:"
          },
          {
            "text": "\nThe wireless equipment (APs and STAs) must be FIPS 140-2 certified and must operate in FIPS mode.\nThe data on the wireless network must be protected by a VPN. The most common choice is an IPsec VPN. The VPN's crypto modules must be FIPS 140-2 certified.\n"
          },
          {
            "text": "In circumstances in which a wired network would not require security protection, a wireless network can also operate without the required security protections. Some examples of this are:"
          },
          {
            "text": "\nA wireless network in a conference room that is not connected to either the agency's internal network or to the Internet, which is provided to enable conference participants to communicate with each other.\nA wireless network, connected to the Internet outside of the agency's firewall. Unprotected clients that connect to the wireless network would be able to access the Internet, but accessing the agency's internal network would require security protection.\n"
          },
          {
            "text": "The above requirements cover protection of the data traversing a wireless network. Authenticating to the network using 802.1X and EAP is somewhat more complicated since EAP standardization is in a state of flux. The IETF's EAP Method Update (emu) working group is working to standardize EAP-TLS and to extend it so that it will meet the needs of today's wireless and other.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "applications but still be backward-compatible with EAP-TLS as defined in RFC 2716. NIST has not standardized on a particular EAP method, so there is no EAP-related FIPS. NIST's Implementation Guidance for FIPS PUB 140-2 allows the use of EAP methods based on the TLS protocol (or on SSL v3.1, but not on previous versions of SSL) or on EAP-TLS. Thus, EAP methods that satisfy that requirement and are accepted as secure by the wireless industry may be used by government agencies. Since the RADIUS server is responsible for many of the cryptographic security operations in 802.11i, government agencies are required to purchase RADIUS servers whose crypto modules are FIPS-validated."
          }
        ]
      },
      {
        "title": "7.2 Wi-Fi Alliance Certification Programs",
        "content": [
          {
            "text": "The Wi-Fi Alliance began conducting interoperability testing in April 2000 and has since awarded its WiFi CERTIFIED label to over 2,500 WLAN products. Product categories include access points and a wide variety of clients, including embedded systems, internal and external wireless network interface cards, Universal Serial Bus (USB) devices, and printers."
          },
          {
            "text": "Table 7-1 reviews the three basic types of certifications: radio standards, network security, and multimedia content support. Radio standard certifications involve the electrical engineering aspects of WLAN communications, such as the frequency, power, and modulation of radio signals and the rules by which STAs contend for available channels. The certifications for network security, the subject of this guidance document, cover topics such as authentication and confidentiality services. Multimedia content support refers to quality of service mechanisms that give priority to streaming audio and video over other data, which helps prevent users from experiencing irregular, intermittent multimedia content delivery. To address quality of service interoperability issues, the Wi-Fi Alliance created its Wi-Fi Multimedia (WMM) certification."
          },
          {
            "text": "All Wi-Fi CERTIFIED\u2122 products must pass interoperability testing with at least one of the radio standards. Otherwise, there would be no assurance that the products could perform their core function of WLAN communications. The network security and multimedia content support certifications supplement the radio standards certification. WPA compliance was initially optional for Wi-Fi CERTIFIED\u2122 products, but was subsequently made mandatory. As of March 1, 2006, WPA2 compliance is mandatory; however, there is a grandfather clause for products that were certified WPA-compliant before that date. Wi-Fi Multimedia (WMM) compliance is likely to remain optional for the foreseeable future."
          },
          {
            "text": "The Wi-Fi Alliance also manages a licensing program for Wi-Fi providers called Wi-Fi Zone. Organizations participating in the program agree to use Wi-Fi CERTIFIED\u2122 products only and adhere to certain service standards. Customers that see the Wi-Fi Zone logo at an establishment offering Wi-Fi services are offered assurance that they can connect securely and reliably to the Internet. The Wi-Fi Alliance's Web Page (http://certifications.wi-fi.org/wbcs_certified_products.php) contains a search engine that allows viewers to search for various types of wireless equipment that conforms to some or all of its Certification Programs.# 7.3 Wi-Fi Alliance Network Security Certifications"
          },
          {
            "text": "WPA and WPA2 are the network security certifications offered by the Wi-Fi Alliance. This section describes these certifications and highlights their differences. It also explains the different certification levels available for both WPA and WPA2: Personal, which uses a pre-shared key for authentication; and Enterprise, which certifies the use of EAP authentication in addition to pre-shared key."
          }
        ]
      },
      {
        "title": "7.3.1 WPA Features",
        "content": [
          {
            "text": "The Wi-Fi Alliance introduced WPA in early 2003 to address serious vulnerabilities inherent in WEP, which was the only available IEEE 802.11 security protection at that time. WPA is a subset of IEEE 802.11i that provides a solution to WEP's major problems. To accomplish this protection, WPA leverages the following core security features from IEEE 802.11i:"
          },
          {
            "text": "\nIEEE 802.1X and EAP authentication\nKey generation and distribution based on the IEEE 802.11i 4-Way Handshake\nTKIP mechanisms including\nEncapsulation and decapsulation\nReplay protection\nMichael MIC integrity protection.\n"
          },
          {
            "text": "Table 7-2 summarizes the primary features provided by IEEE 802.11i that are not included in the WPA test criteria. Organizations that have deployed WPA-compliant equipment can still support IEEE 802.11i RSNs based on TKIP; however, organizations need to determine if the absence of the features not present in WPA is acceptable in their environment. For government organizations, where FIPS compliance is required, this is not acceptable."
          }
        ]
      },
      {
        "title": "7.3.2 WPA2 Features",
        "content": [
          {
            "text": "Released in September 2004, WPA2 is the Wi-Fi Alliance's interoperability certification program for the complete ratified version of IEEE 802.11i. If a product holds the WPA2 certification, it complies completely with the IEEE 802.11 standard as amended by IEEE 802.11i and should work seamlessly with other WPA2-certified products under most operating conditions. Also, WPA2 is backward compatible with WPA, so any WPA2 product should be able to interoperate with a WPA product. Some products may require a hardware upgrade to achieve WPA2 compliance; older products, in general, cannot be upgraded to WPA2."
          },
          {
            "text": "WPA2 testing validates interoperability with selected EAP methods only, so WPA2 certification does not imply interoperability with all possible EAP methods. Currently, certification involves interoperability testing with the following EAP methods:"
          },
          {
            "text": "\nEAP-TLS\nEAP-TTLS/MSCHAPv2\nPEAPv0/EAP-MSCHAPv2\nPEAPv1/EAP-GTC\nEAP Subscriber Identity Module (EAP-SIM).\n"
          },
          {
            "text": "When a method is listed with a \"/\", the first term is the actual EAP method, and the second term is the inner method tunneled within it. The Alliance may add to this list over time. Organizations procuring WPA2 products should either select EAP methods from the tested list or conduct their own interoperability testing on the equipment with their own authentication infrastructures.# WPA2 Certification and Federal Requirements"
          },
          {
            "text": "WPA2 certification does not currently exist for products providing AS functionality. When the Alliance conducts its interoperability testing, it uses AAA servers running leading implementations of RADIUS and the tested EAP methods, but does not publicize which these are. If an organization selects a AAA server running a different implementation of RADIUS or the chosen EAP method, then there is no guarantee of interoperability. Conducting independent testing in enterprise environments is advised."
          },
          {
            "text": "Because Federal agencies are required to use encryption algorithms that are FIPS-approved, such as AES, they should procure WPA2 components with FIPS-validated cryptographic modules. WPA equipment is not FIPS-compliant because it utilizes the RC4 algorithm instead of AES. Products can obtain WPA2 certification without being FIPS-validated, so Federal agencies should check for both WPA2 certification and FIPS validation."
          }
        ]
      },
      {
        "title": "7.3.3 Modes of Operation",
        "content": [
          {
            "text": "Both WPA and WPA2 have two modes of operation: Personal and Enterprise. The Personal mode involves the use of a pre-shared key for authentication, while the Enterprise mode uses IEEE 802.1X and EAP for this purpose. Products can be certified for both modes or for Personal mode only. Therefore, organizations that plan to use an authentication server rather than pre-shared keys should look specifically for the Enterprise certification. The use of an authentication server rather than pre-shared keys is recommended for most situations because of the impracticality of generating, deploying, and periodically replacing pre-shared keys. The lack of individual user/client authentication in most PSK APs is another reason to avoid the use of pre-shared keys."
          }
        ]
      }
    ]
  },
  {
    "title": "8. WLAN Security Best Practices",
    "subsections": [
      {
        "content": "As explained in the previous sections, IEEE 802.11 RSNs are complex, involving multiple devices, protocols, and standards. This section distills this complexity into a manageable and actionable set of...# Recommendations for WLAN Security"
      },
      {
        "content": "Recommendations that organizations can implement to provide reasonable assurance that they are protected against most WLAN security threats. The recommendations should be particularly helpful to organizations that have made a decision to integrate WLAN technology into their computer networks and want to determine the best way to do it. The recommendations should also be helpful to organizations that are already managing WLANs, but are not satisfied with the level of security they provide; they might want to upgrade, replace, and configure their infrastructure so that it is capable of supporting RSNs and other security controls."
      },
      {
        "content": "To be effective, WLAN security should be incorporated throughout the entire life cycle of WLAN solutions, involving everything from policy to operations. This section references a five-phase life cycle model to help organizations determine at what point in their WLAN deployments a recommended best practice might be relevant. The model is based on one introduced in NIST SP 800-64, Security Considerations in the Information System Development Life Cycle. Organizations may follow a project management methodology or life cycle model that does not directly map to the phases in the model presented here, but the types of tasks in the methodology and their sequencing are probably similar. The phases of the life cycle are as follows:"
      },
      {
        "title": "Phase 1: Initiation",
        "content": [
          {
            "text": "This phase includes the tasks that an organization should perform before it starts to design its WLAN solution. These include providing an overall vision for how the WLAN would support the mission of the organization, creating a high-level strategy for the WLAN's implementation, developing a WLAN use policy, and specifying business and functional requirements for the solution."
          }
        ]
      },
      {
        "title": "Phase 2: Acquisition/Development",
        "content": [
          {
            "text": "For the purposes of this guide, the Acquisition/Development phase is split into the following two phases:"
          },
          {
            "subsection": "Phase 2a: Planning and Design",
            "text": []
          },
          {
            "text": "In this phase, WLAN network architects specify the technical characteristics of the WLAN solution and related network components. These characteristics include the EAP method or methods used to support authentication; the protocols used to support communication between AP and AS; access control lists and firewall rules to segregate WLAN traffic; and the nature of the supporting PKI. The types of clients to be deployed also need to be considered, since they can affect the desired security policies. There is a wide variety of supplicants that may or may not support desired EAP methods; care must be taken to ensure that the security policy can be employed and enforced by all components (client, AP, and AS). A site survey is typically conducted to help determine the number and placement of access points, as well as how they integrate into the existing network."
          },
          {
            "subsection": "Phase 2b: Procurement",
            "text": []
          },
          {
            "text": "This phase involves specifying the number and type of WLAN components that must be purchased, the feature sets they must support, and any certifications they must hold.# WLAN Security Lifecycle Phases"
          }
        ]
      },
      {
        "title": "Phase 3: Implementation",
        "content": [
          {
            "text": "In this phase, procured equipment is first configured to meet operational and security requirements, and then installed and activated on a production network. Implementation includes altering the configuration of other security controls and technologies, such as security event logging, network management, AAA server integration, and PKI."
          }
        ]
      },
      {
        "title": "Phase 4: Operations/Maintenance",
        "content": [
          {
            "text": "This phase includes security-related tasks that an organization should perform on an ongoing basis once the WLAN is operational, including log review and rogue AP detection."
          }
        ]
      },
      {
        "title": "Phase 5: Disposition",
        "content": [
          {
            "text": "This phase encompasses tasks that occur after a system or its components have been retired, including preserving information to meet legal requirements, sanitizing media, and disposing of equipment properly."
          },
          {
            "text": "The recommendations presented in this section are provided in tables corresponding to the life cycle phases. Each recommendation is accompanied by a brief explanation of the rationale for its inclusion, and is rated as \"best practice\" or \"should consider\". Organizations are strongly encouraged to adopt the \"best practice\" recommendations. Failure to implement them significantly increases the risk of a WLAN security failure. Organizations should also examine each of the \"should consider\" recommendations to determine their applicability to the target environment. In general, \"should consider\" recommendations enhance security beyond what can be achieved through the \"best practice\" recommendations. A \"should consider\" recommendation should be rejected only if it is infeasible or the reduction in risk from its implementation does not justify its cost."
          },
          {
            "text": "Organizations should develop their WLAN security controls based not only on the recommendations in the tables, but also using other guidance on security controls. FIPS Publication (PUB) 199 establishes three security categories\u2014low, moderate, and high\u2014based on the potential impact of a security breach involving a particular system. NIST SP 800-53 provides recommendations for minimum management, operational, and technical security controls for information systems based on the FIPS PUB 199 impact categories. The recommendations in NIST SP 800-53 should be helpful to organizations in identifying controls that are needed to protect networks and systems, which should be used in addition to the specific recommendations for WLANs listed in this document."
          },
          {
            "text": "Some large organizations divide their IT duties among various teams. For example, one group may be responsible for desktop and laptop support, while another might focus on the network infrastructure. In these organizations, implementation of a WLAN may require participation from multiple IT support teams. To assist with this division of labor, the tables identify the impacted WLAN components (i.e., STA, AP, AS, DS) for each of the listed recommendations. When the DS is listed, it refers to the switches, routers, and network media of the organization's enterprise network behind each AP. In most cases, these are part of a wired network."
          },
          {
            "text": "The tables can also serve as checklists; the status column on the right is blank.# so that IT staff can use it to measure progress toward implementation of the recommendations."
          }
        ]
      },
      {
        "title": "9. Case Studies",
        "content": [
          {
            "text": "This section presents three case studies to illustrate how various issues discussed in Sections 3 through 8 might be addressed in practice. Although the case studies are hypothetical, they are intended to resemble real-world problems and solutions. They do not cover all the aspects of system engineering or all the technical implementation details that an organization should consider when implementing an IEEE 802.11 RSN; they provide a representative sample of the issues an organization may face. The case studies are as follows:"
          },
          {
            "text": "\n\nCase Study 1: First Time WLAN Deployment. This case study presents the scenario of an organization that planned to deploy a WLAN for the first time. With no existing WLAN infrastructure to replace or update, the organization methodically applied the best practices introduced in this guide.\n\n\nCase Study 2: Transitioning an Existing WLAN Infrastructure to RSN Technology. This case study discusses an organization that had implemented WLAN technology already but later wanted to migrate to a RSN framework. Having just experienced a major WLAN security breach, the organization felt that it must act quickly. To meet its needs, the organization developed and implemented first an interim WLAN solution, and then a long-term one.\n\n\nCase Study 3: Supporting Users Who Are Not Employees. This case study presents the scenario of an organization that planned a future WLAN deployment, whose WLAN user population will consist of many people who are not employees, or perhaps may not have any prior relationship with the organization. It created a security architecture that allows for access from a very diverse set of users. Supporting these users might not require an IEEE 802.11 RSN.\n\n"
          },
          {
            "text": "Case Study 1: First Time WLAN Deployment. This case study presents the scenario of an organization that planned to deploy a WLAN for the first time. With no existing WLAN infrastructure to replace or update, the organization methodically applied the best practices introduced in this guide."
          },
          {
            "text": "Case Study 2: Transitioning an Existing WLAN Infrastructure to RSN Technology. This case study discusses an organization that had implemented WLAN technology already but later wanted to migrate to a RSN framework. Having just experienced a major WLAN security breach, the organization felt that it must act quickly. To meet its needs, the organization developed and implemented first an interim WLAN solution, and then a long-term one."
          },
          {
            "text": "Case Study 3: Supporting Users Who Are Not Employees. This case study presents the scenario of an organization that planned a future WLAN deployment, whose WLAN user population will consist of many people who are not employees, or perhaps may not have any prior relationship with the organization. It created a security architecture that allows for access from a very diverse set of users. Supporting these users might not require an IEEE 802.11 RSN."
          },
          {
            "text": "In each case study, the organization followed the information system development life cycle introduced in NIST SP 800-64, Security Considerations in the Information System Development Life Cycle, and the best practices discussed in Section 8."
          },
          {
            "subsection": "9.1 Case Study 1: First Time WLAN Deployment",
            "text": []
          },
          {
            "text": "For several months, many of agency XYZ's employees had requested the ability to read e-mail and access Web sites when they were in the agency's conference rooms. Several technically inclined users had suggested that a WLAN solution could provide this functionality more effectively than wired connectivity. The agency's IT group initially resisted implementation of WLAN technology, citing security concerns such as the vulnerabilities of WEP. These concerns were allayed substantially with the final release of IEEE 802.11i and its RSN framework. Additionally, the IT group knew they could now identify interoperable IEEE 802.11i-compliant products through the Wi-Fi Alliance's WPA2-Enterprise product certification program. Given these developments, the agency's CIO commissioned an enterprise WLAN deployment project in conjunction with other agency executives. The agency used the NIST SP 800-64 information system development life cycle model to guide the project, but# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "excluded the disposition phase because it would not occur until some time after the project had been completed.",
        "content": [
          {
            "subsection": "9.1.1 Phase 1: Initiation",
            "text": []
          },
          {
            "text": "The first step in the project plan was to conduct a risk assessment that identified agency information assets and the threats a new WLAN could pose to those assets. The assessment's conclusion was that the mission of the agency could be significantly impacted if external users were able to access the agency's internal network, and that a WLAN solution would need to provide reasonable protection against such threats."
          },
          {
            "text": "The second step in the project plan was to bring together the major stakeholders to draft a WLAN use policy and gather functional requirements for the WLAN solution. The stakeholder advisory panel agreed that the WLAN would be for the use of employees and full-time on-site contractors only; other users should be prevented from using the WLAN through the implementation of user authentication and authorization technology. The panel also wanted users to be able to roam to any conference room in the building without having to reconfigure their laptops or other wireless devices. Finally, the panel requested that users be able to access all information resources available from their wired desktops, including Internet access. The WLAN use policy also specified who is authorized to install APs (e.g. not end users), as well as which techniques would be used to detect and handle rogue APs."
          },
          {
            "text": "An attorney on the panel noted that the agency's memorandum of understanding (MOU) with several state governments explicitly prohibited the agency from using wireless networks to access sensitive information that the state governments enter into a database system that the agency calls StateConnect. A network engineer from the IT group had argued that this limitation was unnecessary because RSN protections offered a better defense against eavesdropping and data modification than the agency's wired networks. Nevertheless, the panel eventually agreed that the MOUs would need to be honored regardless of the assurance an RSN could provide. The solution would have to include technical controls to prevent WLAN users from accessing any portion of the StateConnect database system. However, the panel agreed that MOUs should be updated in the next revision cycle to account for advances in WLAN security."
          },
          {
            "subsection": "9.1.2 Phase 2: Acquisition/Development",
            "text": []
          },
          {
            "text": "With the WLAN use policy and a solid set of functional requirements in place, the IT staff started the acquisition/development phase of the project. The first step was a site survey to help determine the network architecture of the WLAN solution. All 20 conference rooms were located in the center of the building, which meant the risk of radio emanations beyond the property's perimeter was unlikely. Testing established that installing one AP in each conference room would provide adequate coverage for all except the two large conference rooms on the ground floor, which would require three APs to provide adequate connectivity. Testing also confirmed that WLAN emissions would be# WLAN Design and Implementation"
          }
        ]
      },
      {
        "title": "Overview",
        "content": [
          {
            "text": "Contained within the building. The resulting plan called for mounting the APs in the center of each conference room, immediately above the ceiling tiles. The design team wanted to segregate the APs from other network components to improve security and manageability. Unfortunately, the conference rooms were too far apart from each other to connect all of the APs to a dedicated WLAN hub or switch. Accordingly, in the network design, each AP was cabled to the nearest available switch, which typically reside in communications closets near each conference room."
          }
        ]
      },
      {
        "title": "Network Configuration",
        "content": [
          {
            "text": "The switches were configured to place each port supporting an AP on a single enterprise VLAN. The VLAN spanned the entire building and behaved as if all the APs were on a single local network segment, thereby providing the desired isolation from the rest of the network. The VLAN was connected to the rest of the agency's network through a router. To prevent WLAN users from reaching the StateConnect database, the plan specified an access control list (ACL) on the router that prohibited all traffic from any device on the WLAN to any servers supporting the database and vice versa."
          }
        ]
      },
      {
        "title": "Authentication Method",
        "content": [
          {
            "text": "Everyone on the project team quickly agreed that RSN authentication should be based on IEEE 802.1X port-based access control rather than pre-shared keys, primarily because the administrative burden of managing pre-shared keys would likely overwhelm the IT support staff and the fact that PSK does not always uniquely authenticate the end node. On the other hand, determining which EAP method to use with IEEE 802.1X generated more debate. Several technicians wanted to implement the WLAN as quickly and painlessly as possible. They wanted to use the wireless client support bundled with the operating system common to all of the agency's client computers. Then they argued that the logon servers (called domain controllers) supporting file, print, and messaging services should also serve as the ASs in the WLAN solution. This proposal suggested the use of PEAP with MS-CHAPv2 as the inner method. MS-CHAPv2 is a challenge-response method with characteristics similar to MD5-Challenge but with better security."
          }
        ]
      },
      {
        "title": "Security Considerations",
        "content": [
          {
            "text": "Unlike the IT support staff, the project manager and information security officer emphasized security over administrative convenience. They wanted authentication to involve a client PKI certificate. The agency was planning to deploy an enterprise PKI in six weeks, which would involve certificates on all agency-owned computers, including desktops, laptops, handheld devices, and servers. The WLAN project was an excellent application for the new PKI and would quickly demonstrate its value. The decision was made to integrate the WLAN with the PKI, which would cause a short project delay, but one that was believed well worth the slip in the schedule. This approach led to the decision that EAP-TLS would be the best choice. Fortunately, the existing domain controllers could also serve as the ASs for the WLAN in this configuration, so the IT support staff accepted this element of the design."
          }
        ]
      },
      {
        "title": "Equipment Procurement",
        "content": [
          {
            "text": "Once the project team completed the design documentation, the next step was to procure equipment. The results of the site survey demonstrated a need for 24 enterprise APs (three for each of the large conference rooms).# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "rooms, and 18 for the remaining conference rooms). Based on the selected design, no need existed for additional WLAN client software, switches, or AS infrastructure beyond what was already in-house. The agency sought APs that were WPA2-Enterprise certified and FIPS-validated for the AES encryption module used in the CCMP data confidentiality and integrity protocol. The agency also wanted a means for physically securing the reset button on the APs to help prevent tampering. The search resulted in two candidates, until a member of the project team realized that one of the two products was FIPS-validated for the IPsec AES implementation on its wired interface, but not for the CCMP implementation on its wireless interface. This attention to detail was critical in identifying appropriate WLAN components. A member of the team created a network design diagram to help guide the subsequent implementation process. The result of that effort is presented in Figure 9-1."
          }
        ]
      }
    ]
  },
  {
    "title": "Distribution Traffic on the Wired Network",
    "subsections": [
      {
        "content": "\nForcing use of EAP-TLS to support WLAN authentication. Before users were allowed to use the WLAN, they were required to complete a 20-minute, Web-based WLAN security awareness course. The course covered important aspects of the WLAN use policy, including not letting people other than employees and full-time on-site contractors use the WLAN, and not accessing the StateConnect database over the WLAN. The course also provided several tips and tricks regarding how to protect one's computer when using non-agency WLANs, such as those found at home, hotels, and coffee shops. For example, users were instructed to verify that their personal firewall software was running and their antivirus and anti-spyware software was up-to-date whenever they used their computers outside of the office. Without this type of protection, data stored locally on an agency laptop could be compromised if the laptop were used on an external network. Also, users could inadvertently download viruses, spyware, and other malware that otherwise would have been blocked by the agency's network-based security controls.\n"
      },
      {
        "title": "9.1.4",
        "content": []
      },
      {
        "title": "9.1.5",
        "content": [
          {
            "subsection": "Phase 4: Operations/Maintenance",
            "text": []
          },
          {
            "text": "Security was also integrated into regular operations behind the scenes. Personnel in the agency's Network Operations Center were trained on how to respond to security alerts issued by the log analysis tool on the audit server that received data from each of the APs. Also, on a random day of each month, a technician would walk through the entire building using a laptop-based detection tool to identify unauthorized wireless services (APs and clients), rogue devices, and interfering devices intruding on the IEEE 802.11 channels. The agency was considering the procurement of a wireless intrusion detection system that can identify such devices automatically, but the budget did not allow for such a system in the initial deployment."
          },
          {
            "subsection": "Summary and Evaluation",
            "text": []
          },
          {
            "text": "Six months after the deployment of the WLAN, the project team received a special service award from the director of the agency. When announcing the award, the director noted the project management approach to integrating WLANs into the agency's existing IT services. Stakeholders were involved early in the process, and the solution was driven by clearly defined policy and functional requirements. The procurement process led to the selection of appropriate equipment that met all security requirements. Both users and support staff received relevant training related to the new system. The introduction of the IEEE 802.11 RSN at agency XYZ was a huge success."
          }
        ]
      },
      {
        "title": "9.2 Case Study 2: Transitioning an Existing WLAN Infrastructure to RSN Technology",
        "content": [
          {
            "text": "A few days after the new CIO arrived at the Bureau of Advanced Research (BAR), she was confronted with a serious security breach: an intruder had compromised a key database containing confidential business information, and then posted sensitive records on a Web server in a country that did not...\n```# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "cooperate with U.S. law enforcement. The preliminary investigation traced the attack back to an unsecured AP that the Special Projects Division had installed for the use of its staff. The AP was placed next to a window and was clearly visible from the public parking lot below. Apparently, an unauthorized party had exploited WLAN vulnerabilities and gained access to confidential data. In this situation, little hope existed of finding the perpetrator."
          },
          {
            "text": "The CIO knew that the bureau's WLAN infrastructure needed a security upgrade immediately to prevent further breaches of bureau information systems. She read about IEEE 802.11 RSNs in the trade press and believed that this could be the solution to the bureau's problem. One of her biggest challenges would be overcoming the fiercely skeptical nature of the bureau's senior scientists, over whom she had little authority. Many of them worried that a centralized security solution would compromise their independence and unnecessarily restrict their scientific pursuits. The CIO had to make the transition as smooth as possible to avoid criticism that could undermine her future success."
          },
          {
            "text": "The team agreed that the need for immediate security coupled with the diversity of equipment and configurations meant that an upgrade could not happen in one step; there would need to be an interim solution before they could upgrade to the end state."
          }
        ]
      }
    ]
  },
  {
    "title": "CURRENT PAGE RAW OCR TEXT",
    "subsections": [
      {
        "content": "Although pre-shared key authentication would be permitted for an interim period of 120 days. Those requiring WLAN support not based on RSNAs would be required to operate in a perimeter network separated from the main network by a firewall. The WLAN would be limited to users who possessed valid badges to the facility, including visiting scholars, interns, and contractors. Finally, the WLAN could be used for any business activity also permitted on the wired network."
      },
      {
        "title": "9.2.2 The Interim Solution: Acquisition/Development and Implementation",
        "content": [
          {
            "text": "To plan the transition, the team decided to develop the interim strategy for each BSS or ESS in the current infrastructure. Factors they considered included the functional capability of the current equipment, the extent to which impacted users were familiar with WLAN key management, and the willingness of the impacted users to accept change. They also consulted several NIST publications to guide them in their planning effort, including NIST SP 800-53, Recommended Security Controls for Federal Information Systems. The result of their strategy session was a matrix similar to Table 9-2."
          },
          {
            "text": "In conjunction with the changes, the upgraded BSSs were consolidated into a new ESS with the SSID INTERIM, which used TKIP with PSKs. Since the WLAN1 ESS could not be upgraded immediately, it was migrated outside of the internal network. The BAR and LAB WLANs remained \"as is\" because they both already met interim security requirements."
          },
          {
            "text": "The interim solution allowed the project team to quickly implement reasonable security measures without interrupting service or purchasing new equipment or software, while moving towards the long-term high assurance solution. Once they implemented the interim changes, the WLAN infrastructure appeared as depicted in Figure 9-3. The specifications of each AP in the interim infrastructure are listed in Table 9-3."
          }
        ]
      }
    ]
  },
  {
    "title": "CURRENT_PAGE_RAW_OCR_TEXT",
    "subsections": [
      {
        "content": "Users were told that they would have to find alternative methods of connecting to the WLAN (e.g., using a PDA). Several of the original APs did not support CCMP and could not be used in the final solution. This equipment was outdated and no longer of value to the organization. Before donating the equipment to a local elementary school, a technician cleared all keys and network addresses from the devices to avoid revealing any information about the bureau's network to external parties."
      },
      {
        "content": "Figure 9-4 shows how the WLAN infrastructure appeared at the completion of the project. Table 9-4 lists additional configuration information for the APs in the end-state solution. At this point, all of the APs are WPA2-Enterprise certified and are configured to use CCMP and IEEE 802.1X port-based access control."
      },
      {
        "title": "9.2.4 Summary and Evaluation",
        "content": [
          {
            "text": "The transition was a great success, in large part because the project team did not try to reach an ideal state in one step. Instead, it developed both interim and long-term solutions. The interim solution was designed to respond quickly to an active threat. Someone had recently seriously compromised network security and could easily have done so again unless immediate measures were taken to provide a defense against a subsequent attack. In this environment, the bureau did not have the time to procure equipment or develop a new authentication infrastructure."
          },
          {
            "text": "Fortunately, the organization was able to build an interim IEEE 802.11 RSN with existing equipment. In general, the deployment of PSKs significantly increases the administrative complexity of WLAN operations, primarily because of the need to periodically rotate keys, which is often a manual process. However, the use of PSKs in the interim solution enabled the bureau to protect its WLAN communications quickly, giving it the time to design and implement a long-term solution based on a centralized AS and IEEE 802.1X port-based access control."
          },
          {
            "text": "In the long-term solution, the bureau decided to leverage its existing RADIUS-based AAA server and integrate it with its LDAP-enabled e-mail directory. It also incorporated its existing smart card authentication system for its IT staff, who desired additional security for access to the bureau's management network. This configuration meant the use of EAP-TTLS with MD5-Challenge password-based authentication for the ESS was available to all users, and EAP-TLS authentication was available for the IT support staff with additional authentication requirements."
          }
        ]
      },
      {
        "title": "9.3 Case Study 3: Supporting Users Who Are Not Employees",
        "content": [
          {
            "text": "The General Regulatory Commission (GRC) was proud of the openness of its proceedings and had successfully used technology to improve its accessibility to the public. Last year, it won an award for its website that allows remote users to search through electronic records in its online docket. Recently, it decided to use technology to improve the experience of visitors to its headquarters in Washington, D.C. At the top of its list of project ideas was the installation of new WLAN technology."
          },
          {
            "text": "GRC's Associate CIO for network engineering and operations had been considering deployment of IEEE 802.11 RSN technology, but was not certain it was best-suited for all of GRC's desired applications. He\n```# Cyber Security and WLAN Project"
          },
          {
            "text": "Realized that cyber security threats were real and growing. While the commission embraced technology tools that help it to perform its public service mission, senior staff also knew they needed to balance public access and security. A significant security breach could undermine years of trust the commission had built with its stakeholders."
          }
        ]
      },
      {
        "title": "9.3.1 Phase 1: Initiation",
        "content": [
          {
            "text": "The Associate CIO tasked his IT services contractor to develop a high-level strategy for the WLAN project, in particular analyzing what types of security controls were appropriate for its various components. A few days later, the contractor presented some preliminary ideas, which are shown in Table 9-5."
          },
          {
            "text": "The first step in the initial assessment was recognizing that there were essentially three main areas that could benefit from WLAN services:"
          },
          {
            "text": "\nThe commission offices, in which employees conducted their day-to-day business\nThe administrative law courts, in which registered attorneys, reporters, and expert witnesses needed limited access to court information systems and the ability to access their own office servers. Opposing attorneys' traffic should be isolated from each other, to avoid even the appearance of eavesdropping.\nThe Public Information Resource Center, in which the GRC wanted to offer access to the Internet, the GRC electronic docket, and the library holdings database to all visitors.\n"
          },
          {
            "text": "The security requirements for each of these areas differed from the others. The simplest case was the commission offices. The requirements there were very similar to those of most other organizations whose WLANs served employees only; meeting areas such as conference rooms and the cafeteria should support mobile users, but do so with RSN protections to protect the confidentiality and integrity of GRC information resources."
          },
          {
            "text": "The administrative law courts had special requirements, necessitating more rapid access to information. Court proceedings often took far longer to complete than one would expect. For example, whenever someone requested information that was not readily available, the lawyers had to request a recess so that a courier could bring relevant data to the court from wherever it might reside. Determining when to restart a hearing was itself a challenge; all the parties involved had to submit forms specifying their availability, which the court's clerk would use to schedule subsequent appearances."
          },
          {
            "text": "Allowing authorized individuals access to IT systems from within the hearing rooms could greatly reduce these delays. Attorneys could quickly search through the court's archives or evidence information repository to respond to queries. They could also use VPN technology to access information from external sources, such as the offices of their law firms. In addition, they could enter their schedules into the court's calendaring system, so that when proceedings were stopped, the clerk could immediately notify all parties when they would resume. This functionality required network support. WLAN technology could provide that support unobtrusively, while also giving users a degree of mobility within.# CURRENT PAGE RAW OCR TEXT"
          }
        ]
      },
      {
        "title": "each room.",
        "content": [
          {
            "text": "One possibility was to permit anyone to use the hearing room WLAN since, for the most part, proceedings were public. This configuration was rejected for two reasons. First, proceedings were closed when cases involved sensitive business information, and much of the court's calendar and its evidence information repository also were confidential. Second, the judges felt that public visitors to the court should not be permitted to use the WLAN for anything other than official court business, which would be difficult to control if they could easily access its network. For these reasons, an RSN solution was deemed appropriate for the hearing rooms and the commission offices."
          },
          {
            "text": "The final area in which a WLAN would be deployed is the GRC's Public Information Resource Center, which was used by the public, ranging from local university students writing term papers to commission staff checking records related to regulatory actions. Librarians in the center noted that many visitors to the center were frustrated by the lack of Internet access. This situation forced them to leave the center to access information from external resources, sometimes necessitating several trips. A WLAN with Internet access could solve this problem while also facilitating access to the center's resources."
          },
          {
            "text": "The IT security manager was concerned that public users would abuse their free network privileges, either using them to attack the network or simply dominate the available bandwidth to such an extent that it would crowd out other legitimate uses of the network. He argued for RSN protections to prevent this abuse. However, closer examination of the problem revealed that an RSN was unlikely to solve the potential problems he raised. If members of the public were permitted to use the WLAN on the desired walk-in basis, they could cause problems regardless if they did so on an open system or one on which they were given logon credentials to an RSN. Furthermore, because all the center information that would be accessed is publicly available, confidentiality was not an issue. In the case of the Public Information Resource Center, an RSN would add administrative complexity with little or no additional security benefit."
          }
        ]
      },
      {
        "title": "9.3.2 Phase 2: Acquisition/Development",
        "content": [
          {
            "text": "Based on the IT service contractor's initial analysis, the Associate CIO awarded a task to design the WLAN solution, which focuses on the development portion of the acquisition/development phase of the information system development life cycle. The initial planning had indicated that RSN technology could be useful in the commission offices and the administrative law courts, but was unnecessary in the Public Information Resources Center. The design would need to provide different levels of access to the commission's employees, who for the most part needed full access, and the external parties participating in court proceedings, who needed only limited access."
          },
          {
            "text": "While the solution could accommodate this differentiation using identity management and authorization software only, the architects felt additional network controls would be required to provide a high level of assurance that the system would not be used improperly. Data traffic in the# GRC WLAN Infrastructure"
          },
          {
            "text": "Hearing rooms would be segregated from the main office network using a separate ESS with the SSIDs GRC-COURT and GRC-OFFICE. GRC-COURT would support non-employees with GRC business, such as the attorneys participating in GRC hearings. GRC-OFFICE would support employees and have access to both the office network and the hearing room information resources. The APs in the commission offices would support GRC-OFFICE only. The APs in the hearing rooms would support both GRC-COURT and GRC-OFFICE. Both GRC-COURT and GRC-OFFICE would use the same backend cluster of AAA servers for authentication. The system would be designed to work with any WPA2-certified client, but the hearing room would also have a spare open Ethernet connection for the occasional visitor that still encountered interoperability issues."
          },
          {
            "text": "The commission already had an enterprise PKI. The badges that both employees and non-employees carried to enter the building could hold PKI certificates that could be used for authentication. Certificate readers were already provided to all employees and could be provided to hearing room visitors on an as-needed basis. With a robust PKI already in place, EAP-TLS authentication was a good choice. Using the PKI to support the WLAN required some changes to the commission's certificate policy and certification practice statement, but these were relatively minor (primarily involving adding WLAN components to the list of acceptable users of the PKI) and were implemented quickly."
          },
          {
            "text": "The ESS supporting the Public Information Resource Center would have the SSID GRC-PUBLIC. Its APs would be on a VLAN outside of GRC's firewall, which would block all inbound access except requests to its electronic docket and library holdings database. The design also called for limiting the network throughput on each WLAN connection to 256 kilobits per second, which would allow individuals to perform external research but prevent them from dominating the Internet connection so that others would not be able to use it. This requirement was met using a proprietary quality of service feature available on the enterprise APs that the bureau procured for this project. The ability to support this limitation was added to the AP procurement requirements list to ensure that it could be implemented in the final solution."
          },
          {
            "text": "Figure 9-5 illustrates the design for the GRC WLAN infrastructure."
          }
        ]
      },
      {
        "title": "9.3.3 Summary and Evaluation",
        "content": [
          {
            "text": "The case study reviewed GRC's experience with the initiation and acquisition/development phases of the information systems development life cycle with respect to its WLAN deployment. The commission's objective was to use WLAN technology to improve public access to its information. Its project got off to a strong start largely because it correctly identified when RSNs would facilitate progress towards that objective and when they might not."
          },
          {
            "text": "The initial GRC analysis led to a high-level design that tailored the RSN strategy for each area in the building based on the level of protection needed given the user community it served. In summary, GRC's main building had three areas that would be supported by WLANs: the commission offices, the administrative law courtrooms, and the Public Information Resource Center. The solution in the commission offices was similar to WLAN deployments in many.# CURRENT_PAGE_RAW_OCR_TEXT"
          },
          {
            "text": "organizations, providing users with mobility they did not previously enjoy. The solution for the courtrooms, however, was innovative and greatly expedited the legal administrative processes with which many were frustrated. IEEE 802.11 RSN technology enabled this significant increase in productivity because the judges would not have permitted courtroom network connections without the assurance the RSN provided. The WLAN solution in the Public Information Resource Center also was an enabling technology, allowing visitors to complete research projects more efficiently than ever before. However, the solution was an open system, providing no link layer security. This configuration at first seemed precarious, but given that the Center's data was public and its WLAN was isolated from other network resources with firewall technology, RSN protections were deemed unnecessary."
          }
        ]
      },
      {
        "title": "10. Summary of Concepts and Recommendations",
        "content": [
          {
            "text": "This section summarizes the major concepts and recommendations presented in Sections 2 through 8 of this document. It provides a summary of the major IEEE 802.11 network components and terms, an overview of IEEE 802.11i security, and an introduction to the product certification programs from the Wi-Fi Alliance. It also discusses the operation of a Robust Security Network (RSN) and outlines a recommended life cycle for IEEE 802.11 RSN deployment. Finally, it provides additional recommendations for wireless local area network (WLAN) security."
          },
          {
            "subsection": "10.1 IEEE 802.11 Concepts",
            "text": []
          },
          {
            "text": "WLANs usually are implemented as extensions to existing wired LANs, and are used by devices within a fairly limited range, such as an office building. The need for interoperability among different brands of WLAN products led to the development of various WLAN standards. IEEE 802.11 is the dominant WLAN standard. The basic IEEE 802.11 network components and architectural models are as follows:"
          },
          {
            "text": "\nStation (STA). A STA is a wireless endpoint device, such as a laptop, PDA, or mobile phone.\nAccess Point (AP). An AP logically connects STAs with a distribution system, which is typically an organization's wired network infrastructure. APs can also logically connect wireless STAs with each other without accessing a distribution system.\nAd Hoc Mode. This is a wireless network configuration that does not use APs; STAs communicate directly with each other.\nIndependent Basic Service Set (IBSS). An IBSS is a set of STAs configured in ad hoc mode.\nInfrastructure Mode. This wireless network configuration requires APs and is the most commonly used mode for WLANs. An AP connects wireless STAs to each other or to a distribution system.\nBasic Service Set (BSS). A BSS is composed of an AP and one or more STAs configured in infrastructure mode. A BSS is the basic building block of a WLAN.\nDistribution System (DS). A DS is an infrastructure, typically a wired LAN, that connects individual BSSs to each other.\nExtended Service Set (ESS). An ESS is a WLAN comprising more than one BSS connected by a DS.# 10.2 IEEE 802.11i Security Overview\n"
          },
          {
            "text": "Also known as pre-RSN IEEE 802.11, IEEE 802.11 technologies that rely on Wired Equivalent Privacy (WEP) have several well-documented security problems that can be exploited to circumvent or adversely impact access control and authentication, confidentiality, integrity, and availability. To address these, IEEE amended IEEE 802.11 with 802.11i, which was approved in July 2004."
          },
          {
            "text": "The IEEE 802.11i specification introduces the concept of a Robust Security Network (RSN), which is a wireless network that allows the creation of RSN associations (RSNA) only. RSNAs are logical connections between communicating IEEE 802.11 entities established through the IEEE 802.11i 4-Way Handshake. RSNAs allow for the protection of data frames and provide enhanced security relative to the flawed WEP. RSNAs provide the following security features for IEEE 802.11 WLANs:"
          },
          {
            "text": "\nEnhanced User and Message Authentication Mechanisms. The Extensible Authentication Protocol (EAP) provides the authentication framework for IEEE 802.11 RSNs that use IEEE 802.1X port-based access control. To accomplish mutual authentication between an AP and a STA, the IEEE 802.1X standard defines an additional entity, an authentication server (AS). IEEE 802.1X allows the client to authenticate to the network through the use of the AS. If the authentication succeeds, the AP receives the resulting Pairwise Master Key (PMK).\n"
          },
          {
            "text": "EAP defines the stages of an EAP conversation that includes one or more EAP methods. The EAP methods perform the authentication transaction and generate cryptographic keying material. While the basic rules of the EAP conversation are common to all EAP implementations, the EAP methods can vary from one implementation to another, and EAP can be adapted to new authentication methods as they become available. This flexibility has benefits, but it may also introduce risk. Therefore, organizations should select EAP methods based on a risk assessment of the target environment. Only some EAP methods, such as certain Transport Layer Security-based methods (e.g., EAP-TLS, EAP-Tunneled TLS [EAP-TTLS], Protected EAP [PEAP]), can satisfy the security requirements for WLANs."
          },
          {
            "text": "Before organizations select WLAN equipment, they should review their existing identity management infrastructure, authentication requirements, and security policy to determine the EAP method or methods that are most appropriate in their environment, then purchase systems that support the chosen EAP methods. Many EAP methods are currently defined only in IETF Internet-drafts and thus are not yet official standards. Organizations are encouraged to obtain the latest available information before making final determinations on their IEEE 802.11 RSN authentication architecture and product procurement."
          },
          {
            "text": "\nCryptographic Key Management. RSNAs use several cryptographic keys to support key generation, encryption, authentication, and integrity functions. The IEEE 802.11i specification defines two key hierarchies for RSNAs: the Pairwise Key Hierarchy, which is designed for...# Unicast Data Traffic Protection\n"
          },
          {
            "text": "and the Group Key Hierarchy, which is intended for multicast/broadcast traffic protection. In the Pairwise Key Hierarchy, keys may be installed in RSNA devices (ASs and STAs) through two methods:"
          }
        ]
      },
      {
        "title": "Methods of Key Installation",
        "content": [
          {
            "text": "\n\nDelivering a pre-shared key (PSK) through an out-of-band mechanism. The IEEE 802.11 standard does not specify how PSKs are to be generated or distributed, so these decisions are left to organizations implementing IEEE 802.11 networks. As a result, organizations should review any PSK approach carefully for possible vulnerabilities and evaluate its performance implications. Distributing PSKs in a large network might be infeasible. The lack of individual user/client authentication in most PSK APs is another reason to avoid the use of pre-shared keys.\n\n\nDelivering an authentication, authorization, and accounting (AAA) key through EAP during authentication. Decisions on the appropriate EAP authentication methods are left to organizations implementing STAs and ASs. As a result, organizations should carefully review any EAP authentication methods for possible vulnerabilities.\n\n"
          },
          {
            "text": "Delivering a pre-shared key (PSK) through an out-of-band mechanism. The IEEE 802.11 standard does not specify how PSKs are to be generated or distributed, so these decisions are left to organizations implementing IEEE 802.11 networks. As a result, organizations should review any PSK approach carefully for possible vulnerabilities and evaluate its performance implications. Distributing PSKs in a large network might be infeasible. The lack of individual user/client authentication in most PSK APs is another reason to avoid the use of pre-shared keys."
          },
          {
            "text": "Delivering an authentication, authorization, and accounting (AAA) key through EAP during authentication. Decisions on the appropriate EAP authentication methods are left to organizations implementing STAs and ASs. As a result, organizations should carefully review any EAP authentication methods for possible vulnerabilities."
          },
          {
            "text": "Most organizations choose to implement EAP for authentication instead of using PSKs because of the resources needed for proper PSK administration. EAP authentication requires an organization to use an AS, which may necessitate the use of a public key infrastructure (PKI). Organizations that already have ASs for Web, e-mail, file and print services, and other authentication needs, should consider integrating this technology into their RSN solutions. Most leading network operating systems and directory solutions offer the support needed for RSN integration."
          }
        ]
      },
      {
        "title": "Robust Enciphering and Data Integrity Mechanisms",
        "content": [
          {
            "text": "IEEE 802.11 defines WEP as a data confidentiality and integrity protocol. The IEEE 802.11i amendment defines two additional protocols for RSNAs: Temporal Key Integrity Protocol (TKIP) and Counter Mode with Cipher Block Chaining Message Authentication Code Protocol (CCMP). Federal agencies are required to use Federal Information Processing Standards (FIPS)-approved cryptographic algorithms that are contained in FIPS-validated cryptographic modules. Of WEP, TKIP, and CCMP, only CCMP uses a core cryptographic algorithm that is FIPS-approved, the Advanced Encryption Standard (AES). For other security features, CCMP offers the same or stronger implementations than WEP and TKIP. Accordingly, NIST requires the use of CCMP for securing Federal agencies' IEEE 802.11-based WLANs. For legacy IEEE 802.11 equipment that does not provide CCMP, auxiliary security protection is required; one possibility is the use of an IPsec VPN, using FIPS-approved cryptographic algorithms."
          },
          {
            "text": "IEEE 802.11i also uses a function known as IEEE 802.1X port-based access control. The IEEE 802.1X framework specified by the IEEE 802.11i amendment provides the means to block user access to the DS.# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "until authentication is successful, thereby controlling access to network resources.",
        "content": [
          {
            "text": "The technique used to block access is known as port-based access control; it involves the AP distinguishing between EAP and non-EAP frames, then passing EAP frames through an uncontrolled port and non-EAP frames through a controlled port, which can block access."
          }
        ]
      },
      {
        "title": "10.3 Wi-Fi Alliance Product Certification Programs",
        "content": [
          {
            "text": "The Wi-Fi Alliance has established several certification programs to give consumers of WLAN products assurance that their systems comply with IEEE 802.11 specifications and can interoperate with similar equipment from other vendors. The following certifications are available that indicate product compliance with IEEE 802.11i:"
          },
          {
            "text": "\nWi-Fi Protected Access (WPA), which includes a subset of the IEEE 802.11i specification that addresses the weaknesses of WEP\nWPA2, which extends WPA to include the full set of IEEE 802.11i requirements. Federal agencies should procure WPA2 products that have been FIPS-validated; WPA products cannot be FIPS-validated because they do not support FIPS-approved encryption algorithms. WPA and WPA2 have both Personal and Enterprise modes of operation. Organizations that plan to deploy authentication servers as part of an IEEE 802.1X and EAP implementation should procure products with the Enterprise level certification.\n"
          }
        ]
      },
      {
        "title": "10.4 IEEE 802.11 RSN Operation",
        "content": [
          {
            "text": "IEEE 802.11 RSN operation is based on a frame exchange protocol used to transfer frames between WLAN components\u2014STAs, APs, and ASs. The protocol uses three types of IEEE 802.11 frames, as follows:"
          },
          {
            "text": "\nData frames, which encapsulate upper layer protocol packets, including user data (e.g., e-mail, Web pages).\nManagement frames, which include the management of association and deassociation activities, authentication, probes, and beacons.\nControl frames, which are used for requesting and controlling access to the wireless media, such as sending an acknowledgement after receiving a data frame.\n"
          },
          {
            "text": "By grouping the frame exchanges within the frame exchange protocol by function, IEEE 802.11 RSN operation may be thought of as occurring in five distinct phases:"
          },
          {
            "text": "\n\nRSN Operation Phase 1: Discovery. The STA identifies an AP for a WLAN with which it wishes to communicate. The STA locates an AP either by receiving one of the AP's periodic transmissions of Beacon frames, or by sending a Probe Request to solicit a Probe Response from an AP. After the STA has identified an AP, the STA and the AP exchange frames to negotiate various parameters for their communications. By the end of the phase, the STA and AP have agreed on an authentication method.\n\n\nRSN Operation Phase 2: Authentication. During this phase, the STA and AS prove their identities to each other. The authentication frames pass through the AP, which also blocks non-authentication traffic from the STA using IEEE 802.1X port-based access control. The actual authentication mechanism is implemented by the STA and AS using EAP. EAP provides a# CURRENT_PAGE_RAW_OCR_TEXT\n\n"
          },
          {
            "text": "RSN Operation Phase 1: Discovery. The STA identifies an AP for a WLAN with which it wishes to communicate. The STA locates an AP either by receiving one of the AP's periodic transmissions of Beacon frames, or by sending a Probe Request to solicit a Probe Response from an AP. After the STA has identified an AP, the STA and the AP exchange frames to negotiate various parameters for their communications. By the end of the phase, the STA and AP have agreed on an authentication method."
          },
          {
            "text": "RSN Operation Phase 2: Authentication. During this phase, the STA and AS prove their identities to each other. The authentication frames pass through the AP, which also blocks non-authentication traffic from the STA using IEEE 802.1X port-based access control. The actual authentication mechanism is implemented by the STA and AS using EAP. EAP provides a# CURRENT_PAGE_RAW_OCR_TEXT"
          }
        ]
      },
      {
        "title": "Framework for Authentication",
        "content": [
          {
            "text": "Framework that allows the use of multiple methods for achieving authentication, including static passwords, dynamic passwords, and public key cryptography certificates. After authentication has been completed, the AAA key is installed in the STA and AS. It serves as a root key to enable the generation of other keys used to secure communications between the STA and AP."
          },
          {
            "subsection": "RSN Operation Phase 3: Key Generation and Distribution (KGD)",
            "text": []
          },
          {
            "text": "During the KGD phase, the AP and the STA perform several operations that cause cryptographic keys to be generated and placed on the AP and the STA. The KGD phase employs two handshakes: a 4-Way Handshake and a Group Key Handshake. During the 4-Way Handshake, the STA and AP establish a security policy that specifies several key security capabilities, such as data confidentiality and integrity protocols for protecting data traffic, and a key distribution approach. Both handshakes employ message encryption and integrity checking, using one of two confidentiality and integrity algorithms. For both types of handshakes, NIST requires the use of AES Key Wrap with HMAC-SHA-1-128 instead of RC4 encryption with HMAC-MD5 because AES and SHA-1 are FIPS-approved algorithms, and RC4 and MD5 are not. Selecting CCMP as the cipher suite will ensure the use of the appropriate key wrap algorithms."
          },
          {
            "subsection": "RSN Operation Phase 4: Protected Data Transfer",
            "text": []
          },
          {
            "text": "The STA and AP share data securely, using the security policy and cryptographic keys established during the first three phases. Because secure data transfer occurs between the STA and the AP only, organizations need to consider carefully the security of the data during the rest of its transit (e.g., on the DS)."
          },
          {
            "subsection": "RSN Operation Phase 5: Connection Termination",
            "text": []
          },
          {
            "text": "During this phase, the STA and AP tear down their secure connection and delete their association, thereby terminating their wireless connection. The outcome of the discovery phase is very important to the security posture of a WLAN. In an RSN, an AP should not associate with pre-RSN STAs. If any STAs in a WLAN are using pre-RSN capabilities (e.g., WEP or IEEE 802.11 entity authentication), then those STAs have associations that are not RSNAs. Accordingly, the WLAN is not an RSN, even though many of its STAs might not be using pre-RSN capabilities. Organizations that want to establish IEEE 802.11 RSNs should configure their APs so that they permit the establishment of RSNAs only, not associations based on pre-RSN capabilities. Alternatively, non-RSN STAs should be limited to a separate VLAN where additional controls (e.g. firewalls and FIPS 140-2 validated VPNs) can be applied."
          }
        ]
      },
      {
        "title": "10.5 Life Cycle for IEEE 802.11 RSN Deployment",
        "content": [
          {
            "text": "To be effective, WLAN security should be incorporated throughout the life cycle of WLAN solutions, from policy to operations. The model described in this section is based on one introduced in NIST SP 800-64, Security Considerations in the Information System Development Life Cycle. Organizations may follow a project management methodology or life cycle model that does not directly map to the phases in.# WLAN Deployment Phases"
          },
          {
            "text": "The model presented in this guide, but the types of tasks in the methodology and their sequencing are probably similar. The phases of the life cycle are the following:"
          }
        ]
      },
      {
        "title": "Deployment Phase 1: Initiation",
        "content": [
          {
            "text": "This phase includes the tasks to be performed before starting the design of a WLAN solution. These include providing an overall vision for how the WLAN would support the mission of the organization, creating a high-level strategy for the WLAN's implementation, developing a WLAN use policy, and specifying business and functional requirements for the solution."
          }
        ]
      },
      {
        "title": "Deployment Phase 2: Acquisition/Development",
        "content": [
          {
            "text": "For the purposes of this guide, the Acquisition/Development phase is split into the following two parts:"
          },
          {
            "subsection": "Phase 2a: Planning and Design",
            "text": []
          },
          {
            "text": "In this phase, WLAN network architects specify the technical characteristics of the WLAN solution and related network components. These characteristics include the EAP method or methods used to support authentication; the protocols used to support communication between client, AP, and AS; access control lists and firewall rules to segregate WLAN traffic; and the nature of the supporting PKI. A site survey is typically conducted to help determine the architecture of the solution."
          },
          {
            "subsection": "Phase 2b: Procurement",
            "text": []
          },
          {
            "text": "This phase involves specifying the number and type of WLAN components that must be purchased, the feature sets they must support, and any certifications they must hold. It may also include procuring client upgrades to support the security policies to be enforced in the WLAN deployment."
          }
        ]
      },
      {
        "title": "Deployment Phase 3: Implementation",
        "content": [
          {
            "text": "In this phase, procured equipment is first configured to meet operational and security requirements, and then it is installed and activated on a production network. Implementation includes altering the configuration of other security controls and technologies, such as security event logging, network management, AAA server integration, and PKI."
          }
        ]
      },
      {
        "title": "Deployment Phase 4: Operations/Maintenance",
        "content": [
          {
            "text": "This phase includes security-related tasks that should be performed on an ongoing basis once the WLAN is operational, including log review and rogue AP detection."
          }
        ]
      }
    ]
  },
  {
    "title": "10.6 Additional WLAN Security Recommendations",
    "subsections": [
      {
        "content": "In addition to the recommendations presented throughout Sections 3 through 7 of this document, Section 8 provides over 50 best practice recommendations for WLAN security, grouped by the life cycle phase for which each recommendation is most relevant. Organizations are strongly encouraged to adopt the \"best practice\" recommendations. Failure to implement them significantly increases the risk of a WLAN security breach. Organizations should also examine each of the \"should consider\" recommendations to...# CURRENT_PAGE_RAW_OCR_TEXT"
      },
      {
        "content": "Determine their applicability to the target environment. In general, \"should consider\" recommendations enhance security beyond what can be achieved through the \"best practice\" recommendations. A \"should consider\" recommendation should be rejected only if it is infeasible or if the reduction in risk from its implementation does not justify its cost."
      },
      {
        "content": "WLANs face several types of high-level threats, including denial of service attacks, eavesdropping, man-in-the-middle attacks, masquerading, message modification, message replay, and traffic analysis. WLAN threats most commonly involve an attacker with access to the radio link between two STAs or between a STA and an AP. Implementing the recommendations presented in this guide for a new or existing WLAN should help to provide reasonable assurance that an organization is protected against most WLAN security threats. In addition, organizations should use guidance on general security controls, such as the recommendations presented in NIST SP 800-53 for minimum management, operational, and technical security controls for information systems."
      }
    ]
  }
]