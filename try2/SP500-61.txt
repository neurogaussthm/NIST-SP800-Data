MAINTENANCE TESTING FOR THE DATA ENCRYPTION STANDARD M iiiii NBS Special Publication 500-61 i DEPARTMENT OF COMMERCE 3 U.S. National Bureau of Standards 7 .500-61 0 9NATIONAL BUREAU OF STANDARDS The National Bureau ofStandards' was established by an act of Congress on March 3, 1901. The Bureau's overall goal is to strengthen and advance the Nation's science and technology and facilitate their effective application for public benefit. To this end, the Bureau conducts research and provides: (I) a basis for theNation's physical measurement system, (2) scientific and technological services for industry and government, (3) a technical basis for equity in trade, and (4) technical services to promote public safety. The Bureau's technical work isper- formed by the National Measurement Laboratory, the National Engineering Laboratory, and the Institute for Computer Sciences and Technology. THE NATIONAL MEASUREMENT LABORATORY provides the national system of physical and chemical and materials measurement; coordinates the system with measurement systems of other nations and furnishes essential services leading to accurate and uniform physical and chemical measurement throughout the Nation's scientific community, industry, and commerce; conducts materials research leading to improved methods of measurement, standards, and data on thepropertiesofmaterials needed byindustry,commerce,educational institutions, and Government; provides advisory and research services to other Government agencies; develops, produces, and distributes Standard Reference Materials; and provides calibration services. The Laboratory consists of the following centers: — — Absolute Physical Quantities^ Radiation Research Thermodynamics and — — Molecular Science Analytical Chemistry Materials Science. THE NATIONAL ENGINEERING LABORATORY provides technology and technical ser- vices to the public and private sectors to address national needs and to solve national problems; conducts research in engineering and applied science in support of these efforts; builds and maintains competence in the necessary disciplines required to carry out this research and technical service; develops engineering data and measurement capabilities; provides engineering measurement traceability services; develops test methods and proposes engineering standards and code changes; develops and proposes new engineering practices; and develops and improves mechanisms to transfer resultsofits research to the ultimate user. The Laboratory consists of the following centers: — — Applied Mathematics Electronics an —d Electrical Engineering —^ Mechanical — Engineering and Process Technology^ Building Technology Fire Research — Consumer Product Technology Field Methods. THE INSTITUTE FOR COMPUTER SCIENCES AND TECHNOLOGY conducts research and provides scientific and technical services to aid Federal agencies in theselection, acquisition, application, and use of computer technology to improve effectiveness and economy in Government operations in accordance with Public Law 89-306 (40 U.S.C. 759), relevant Executive Orders, and other directives; carries out this mission by managing the ADP Federal Information Processing Standards Program, developing Federal standards guidelines, and managing Federal participation in ADP voluntary standardization activities; provides scientific and technological advisory servicesand assistanceto Federal agencies; and provides the technical foundation for computer-related policies ofthe Federal Government. The Institute consists of the following centers: — Programming Science and Technology Computer Systems Engineering. 'Headquartersand LaboratoriesatGaithersburg, MD, unlessotherwisenoted; mailing address Washington, DC 20234. ^Some divisions within the center are located at Boulder, CO 80303.National Bureau of Standards Library, f-01 Admin. BIda. AUG 1 2 1980 COMPUTER SCIENCE & TECHNOLOGY: QCioo Maintenance Testing for the Data Encryption Standard no. 6 c / Jason Gait Center for Programming Science and Technology Institute for Computer Sciences and Technology •National Bureau of Standards DC Washington, 20234 ^^^^^ Co. U.S. DEPARTMENT OF COMMERCE, Philip M. Klutznick Secretary Luther H. Hodges, Jr., Deputy Secretary Jordan J. Baruch, Assistant Secretary for Productivity, Technology and Innovation NATIONAL BUREAU OF STANDARDS, Ernest Ambler. Director Issued August 1980Reports on Computer Science and Technology The National Bureau ofStandards has a special responsibility within the Federal Government for computer science and technology activities. The programs of the NBS Institute for Computer Sciences and Technology are designed to provide ADP standards, guidelines, and technical advisory services to improve theeffectiveness of computer utilization in the Federal sector, and to perform appropriate research and development efforts as foundation for such activities and programs. Thispublication series will report these NBS efforts to the Federal computer community as well as to interested specialists in the academic and private sectors. Those wishing to receive notices ofpublications in this series should complete and return the form at the end of this publicaton. National Bureau of Standards Special Publication 500-61 Nat. Bur.Stand.(U.S.),Spec. Publ.500-61,28pages(Aug. 1980) CODEN: XNBSAV Library ofCongress Catalog Card Number: 80-600105 U.S. GOVERNMENT PRINTING OFFICE WASHINGTON: 1980 For sale by the Superintendent of Documents, U.S. GovernmentPrintingOffice,Washington, D.C. 20402 Price $2.00 (Add 25 percent forotherthan U.S. mailing)TABLE OF CONTENTS Page 1. INTRODUCTION , 1 1.1 Validation vs Maintenance Testing 2 1.2 The Maintenance Tests 3 1.3 The Values for the Parameters of the Test 6 2. DESCRIPTION OF THE DES ALGORITHM 6 2.1 The Permutations and E Operator 7 2.2 The S-boxes 7 2.3 The Key Schedule 8 2.4 Maintaining the Correctness of DES Devices .... 8 2.4.1 DES Tests 8 2.4.2 Relationship to Validation Tests 9 3. TESTING PHILOSOPHY 9 3.1 Stuck-faults in Cipher Feedback Mode 9 3.2 Generating the Pseudo-random Tests 10 3.3 Description of Tests 11 4. SUMMARY AND CONCLUSIONS 12 5. Appendix A: The DES Algorithm Specification 14 6. Appendix B: The Gram-Schmidt Algorithm 19 7. Appendix C: Pseudo-random Testing of Linear Devices 21 . -i i i-I \Maintenance Testing for the Data Encryption Standard Jason Gait This publication describes the design of four maintenance tests for the Federal Inforination Pro- cessing Data Encryption Standard (DES) The tests . consist of an iterative procedure that tests the operation of DES devices by using a small program and minimum data. The tests are designed to be independent of implementation and to be fast enough to test devices during actual operation. The tests are defined as four specific stopping points in a general testing process and satisfy four testing requirements of increasing degree of completeness depending on the thoroughness of testing desired. Key words: Communications security; computer security; cryptography; data encryption standard; in-service testing; maintenance tests; Monte-Carlo testing; stuck-fault testing; test cases. 1. INTRODUCTION The Federal Information Processing Data Encryption Standard (DES) is the standard cryptographic algorithm for use within the Federal Government for protecting non- classified transmission and storage of computer data. The DES algorithm is normally implemented in hardware and com- mercial DES devices are presently available from eight dif- ferent sources. The National Bureau of Standards has vali- dated the designs of the various hardware implementations with a validation test, i. e., a collection of input-key- output triplets which, when applied as a test to a device, and if successfully executed, insures that the device being tested in fact correctly executes the DES algorithm. A Monte-Carlo test using random data is also a part of this test ,A small maintenance test, residing in read only memory and executed by the same microprocessor that controls the DES device provides a means of testing the operation of the DES hardware in the field. Since one criterion for a field test is that it be economical, the tests are designed so that only a partial test may be needed in a given applica- tion. The test is so designed that a full functional test can be executed if it is convenient and desirable to do so. The maintenance test provides results which are a com- bination of the validation test and of the Monte-Carlo test described in . The maintenance test uses an initial fixed input-key pair and the resulting ciphertext is then fed back as input or as key, as in the Monte-Carlo test, and this cycling process is repeated. By simply checking the output of this process against four known results the test determines if the DES algorithm is properly functioning. A maximum of 192 cycles has been determined to test completely the DES device but three earlier check points are defined which result in specific partial tests. In all, four ca- tegories of tests have been defined. They range from a sim- ple test for stuck-faults of the 54 output bits of the DES to a complete functional test. 1.1 Validation vs Maintenance Testing The maintenance tests described here replicate the functionality of both the validation test and the Monte- Carlo test procedure used to validate implementations of the DES [8,9]. In fact, by taking advantage of the pseudo- random nature of the DES output, we are able to describe a smaller, more efficient test procedure that is equivalent to the test previously described in , although the extensive Monte-Carlo test is not reproduced. -2-1.2 The Maintenance Tests The maintenance tests depend only on the functionality of the algorithm and not on any particular implementation. The tests can be performed with a short program whose two inputs consist of an initial plaintext and an initial key and whose output is a final ciphertext. Tlie test program creates a cycling process that tests the complete func- tionality of the DES algorithm as well as testing for stuck-at-one and stuck-at-zero faults at the various input and output interfaces. Stuck-at-one or stuck-at-zero faults occur due to a circuit failure, e. g., an open circuit. The device is known to be performing correctly if the observed final ciphertext matches the expected result. The cycling process consists of a maximum of 192 enc ipherments and deci- pherments intermixed in such a way as to test all aspects of the algorithm. The execution of the test program requires little tine and hence the test can be used on-line to exam- ine the functionality of a device in-service as well as for other testing purposes. The complete test is determined by the following re- currence relation: 5555555555555555 FFFFFFFFFFFFFFFF where K . , and C^^ denote key, input and output at time n, with the value of determined from the equation = i i 3(n-l)+l for n=l,2,3,..., TESTLENGTH. Here the symbol E denotes the DES encryption operation and D denotes the DES decryption operation. The initial values of key and plain- text, K, and P,, are 64 bit numbers represented in hexade- cimal notation with correct parity for each 8-bit byte of the key. The test can be used in any of four modes depending on the degree of certainty required and the time available to perform the test. In each of the four modes only the final ciphertext differs, initial plaintext and key remain the -3-same. Test 1: Tests all output bits for stuck-at-one and stuck- at-zero faults; the P and E matrices used by the DES algo- rithm are also tested. Test 2: Includes Test 1, tests the S-boxes and includes a test for stuck-faults at all the key and input bits except one input bit. Test 3: Includes Test 2, a complete test for stuck-faults and a test of the IP matrix. Test 4: Tests all aspects of the algorithm. The following table provides a concise display of the various tests, the number of iterations required for each test, the number of encryption or decryption operations per- formed during each test, the final output for each test and the specific properties of the DES algorithm that are tested during each test. -4-Table 1. Properties of the Four Maintenance Tests testl test2 test 3 test4 iterations 64 enc/dec ops 18 24 192 final output BF1FF37B 1DFCF1C8 00B82CBB 246E9DB9 C46CC2CA 44E84A9B E58DBB9F C550381A props tested output stuck test 1 and test 2 and complete faults, P, E S-boxes input stuck test 1 faults -5-1.3 The Values for the Parameters of the Test The efficacy of the testing procedure depends largely on the effectiveness of the DES as a pseudo-random number generator . The number of iterations needed to satisfy each test requirement could not be determined in advance. However an upper-bound value for TESTLENGTH was determined from a Markov chain model of the full testing procedure. The results were that if pseudo-random input vectors are presented to a linear device with n inputs, then the expect- ed number of tests required to test completely the device for sufficiently large n is approximately n+2. Since n is the minimum number required, the distribution has a very small standard deviation. Hence we need to examine at most n+3 or n+4 pseudo-random input vectors to be sure of obtain- ing a maximal linearly independent set (=basis) of appropri- ate dimension. See Appendix C for the details of the calcu- lation. 2. DESCRIPTION OF THE DES ALGORITHM The Federal Information Processing Data Encryption Standard published on January 15, 1977  is a complex non-linesr ciphering algorithm that was designed for effi- cient hardware implementation. Although there are software implementations, they do not comply with the standard and are generally quite inefficient compared to hardware ver- sions , The DES algorithm operates on 64 bits of input to produce 54 bits of output under the action of a 56-bit keying parameter. With the exception of initial and final permutations, the algorithm is a series connection of six- teen rounds. Each round uses 48 bits of the key in a se- quence determined by a key schedule. With the exception of this difference in the round keys, the sixteen rounds are identical to one another. Each round receives an input of 64 bits; the 32-bit right half is expanded by the linear operator E to 48 bits and the result is mod 2 added to the round key; the 48 bit sum is divided into eight 6-bit blocks, each of which determines a 4-bit S-box entry; the resulting 32 bits are added mod 2 to the left half and the two halves are interchanged, thus producing 64 bits of out- put for the round. Sixteen rounds connected in series, each using a different round key as determined by the key schedule, together with initial and final permutations make up the DES algorithm. Despite its complexity the DES is ca- pable of operating at high speed when implemented in hardware. For example, an encryption or decryption of one64-bit block on the NBS DES unit takes 9 nicroseconds Ap- . pendix A contains a complete functional description of the DES algorithm parameters, i. e., permutations, S-boxes and key schedule. 2.1 The Permutations and E Operator The role of the permutation P is to mix thoroughly the data bits. The operator E expands its 32 bit input to a 48 . bit output that is added mod 2 to the round key. The permu- tations in the key-schedule, PCI and PC2, intermix the key bits among the round keys in such a way as to equalize key- bit utilization. No key bit is used more than 15 tines nor less th^n 12 times. The initial and final permutations, IP and IP are byte oriented for efficient hardware implemen- , tation . Each permutation is a linear operator, and so can be thought of as an n x m matrix and can be validated complete- ly if it operates correctly on an appropriate maximal linearly independent set of input vectors, i. e., a suitable basis. 2.2 The S-boxes The non-linear substitution tables, or S-boxes, con- stitute an important part of the algorithm. The purpose of the S-boxes is to ensure that the algorithm is not linear [1,2]. Each of the eight S-boxes contains 64 entries, organ- ized as a 4x16 matrix. Each entry is a four bit binary number, represented as 0-15, so the output of the parallel connection of eight S-boxes is 32 bits. A particular entry in a single S-box is selected by six bits, two of which select a row and four select a column. The entry in the corresponding row and column is the output for that input. Each row in each S-box is a permutation of the numbers 0-15, so no entry is repeated in any one row. -7-. 2.3 The Key Schedule The purpose of the key schedule is to provide a thorough intermixing of the key bits for the algorithm. The key schedule is linear, so its implementation can be veri- fied by presenting 56 basis vectors (= a maximal linearly independent set for this operator) as keys. The encryption process uses left shifts in the key schedule while decryp- tion uses right shifts, so an additional 56 decryptions are required for testing. The key schedule is extremely impor- tant to the security of the algorithm: it has been shown  that similar algorithms without similar key schedules may be substantially weaker even if they have much larger keys. 2.4 Maintaining the Correctness of DES Devices The test program verifies the correct operation of an implementation by performing one of several optional series of tests on the device during operation. The pseudo-random tests have been examined to be sure that a basis of vectors is presented to each of the matrix operators in the algo- rithm, thus verifying their correct implementation as linear operators, and to exercise every element in each S-box. 2.4.1 DES Tests. The tests are designed to assure the correctness of each of the following components of the algo- rithm (see Appendix A): 1. Initial permutation, IP_-, 2. Inverse permutation, IP 3. Expansion matrix, E 4. Data Permutation, P 5. Key Permutation, PCI 6. Key Permutation, PC2 7. Substitution tables: S,, S^,..., S 8. Mod 2 adders In addition the tests protect against the possibility of stuck-faults at the interfaces between any of the above ele- ments as well as at the input, key and output of the DES t- i self -8-2.4.2 Relationship to Validation Tests. The NBS validation test of DES devices consists of operating on a sequence of discrete input-key-output triples. The input and key are en- tered into the DES device, an encryption or decryption operation is performed and the result is compared with the known correct output. Each linear aspect of the DES algo- rithm, e. g., P, E, and so forth, is tested independently by presenting to it a standard unit basis to be operated on. The maintenance test performs an equivalent test by relying on the pseudo-random nature of the DES algorithm to present a basis, but not necessarily the standard unit basis, to each linear element of the algorithm, thereby insuring that they are tested completely. The maintenance test is set up in such a way that various aspects of the algorithm are tested simultaneously and the tester does not receive the information provided by the validation test regarding the location of a failure. However the purpose of these tests is simply to verify that the DES device is working correctly rather than to isolate the location of failures. 3. TESTIIvlG PHILOSOPHY The DES has been implemented by many vendors using many different techniques. To be most useful a test for the DES should be applicable to all DES devices without regard to implementation. The maintenance tests are therefore designed only to test the functionality of the algorithm it- self at the well defined interfaces, such as input, key and output. While the NBS validation test could be used for maintenance, it does not meet the desirable criterion of a maintenance test for minimizing the amount of data stored. It was also desired to minimize the total number of enci- pherments and decipherments during the test to make the test more practical in an on-line environment during intervals between transmissions. 3.1 Stuck-faults in Cipher Feedback Mode One of the modes of operation of the DES is cipher feedback, where the output of the DES is added mod 2 to the plaintext to produce ciphertext. If the output of the DES is subject to stuck-faults, either at one or at zero, then some part of the plaintext, or its complement, is being transmit- ted in the clear. It is therefore desirable that the device be tested for stuck-faults, preferably during all encipher- ment operations, while being used in cipher feedback mode. -9-, 3.2 Generating the Pseudo-random Tests Since the DES is known to be a good pseudo-random number generator , the maintenance test was designed to use the output of the DES fed back as data or as key-text alternatively. Both encryption and decryption operations are used in order to exercise all parts of the algorithm. When all the cycles of each test have been completed, the final output is compared with a single stored value. If the two values are the same, then the device has passed the test, otherwise the device should be rendered inoperable. The follov/ing program is used to do this: key = 5555555555555555 input = FFFFFFFFFFFFFFFF for(n=l; n<TESTLENGTH n=n+l){ ; crypt('e*, key, output, input) input = output crypt('e', key, output, input) key = output crypt('d', key, output, input) key = output } if (output==LASTCIPHER)OK else NG The 64 bit starting values for key and input are represented in hexadecii!ial notation. The value of TESTLENGTH, either 3, 6, 8 or 54, is user supplied and is determined according to the degree of completeness of test- ing desired. The value of L^STCIPHER is as listed in Table 1 for the appropriate number of iterations. The values of TESTLKTslGTH and LA5TCIPHER are set according to which test is desi red The following list specifies the values of TESTLENGTH and LASTCIPHER for each of the four testing modes described. -10-Test 1 Parameters: TESTLENGTH = 3 LASTCIPHER = BF1FF37BC46CC2CA Test 2 Paraneters: TESTLENGTH = 6 LASTCIPHER = 1DFCF1C844E84A9B Test 3 Parameters: TESTLENGTH = 8 LASTCIPHER = 00B82CBBE58DBB9F Test 4 Parameters: TESTLENGTH = 64 LASTCIPHER = 246E9D89C55038lA 3.3 Description of Tests Test 1 uses three cycles of the program, corresponding to nine encryptions or decryptions. Test 1 is useful as a maintenance test for the DES when used in cipher feedback mode to ensure that no stuck-faults in the output will ex- pose plaintext. It is a short test and can be practically executed on-line between transmissions. Note that for this test each bit of the output is both zero and one at least once. Test 2 uses six cycles, corresponding to eighteen enci- pherments or decipherments, which are enough to test com- pletely the S-boxes, the P and E matrices, all outputs for stuck faults and almost all inputs for stuck-faults (plain- text bit 54 is stuck-at-one throughout this part of the test). Two more cycles, actually five more operations, are required to unstick data bit 54, and carry out test 3. Test 3 tests for stuck-faults at the input and output of every algorithm element, i. e., IP, P, E, IP~ PCI, PC2, the S- , boxes, the sliifts in the key-schedule and the inputs and outputs of the mod 2 adders. Test 4 is a complete test of the functionality of the algorithm. The verification of both tests 2 and 4 requires examination of the inputs to each of the linear elements of the algorithm to ensure that a basis, i. e., a maximal linearly independent set of vectors of appropriate dimen- sion, is presented to each, thus ensuring that all matrix entries are fully exercised. The DES validation test -11-presents standard unit basis vectors to these linear ele- ments, while the maintenance test presents random inputs. Thus the inputs have been checked, not for the standard unit basis, for which we would have to wait a long time, but for any basis of the proper dimension. This is equivalent to the standard unit basis in terms of testing linear elements. A variant of the Gram-Schmidt orthogonal ization process was used to do this, as described in Appendix B. The applica- tion of this process shows that the first 32 vectors applied to P are linearly independent, thus testing P completely; this corresponds to just two encipherments since P is used , 16 times during each encryption or decryption operation, or one cycle of the program. Similarly, the first 34 vectors applied to E contain a maximal linearly independent set (the 17th and 33rd vectors are dependent on the others) again ; the first cycle of the program suffices to test E. Hence test set 1 for stuck-faul ts tests P and E as well. The first 66 encipherments, corresponding to 22 cycles of the program, test completely IP the first 87 encipher- ; ments, corresponding to 29 program cycles, test the entire key schedule for both encipherment and decipherment; and 64 complete cycles are required to test IP. It is this re- quirement of testing the initial permutation that fixes the value of TESTLENGTH for test 4 at 64, or 192 encipherments or decipherments. 4. SUMMARY AND CONCLUSIONS A variety of maintenance tests for DES devices in the field have been described, ranging from testing for stuck- faults in the output to a full test of the DES device. The tests are simple and efficient and can be executed from a siaall ROM program on-board with the DES. Recommended testing environments include: 1. manufacturer's assembly-line checkout for DES devices, 2. user acceptance test for newly acquired and recently repaired devices, 3. field-maintenance service testing, and -12-4. in-service testing of DES devices to maintain the in- tegrity of the encryption system. Users of DES devices can choose one of the four tests described, depending on their evaluation of which test is most convenient and meaningful in the given operational en- vironment. However test 4, the complete functionality test, encompasses all the other tests and is hence the best test to use whenever practicable. During each test there is no verification of intermedi- ate values, just a check of the final output for correct- ness. Thus there is a possibility for uncDetected self- , cancelling double errors that these tests are not designed to detect. Many such errors will be detected if they occur in different functional units of the DES, but the user of these tests should be alert to the possibility, however re- mote, that such errors might not be detected. -13-5. Appendix A: The DES Algorithm Specification For the convenience of the reader, this appendix con- tains a complete specification of the parameters involved in the definition of the DES algorithm. The DES acts on a 64 bit block of plaintext, which is first permuted by IP: IP 58 50 42 34 26 18 10 2 60 52 44 36 28 20 12 4 62 54 46 38 30 22 14 6 64 56 48 40 32 24 16 8 57 49 41 33 25 17 9 1 59 51 43 35 27 19 11 3 61 53 45 37 29 21 13 5 63 55 47 39 31 23 15 7 (e. g of the output is bit 58 two is bit 50, etc.) The result is separated into two 32 bit registers, L and R, and then passed through the sixteen rounds. The final 64 bit result is operated on by the inverse of IP, IP~ : 40 8 48 15 56 24 54 32 39 7 47 15 55 23 63 31 38 6 46 14 54 22 62 30 37 5 45 13 53 21 61 29 36 4 44 12 52 20 60 28 35 3 43 11 51 19 59 27 34 2 42 10 50 18 58 26 33 1 41 9 49 17 57 25 The round keys K are determined by the key schedule. There are three parameters to be specified, PCI, PC2 and the shift -14-: schedule PCI 57 49 41 33 25 17 9 1 58 50 42 34 26 18 10 2 59 51 43 35 27 19 11 3 60 52 44 36 63 55 47 39 31 23 15 7 62 54 46 33 30 22 14 6 61 53 45 37 29 21 13 5 28 20 12 4 PC2 14 17 11 24 1 5 3 28 15 6 21 10 23 19 12 4 26 8 16 7 27 20 13 2 41 52 31 37 47 55 30 40 51 45 33 48 44 49 39 56 34 53 46 42 50 36 29 32 and the shift schedule is: -15-Iteration Number of shifts 11 i £. 1 5 £. O C D e. D •J / Q o Z Q 1 ±u o z 1z z iJ z 14 2 15 2 16 1 For a single round the expansion operator E and the permuta- tion P need to be specified: \ E 32 1 2 3 4 5 4 5 6 7 8 9 8 9 10 11 12 13 12 13 14 15 16 17 16 17 18 19 20 21 20 21 22 23 24 25 24 25 26 27 28 29 28 29 30 31 32 1 P 16 7 20 21 29 12 28 17 1 15 23 26 5 18 31 10 2 8 24 14 32 27 3 9 19 13 30 6 22 11 4 25 -16-1 There renain only the S-boxes: 14 4 13 1 2 15 11 8 3 10 5 12 5 o 0 7 0 15 7 4 14 2 13 1 10 6 12 11 9 5 3 8 4 1 14 8 13 6 2 11 15 12 9 7 3 10 5 0 15 12 8 2 4 9 1 7 5 11 3 14 10 0 6 13 ^2 15 1 8 14 6 11 3 4 9 7 2 13 12 0 5 10 3 13 4 7 15 2 8 14 12 0 1 10 6 9 11 5 0 14 7 11 10 4 13 1 5 8 12 6 9 3 2 15 13 8 10 1 3 15 4 2 11 r O 7 12 0 5 14 9 ^3 10 0 9 14 5 3 15 5 1 13 12 7 11 4 2 8 13 7 0 9 3 4 6 10 2 8 5 14 12 11 15 1 13 6 4 9 8 15 3 0 11 1 2 12 5 10 14 7 1 10 13 0 6 9 8 7 4 15 14 3 11 5 2 12 7 13 14 3 0 6 9 10 1 2 8 5 11 12 4 15 13 8 1 5 6 15 0 3 4 7 2 12 1 10 14 9 10 6 9 0 12 11 7 13 15 1 3 14 5 2 8 4 3 15 0 6 10 1 13 8 9 4 5 11 12 7 2 14 2 12 4 1 7 10 11 6 8 5 3 15 13 0 14 9 14 11 2 12 4 7 13 1 5 0 15 10 3 9 8 6 4 2 1 11 10 13 7 8 15 9 12 5 6 3 0 14 11 8 12 7 1 14 2 13 6 15 0 9 10 4 5 3 -17-12 1 10 15 9 2 6 8 0 13 3 4 14 7 5 11 10 15 4 2 7 12 9 5 6 1 13 14 0 11 3 8 9 14 15 5 2 8 12 3 7 0 4 10 1 13 11 6 4 3 2 12 9 5 15 10 11 14 1 7 6 0 8 13 ^7 4 11 2 14 15 0 8 13 3 12 9 7 5 10 6 1 13 0 11 7 4 9 1 10 14 3 5 12 2 15 8 5 1 4 11 13 12 3 7 14 10 15 6 8 0 5 9 2 6 11 13 8 1 4 10 7 9 5 0 15 14 2 3 12 q^8 13 2 8 4 6 15 11 1 10 9 3 14 5 0 12 7 1 15 13 8 10 3 7 4 12 5 6 11 0 14 9 2 7 11 4 1 9 12 14 2 0 6 10 13 15 3 5 B 2 1 14 7 4 10 8 13 15 12 9 0 3 5 6 11 The reader is referred to  for the official specifi cation of these parameters. -18-. 6. Appendix B: The Gram-Schmidt Algorithm Given an arbitrary set k^^, ^3,... of n-d imensional vectors, we will construct a maximal linearly-independent subset of vectors using the Gram-Gchmidt process. The method is to assume that the vectors are linearly independent and to use the Gram-Schmidt process to construct an orthogo- nal set as follows. We will use the notation <xl for a row vector and x> for a column vector, <x|y> for inner product I and |x| for the norm of a vector. Let ^2 = k2 - <u-j^ k2>/ u-^ u^ I I I 2 2 U3 = k^ - <Uj^ k3>/ u-|^ - <U2lk3>/|u2l U2 I I I u^ =. . . etc If at any stage in this process u^ is equal to zero then omit k^ and continue. This process will construct a linearly independent subset of the original set, which may not necessarily be maximal, but if the original set is suf- ficiently large the process will terminate after n vectors have been selected, and the subset is thus maximal. The required theorem is as follows. Theorem, u. = 0 if and only if k. is dependent on the k. for j<i. Proof. Suppose u^ = 0, then k^^ is a linear combination of u. for j<i. Since each u. is a linear combination of k^ for Kj, we have that k^ is a linear combination of k. for 3<i. Conversely, if k^ depends on the k. for j<if then k^^ also depends on the u. for j<i. Hence each <u.|k.> is the coefficient of u. in the expansion of k^ in the vectors u . . Thus the sum of the terms subtracted from k^^ in the Gram- Schmidt process actually equals k. so u. = 0. , -19-In this form the Gram-Schmidt test is used to ensure that sufficiently many pseudo- random vectors have been presented to each linear element of the DES to guarantee complete testing. Appendix C addresses the question of how many random vectors must be examined on the average in order to ensure that we have a maximal linearly independent set. -20-. . 7. Appendix C: Pseudo-random Testing of Linear Devices A Markov-chain model is used to compute the mean and standard deviation of the number of pseudo- random input vec- tors that must be presented to a linear device to ensure that a basis has been presented to the device, thus testing it completely. The first block of input may be either a zero or a non-zero block. In the second case the block will be in the set, while in the first we repeat until we obtain a non-zero block. Once we have a non-zero block, we repeat until we obtain another one, in which case we have two vectors in the set. However we may also obtain the Sr-ime block again, or the zero block. With two vectors in the set a new situation arises, since the next vector may be zero, or a repeat of a vector already in the set or a new vector in the span of those already in the set. In general, a k-d imens ional prob- lem will be represented by a k+1 state Markov chain. This is a finite, ergodic absorbing Markov process, so must ter- minate [7; theorem 3.3.5], hence, in due course, we obtain a basi s Theorem 1. For the Markov chain described above, the transi- tion probability state to state is i i Proof. Let N(i) denote the number of vectors not in the linearly independent set and not zero, but in the span of the set. It suffices to show that N(i) = 2^ - i - 1. It's immediate that N (i) = 1 + 5UM( j=2, i-1) 0 , where denotes the number of combinations of things tak- () i en j at a time, and the argument follows by induction on i. The inductive step uses the additive formula [10; 1. 2.6D (9) ] In the next theorem we compute the mean number of transitions for this Markov chain to be absorbed. Theorem 2. The expected number of transitions to absorption for the above Markov chain is, for k>l, E,^ = + [1/(2'' - 1)] + 1, -21-. where S. = SUM(i=l, k-l)[ 2^ /(2^ - 1)]. Proof. By induction on k. For the case k=2, we have 4/3 2 -1 (I-Q) 0 2, so, assuming a start with a non-zero element, the expected number of transitions to absorption S. is the sum of the last row of the fundamental matrix, or z. The inductive step follows from the definition of the Markov chain. Nov; E. is equal to one for the first state plus the probability or starting without a non-zero element times the mean number of transitions to absorption given a start without a non- zero element plus the probability of starting with a non- zero element tines the mean number of transitions given a start with a non-zero element, or ^k = S,^ + [1/(2' -1)] + 1, where all the states except the first are lumped to g ive two state Markov chain with transition matrix 0. 1-1/2'.^k 1/2' with Q = 1 - 1/2 so the fundamental matrix is 2'^/(2'^-l) , This is precisely the mean number of transitions required to get out of the zero state. We now derive an asymptotic estimate to the above formul a Theorem 4. The average number of vectors that must be exam- ined to obtain a basis is asymptotically log n + c + 0(l/n), where k is the nufuber of non-zero vectors required to define the system, n = 2 and c is a constant. Proof. Rewrite S, as S. = SUM(i=l, k-l){l/[l- (1/2^]}, to see that, apart from the first few terms, each new term just adds one as k increases, so asymptotically, for some constant c, we have S|^=c+k, and we see that the asymptotic value = log n + c + 0(l/n). The value of c is given in [1 1 ; 5. 2. 3 (19 ) ] , the computation being attributed to J. W. Wrench, as approximately 1.606. -22-Hence if the dimension of the system is k, we need to look at k+2 random vectors on the average to obtain a maxi- mal linearly independent set. We now compute the standard deviation, realizing that the difference between the average and the minimum value of the parameter is just 1.606, so the standard deviation must be smaller than this. Reference to [7; theorem 3.3.5] shows that the standard deviation is approx inately 1.414 for all values of k, as expected. Thus the distribution has a very small variance and we expect to examine about k+3 or k+4 vectors to obtain a k-d imensional basis in a set of k- dimensional random vectors, provided the dimension k is suf- ficiently large. -23-REFERENCES 1. Meyer, C, Enciphering Data for Secure Transmission, Com- puter Design, (April, 1974)129-34. 2. Meyer, C. and W. Tuchman, Pseudo-random Codes Can Be Cracked, Elect. Design, vol. 23(1972)74-5. 3. Data Encryption Standard, FIPS PUB 45, Jan. 15, 1977. 4. Grossman, E. and B. Tuckerman, Analysis of a Feistel-like Cipher Weakened by Having No Rotating Key, IBM Rpt c5375, 1977. 5. Gait, J., A New Non-Linear Pseudo- random Number Genera- tor, IEEE Transactions on Software Engineering, Sept., 1977. 5. Bright, H. and R. Ennison, Cryptography Using Modular Software Elements, National Computer Conf., 1975, 113-23. 7. Kemeny, J. and J. Snell, Finite Markov Chains, Van Nos- trand, Princeton, NJ, 1965. 8, Gait, J., Validating the Correctness of Hardware Imple- mentations of the NBS Data Encryption Standard, NBS Special Pub. 500-20, 1977. 9. Gait, J., Encryption Standard: Validating Hardware Tech- niques, NBS Dimensions, July, 1978, 22-23. 10. Knuth, D. Fundamental Algorithms, Addison V/esley, 1958, , Reading, Mass. -24-11. Knuth, D. Sorting and Searching, Addison Vfesley, 1973, , Reading, Mass. ' -25-NBS-114A (REV. B.78) U.S. DEPT. OF COMM. 1. PUBLICATION OR REPORT NO. BIBLIOGRAPHIC DATA NBS SP 500-61 SHEET 4. TITLE AND SUBTITLE 5. Publication Date CXayiPUTER SCIENCE & TECHNOLOGY: August 1980 MAINTENANCE TESTING FOR THE DATA ENCRYPTION STANDARD 7. AUTHOR(S) 8. PerformingOrgan. ReportNo. Jason Gait 9. PERFORMING ORGANIZATION NAME AND ADDRESS NATIONAL BUREAU OF STANDARDS DEPARTMENT OF COMMERCE 11. Contract/Grant No. WASHINGTON, DC 20234 12. SPONSORING ORGANIZATION NAME AND COMPLETE ADDRESSrsfree*. City, state. ziP) 13. Type of Report& Period Covered Same as above Final 15. SUPPLEMENTARY NOTES Library of Congress Number: 80-600105 Document describes a computer program; SF-185, FIPSSoftware Summary, is attached. I I 16. ABSTRACT (A 200-worclor Jess tactual summary olmoat signilicaiit information. IIdocument includes a significant bibliography or literature survey, mention ithere.) This publication describes the design of maintenance tests for the Federal Information Processing Data Encryption Standard (DES) The . test consists of an iterative procedure that completely tests the operation of DES devices by using a small program and minimum data. The tests are designed to be independent of implementation and to be fast enough to test devices during actual operation. The tests are defined as four stopping points in a general testing process, and satisfy four testing requirements depending on the thoroughness of testing desired. 17. KEY WORDS(six to twelve entries;alphabetical order; capitalize only the first letter of the first key wordunless a propername; separated by semicolons) Communications security; computer security; cryptography; data encryption standard; in-service testing; maintenance tests; Monte-Carlo testing; stuck-fault testing; test cases; validation vs maintenance 18. AVAILABILITY [XIUnlimited 19. SECURITY CLASS 21. NO. OF (THIS REPORT) PRINTED PAGES I I ForOfficial Distribution. Do Not Release to NTIS UNCLASSIFIED 29 1x1Order From Sup. of Doc, U.S. Government Printing Office, Washington, DC 20. (S TE HC IU SR PI AT GY E)CLASS 22. Price 20402 Q $2.00 Order From National Technical Information Service (NTIS), Springfield, VA. 22161 UNCLASSIFIED USCOMM-DCNBS TECHNICAL PUBLICATIONS PERIODIpALS NOTE: The principal publication outlet for the foregoing data is the Journal of Physical and Chemical Reference Data (JPCRD) JOURNAL OF RESEARCH—The Journal of Research of the published quarterly for NBS by the American Chemical Society National Bureau ofStandards reports NBS research and develop- (ACS)and the American InstituteofPhysics(AIP). Subscriptions, wm he in ct hin tt hh eos Be ud ri es ac uipli isnes aco tf ivt eh .ep Th hy es si ecal ina cn ld ude eng pi hn ye se ir ci sn ,gs cc hi ee mn ic se ts ryi ,n r Ne Wpr ,int Ws a, sa hn id ngs tu op np ,le Dme Cnt 2s 00a 5v 6a .ilable from ACS, 1155 Sixteenth St., engineering, mathematics, and computer sciences. Papers cover a — broad range of subjects, with major emphasis on measurement Building Science Series Disseminates technical information methodologyandthebasictechnologyunderlyingstandardization. developed at the Bureau on building materials, components, Also included from time to time are survey articles on topics systems, and wholestructures. Theseries presentsresearch results, closely related to the Bureau's technical and scientific programs. testmethods,andperformancecriteriarelatedtothestructuraland As a special service to subscribers each issue contains complete environmental functions and the durability and safety charac- citations to all recent Bureau publications in both NBS and non- teristics of building elements and systems. NBSmedia. Issuedsixtimesayear. Annualsubscription:domestic — $13; foreign $16.23. Single copy, $^ domestic; $3.75 foreign. Technical Notes Studies or reports which are complete in them- selves but restrictive in their treatment ofa subject. Analogous to NOTE: The Journal was formerly published in two sections: Sec- monographs but not so comprehensive in scope or definitive in tion A "Physics and Chemistry" and Section B "Mathematical treatment of the subject area. Often serve as a vehicle for final Sciences." reportsofwork performed at NBS underthesponsorshipofother DIMENSIONS/NBS—This monthly magazine ispublished to in- government agencies. form scientists, engineers, business and industry leaders, teachers, — students, and consumers of the latest advances in science and Voluntary Product Standards Developed under procedures technology,withprimaryemphasisonworkatNBS.Themagazine published by the Department ofCommerce in Part 10, Title 15,of highlights and reviews such issues as energy research, fire protec- the Code of Federal Regulations. The standards establish tion, buildingtechnology, metricconversion,pollution abatement, nationally recognized requirements for products, and provide all health and safety, and consumer product performance. In addi- concerned interests with a basis forcommon understandingofthe tion, it reports the results of Bureau programs in measurement characteristicsoftheproducts. NBSadministersthisprogram asa standards and techniques, properties of matter and materials, supplement to the activities of the private sector standardizing engineering standards and services, instrumentation, and organizations. automatic data processing. Annual subscription: domestic $11; Consumer Information Series— Practical information, based on foreign SI3.75. NBSresearch andexperience,coveringareasofinteresttothecon- NONPERIODICALS sumer. Easily understandable language and illustrations provide — useful background knowledge for shopping in today's tech- Monographs Major contributions to the technical literature on nological marketplace. varioussubjects related tothe Bureau's scientificand technical ac- Order the above NBS publicationsfrom: Superintendent ofDocu- t Hi avi nt die bs o. oks— Recommended codes of engineering and industrial m Oe rn dt es r, tG ho ev fe or ln lm oe wn int gP Nri Bn Stin pg ublO iff ci ac te i, onsW —ash Fi In Pg Sto an n, dD NC BS2 I0 R40 '2 s. —from practice(includingsafetycodes)developed in cooperation with in- theNationalTechnicalInformationServices,Springfield, VA 22161. terested industries, professional organizations, and regulatory bodies. Federal Information Processing Standards Publications (FIPS Special Publications— Include proceedings of conferences spon- PUB)—Publications in this series collectively constitute the sored by NBS, NBSannual reports,andotherspecialpublications Federal Information Processing Standards Register. The Register appropriatetothisgroupingsuchaswallcharts, pocketcards,and serves as theofficial sourceofinformation in the Federal Govern- bibliographies. ment regarding standards issued by NBS pursuant to the Federal Applied Mathematics Series— Mathematical tables, manuals, and Property and Administrative Services Act of 1949 as amended. es bt i nou gld aoi gge i es s dtso , if nm ss a cp ite ehc nei tma il a fit cii c an it nae dnre ss t,t ecc ht noo im cp ap u lh ty wes oi rc ri kps .t rs o, gre an mg mi en ree sr ,s, anc dhem oi ts ht es r, s e oP c fu ub t Tl iii tvc le eL Or 1a 5dw e Cr8 F9 1 R- 13 70 (16 7 C( o( 3 d7 8 e9 FS ot fRat F. 1 e2 d31 e11 r52 a,7 l) d, a Rt ea e gn udd laMa tas iy oni sm I )Ip .,le 1m 9e 73n )te ad ndby ParE tx- 6 National Standard Reference Data Series— Provides quantitative NBS Interagency Reports(NBSIR)—A special seriesofinterim or data on the physical and chemical properties of materials, com- final reports on work performed by NBS for outside sponsors piled from the world's literature and critically evaluated. (both government and non-government). In general, initial dis- Developed underaworldwideprogramcoordinatedbyNBSunder tribution is handled by the sponsor; public distribution is by the the authority of the National Standard Data Act (Public Law National Technical Information Services, Springfield, VA 22161, 90-396). in paper copy or microfiche form. BIBLIOGRAPHIC SUBSCRIPTION SERVICES Thefollowingcurrent-awarenessandliterature-surveybibliographies Superconducting Devices and Materials. A literature survey issued are issued periodically by the Bureau: quarterly. Annual subscription: $45. Please send subscription or- Cryogenic Data CenterCurrentAwarenessService.A literaturesur- dersandremittancesfortheprecedingbibliographicservicestothe vey issued biweekly. Annual subscription: domestic $35; foreign N Boa ut li do en ra ,l CB Our 8e 0a 3u 03.of Standards, Cryogenic Data Center (736) $45. LiquefiedNaturalGas.A literaturesurveyissuedquarterly.Annual subscription: $30.U.S. DEPARTMENT OF COMMERCE National Bureau of Standards Washington.D.C.20234 POSTAGE AND FEES PAID OFFICIAL BUSINESS U.S. DEPART CM OE MNT -2O 1F 5COMMERCE PenaltyforPrivateUse.S300 SPECIALFOURTH-CLASSRATL BOOK