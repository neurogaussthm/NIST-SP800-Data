NIST SPECIAL PUBLICATION 1800-4 Mobile Device Security Cloud and Hybrid Builds Includes Executive Summary (A); Approach, Architecture, and Security Characteristics (B); and How-To Guides (C) Joshua Franklin Kevin Bowler Christopher Brown Spike E. Dog Sallie Edwards Neil McNab Matthew Steele This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.1800-4 The original draft of this publication is available free of charge from: https://www.nccoe.nist.gov/projects/building-blocks/mobile-device-security/cloud-hybridNIST SPECIAL PUBLICATION 1800-4 Mobile Device Security: Cloud and Hybrid Builds Includes Executive Summary (A); Approach, Architecture, and Security Characteristics (B); and How-To Guides (C) Joshua Franklin National Institute of Standards and Technology Information Technology Laboratory Kevin Bowler Christopher Brown Spike E. Dog Sallie Edwards Neil McNab Matthew Steele The MITRE Corporation McLean, VA February 2019 U.S. Department of Commerce Wilbur Ross, Secretary National Institute of Standards and Technology Walter G. Copan, Undersecretary of Commerce for Standards and Technology and DirectorNIST SPECIAL PUBLICATION 1800-4A Mobile Device Security Cloud and Hybrid Builds Volume A: Executive Summary Joshua Franklin National Institute of Standards and Technology Information Technology Laboratory Kevin Bowler Christopher Brown Spike E. Dog Sallie Edwards Neil McNab Matthew Steele The MITRE Corporation McLean, VA February 2019 This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.1800-4 The original draft of this publication is available free of charge from: https://www.nccoe.nist.gov/projects/building-blocks/mobile-device-security/cloud-hybridExecutive Summary ◼ Adopting mobile devices without the necessary policies and management infrastructure in place increases the opportunities for attackers to breach sensitive enterprise data. T sih ◼ The National Cybersecurity Center of Excellence (NCCoE) at the National Institute of Standards p and Technology (NIST) developed example mobile device and enterprise mobility management u b solutions that organizations can use to reduce the likelihood of a data breach. cil a oit ◼ The security characteristics in this guide are informed by guidance and best practices from n standards organizations. si a v ◼ The NCCoEʼs approach uses commercially available products that can be included alongside your a ali current products in your existing infrastructure. b el f ◼ The example solutions are packaged as a “how to” guide that demonstrates implementation of r e standards-based, commercially available cybersecurity technologies in the real world. The guide e o helps organizations utilize technologies to reduce the risk of intrusion via mobile devices while f hc saving them research and proof of concept costs. a r g e rf CHALLENGE o m h : Information technology (IT) environments have changed drastically because of the increasing popularity t pt of smartphones, tablets, and other highly capable, rapidly maturing mobile devices. These devices have s /: many functional similarities to traditional IT systems — including access to a wide range of enterprise / d applications and data, as well as additional functionality particular to mobile computing. This has greatly o o.i expanded the utility and value of mobile devices, enabling employees to do their jobs more effectively r /g and efficiently. Unfortunately, security controls have not kept pace with the security risks that mobile 1 0 devices can pose, not only in bring your own device (BYOD) scenarios but also in corporately owned and 6. 0 personally enabled (COPE) mobile device deployments, where mobile devices are adopted on an ad hoc 2 8 / basis. This gap in protection mechanisms means that data stored on or accessed from mobile devices is N SI at increased risk of being breached. T PS. For example, suppose that an organization has enabled mobile access to its email, calendaring, and 1. contact management services regardless of the origin of the employeesʼ mobile devices (organization- 8 0 0 owned and employee-owned, organization-provisioned and employee-provisioned, etc.). If sensitive - 4 . data is stored on a poorly secured mobile device that is lost or stolen, an attacker may be able to readily gain unauthorized access to that data. Even worse, a mobile device with remote access to sensitive organizational data could be leveraged by an attacker to gain unauthorized access to not only that data but also any other data that the user can access from a mobile device. SOLUTION The NIST cybersecurity practice guide Mobile Device Security: Cloud and Hybrid Builds demonstrates how commercially available technologies can meet your organization's needs to secure sensitive enterprise data accessed by and/or stored on employees' mobile devices. In our lab at the NCCoE, part of the National Institute of Standards and Technology (NIST), we built an environment based on typical mobile devices and an enterprise email, calendaring, and contact management solution. NIST SP 1800-4A: Mobile Device Security 2We demonstrate how security can be supported throughout the mobile device life cycle. This includes how to configure a device to be trusted by the organization, how to maintain adequate separation between the organization’s data and the employee’s personal data stored on or accessed from the mobile device, and how to handle de-provisioning a mobile device that should no longer have enterprise access (e.g., device lost or stolen, employee leaves the company). T h si This guide… p bu ◼ identifies the security characteristics needed to sufficiently reduce the risks from mobile devices cil storing or accessing sensitive enterprise data a t noi ◼ maps security characteristics to standards and best practices from NIST and other organizations si a ◼ describes two detailed example solutions, along with instructions for implementers and security v a engineers on installing, configuring, and integrating the solutions into existing information ali b technology (IT) infrastructures el r f ◼ selects mobile devices and enterprise mobility management systems that meet the identified e e security characteristics o f hc ◼ provides example solutions that are suitable for organizations of all sizes, and evaluates those a r solutions3 g e rf While the NCCoE used a suite of commercial products to address this challenge, this guide does not o m endorse these particular products, nor does it guarantee compliance with any regulatory initiatives. Your h : t organization’s information security experts should identify the products that will best integrate with t p s your existing tools and IT system infrastructure. Your organization can adopt this solution or one that /: / d adheres to these guidelines in whole, or you can use this guide as a starting point for tailoring and o o.i implementing parts of a solution. r g / 1 0 6. BENEFITS 0 2 8 The NCCoE’s practice guide to Mobile Device Security: Cloud and Hybrid Builds can help your / N SI organization… T S. 1.P ◼ reduce risk so that employees can access the necessary enterprise data from nearly any 8 location, over any network, by using a wide variety of mobile devices 0 0 - 4 ◼ enable the use of BYOD, COPE, and other mobile device deployment models, which may provide . cost savings and increased flexibility for organizations ◼ leverage cloud services to secure sensitive corporate data that uses the latest industry best practices and defense-in-depth security strategies, which may reduce infrastructure costs for organizations ◼ enable identity federation between an on-premise identity store and associated cloud services, which may improve user experience and enhance enterprise security ◼ enhance visibility for system administrators into mobile security events, quickly providing notification and identification of device and data compromise ◼ implement industry standard mobile security controls, reducing long-term costs and decreasing the risk of vendor lock-in NIST SP 1800-4A: Mobile Device Security 3SHARE YOUR FEEDBACK You can view or download the guide at https://www.nccoe.nist.gov/projects/building-blocks/mobile- device-security/cloud-hybrid. Help the NCCoE make this guide better by sharing your thoughts with us as you read the guide. If you adopt this solution for your own organization, please share your experience T h and advice with us. We recognize that technical solutions alone will not fully enable the benefits of our si p solution, so we encourage organizations to share lessons learned and best practices for transforming the u b processes associated with implementing this guide. cil a oit To provide comments or to learn more by arranging a demonstration of this example implementation, n si contact the NCCoE at mobile-nccoe@nist.gov. a v a ali b el f er TECHNOLOGY PARTNERS/COLLABORATORS e o f c Organizations participating in this project submitted their capabilities in response to an open call in the h a Federal Register for all sources of relevant security capabilities from academia and industry (vendors r g e and integrators). The following respondents with relevant capabilities or product components (identified f or as “Technology Partners/Collaborators” herein) signed a Cooperative Research and Development m h : Agreement (CRADA) to collaborate with NIST in a consortium to build this example implementation. tt p s /: / d o o.i r g / 1 0 6. 0 2 8 Certain commercial entities, equipment, products, or materials may be identified by name or company / N SI logo or other insignia in order to acknowledge their participation in this collaboration or to describe an T S. experimental procedure or concept adequately. Such identification is not intended to imply special P 1. status or relationship with NIST or recommendation or endorsement by NIST or NCCoE; neither is it 8 0 intended to imply that the entities, equipment, products, or materials are necessarily the best available 0 - 4 for the purpose. . The National Cybersecurity Center of Excellence (NCCoE), a part of the LEARN MORE National Institute of Standards and Technology (NIST), is a Visit http://nccoe.nist.gov collaborative hub where industry organizations, government agencies, nccoe@nist.gov and academic institutions work together to address businesses’ most 301-975-0200 pressing cybersecurity challenges. Through this collaboration, the NCCoE develops modular, easily adaptable example cybersecurity solutions demonstrating how to apply standards and best practices using commercially available technology. NIST SP 1800-4A: Mobile Device Security 4NIST SPECIAL PUBLICATION 1800-4B Mobile Device Security Cloud and Hybrid Builds Volume B: Approach, Architecture, and Security Characteristics Joshua Franklin National Institute of Standards and Technology Information Technology Laboratory Kevin Bowler Christopher Brown Spike E. Dog Sallie Edwards Neil McNab Matthew Steele The MITRE Corporation McLean, VA February 2019 This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.1800-4 The original draft of this publication is available free of charge from: https://www.nccoe.nist.gov/projects/building-blocks/mobile-device-security/cloud-hybridDISCLAIMER Certain commercial entities, equipment, products, or materials may be identified in this document in order to describe an experimental procedure or concept adequately. Such identification is not intended to imply recommendation or endorsement by NIST or NCCoE, nor is it intended to imply that the entities, equipment, products, or materials are necessarily the best available for the purpose. T h si p u b cil a t oi n si a v a ali National Institute of Standards and Technology Special Publication 1800-4B, Natl. Inst. Stand. Technol. b el Spec. Publ. 1800-4B, 61 pages, February 2019, CODEN: NSPUE2 f r e e o f c h a r g e f r o m h : t pt FEEDBACK s /: / od As a private-public partnership, we are always seeking feedback on our Practice Guides. We are o.i particularly interested in seeing how businesses apply NCCoE reference designs in the real world. If you r g / have implemented the reference design, or have questions about applying it in your environment, 1 0 6. please email us at mobile-nccoe@nist.gov. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . National Cybersecurity Center of Excellence National Institute of Standards and Technology 100 Bureau Drive Mailstop 2002 Gaithersburg, MD 20899 Email: nccoe@nist.gov NIST SP 1800-4B: Mobile Device Security iNATIONAL CYBERSECURITY CENTER OF EXCELLENCE The National Cybersecurity Center of Excellence (NCCoE), a part of the National Institute of Standards and Technology (NIST), is a collaborative hub where industry organizations, government agencies, and academic institutions work together to address businesses’ most pressing cybersecurity issues. This public-private partnership enables the creation of practical cybersecurity solutions for specific industries T as well as for broad, cross-sector technology challenges. Through consortia under Cooperative Research h si and Development Agreements (CRADAs), including technology partners — from Fortune 50 market p u b leaders to smaller companies specializing in IT security — the NCCoE applies standards and best cil practices to develop modular, easily adaptable example cybersecurity solutions using commercially a t oi available technology. The NCCoE documents these example solutions in the NIST Special Publication n si 1800 series, which maps capabilities to the NIST Cybersecurity Framework and details the steps needed a v for another entity to recreate the example solution. The NCCoE was established in 2012 by NIST in a ali partnership with the State of Maryland and Montgomery County, Md. b el r f To learn more about the NCCoE, visit https://nccoe.nist.gov. To learn more about NIST, visit e e o https://www.nist.gov. f c h a NIST CYBERSECURITY PRACTICE GUIDES r g e f or NIST Cybersecurity Practice Guides (Special Publication Series 1800) target specific cybersecurity m h : challenges in the public and private sectors. They are practical, user-friendly guides that facilitate the tt adoption of standards-based approaches to cybersecurity. They show members of the information p /:s security community how to implement example solutions that help them align more easily with relevant / d standards and best practices and provide users with the materials lists, configuration files, and other o o.i information they need to implement a similar approach. r g / 1 The documents in this series describe example implementations of cybersecurity practices that 0 6. businesses and other organizations may voluntarily adopt. These documents do not describe regulations 0 2 8 or mandatory practices, nor do they carry statutory authority. / N SI T ABSTRACT S. P 1. 8 This document proposes a reference design on how to architect enterprise-class protection for mobile 0 0 - devices accessing corporate resources. The example solutions presented here can be used by any 4 . organization implementing an enterprise mobility management solution. This project contains two distinct builds: cloud and hybrid. The cloud build makes use of cloud-based services and solutions, while the hybrid build achieves the same functionality but hosts the data and services within an enterpriseʼs own infrastructure. The example solutions and architectures presented here are based upon standards- based, commercially available products. KEYWORDS mobile; mobile device; mobile device management; mobility management; mobile security NIST SP 1800-4B: Mobile Device Security iiACKNOWLEDGMENTS We are grateful to the following individuals for their generous contributions of expertise and time. Name Organization T Rick Engle Microsoft h si p u b Kevin Fiftel Intel cil a t oi Paul Fox Microsoft n si a av Steve Kruse Symantec ali b el f Tim LeMaster Lookout r e e o f Nate Lesser NIST National Cybersecurity Center of Excellence c h a r eg Adam Madlin Symantec f r o m h : Kevin McPeak Symantec t t p s /: Rene Peralta Microsoft / d o o.i Atul Shah Microsoft r g / 1 0 6. Steve Taylor Intel 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security iiiThe Technology Partners/Collaborators who participated in this build submitted their capabilities in response to a notice in the Federal Register. Respondents with relevant capabilities or product components were invited to sign a Cooperative Research and Development Agreement (CRADA) with NIST, allowing them to participate in a consortium to build the example solutions. We worked with: Technology Partner/Collaborator Build Involvement T h p si Intel Lenovo Miix 2.8 Mobile Device u b cil a Lookout Enterprise Mobility Management Application t oi n si a Microsoft Microsoft Cloud Service, Company Portal, Intune, Office v a ali 365 Enterprise E3, Outlook & Community Portal Mobile b Applications, System Center 2012 R2 Configuration el f Manager SP1, Windows Phone OS r e e o f Symantec X.509 Certificate c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security ivContents T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r 3.4.1 Threats .......................................................................................................................... 7 g e rf 3.4.2 Vulnerabilities ............................................................................................................... 8 o m h : 3.4.3 Risk ................................................................................................................................ 9 t pt 3.4.4 Security Control Map .................................................................................................... 9 s /: / d o o.i r g / 1 0 6. 0 2 4.1.1 Cloud Architecture Benefits ........................................................................................20 8 / N 4.1.2 Cloud Build Security Characteristics ...........................................................................21 SI T S. P 81. 4.2.1 Hybrid Architecture Benefits ......................................................................................24 0 0 - 4.2.2 Hybrid Build Security Characteristics ..........................................................................25 4 . 4.3.1 Default Policies ...........................................................................................................25 NIST SP 1800-4B: Mobile Device Security v6.3.1 Data Protection ...........................................................................................................42 6.3.2 Data Isolation ..............................................................................................................42 6.3.3 Device Integrity ...........................................................................................................42 T h 6.3.4 Monitoring ..................................................................................................................43 si p u 6.3.5 Identity and Authorization ..........................................................................................43 b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security viList of Figures Figure 3-1 Mobile Technology Stack ....................................................................................................8 Figure 4-1 Cloud Build Architecture .................................................................................................. 20 Figure 4-2 Hybrid Build Architecture ................................................................................................. 22 hT Figure 5-1 Android Workflow ........................................................................................................... 35 si up Figure 5-2 iOS Workflow................................................................................................................... 36 b cil Figure 5-3 Windows Phone Workflow ............................................................................................... 37 a t oi n si a v a List of Tables ali b el f Table 3-1 Security Characteristic Standards Mapping (Data Protection) ............................................. 10 r e e Table 3-2 Security Characteristic Standards Mapping (Data Isolation) ................................................ 10 o f c h Table 3-3 Security Characteristic Standards Mapping (Device Integrity) ............................................. 11 a r g e Table 3-4 Security Characteristic Standards Mapping (Monitoring) .................................................... 12 f r o m Table 3-5 Security Characteristic Standards Mapping (Identity and Authorization) ............................. 13 h : t Table 3-6 Security Characteristic Standards Mapping (Privacy) .......................................................... 13 t p s /: Table 3-7 Technology Security Characteristic Mapping ...................................................................... 14 / d o o.i Table 4-1 Legend for Hybrid Build Architecture Diagram ................................................................... 23 r g / Table 4-2 SP 800-124 Mapping to Security Characteristic ................................................................... 26 1 0 6. Table 6-1 Cybersecurity Framework Subcategory Evaluation ............................................................. 40 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security vii1 Summary This National Institute of Standards and Technology (NIST) Cybersecurity Practice Guide addresses the challenge of securely deploying and managing mobile devices in an enterprise. In many organizations, mobile devices are adopted on an ad hoc basis, possibly without the appropriate policies and infrastructure to manage and secure the enterprise data they process and store. Introducing devices in T h this fashion increases the attack surface of an enterprise, requiring that additional controls be si p implemented to reduce the risk of intrusion. u b cil The NIST SP 1800-4 series of documents contains… a t oi n ▪ descriptions of a mobile device deployment alongside an associated enterprise mobility si management (EMM) system to implement a set of security characteristics and capabilities, along a av with a rationale for doing so ali b ▪ a series of How-To Guides — including installation and configuration of the necessary services — el f showing system administrators and security engineers how to achieve similar outcomes r e e o The solutions and architectures presented are built upon standards-based, commercially available f c products and can be used by any organization deploying mobile devices in the enterprise that is willing h a r to have at least part of the solution hosted within a public cloud. This project contains two distinct g e f builds: cloud and hybrid. The cloud build uses cloud-based data storage and management services for r o m mobile devices, while the hybrid build achieves the same functionality as the cloud build but hosts a h : portion of the data, services, and physical equipment within an enterprise’s own infrastructure. t t p s /: 1.1 The Challenge / d o o.i Mobile devices allow an organization’s users to access information resources wherever they are and r g whenever they need. This presents both opportunities and challenges. The constant internet access / 1 0 available via a mobile device’s cellular and Wi-Fi connections has the potential to make business 6. 0 practices more efficient and effective, but it can be challenging to ensure the confidentiality, integrity, 2 8 / and availability of the information that a mobile device accesses, stores, and processes. As mobile N SI technologies mature, users increasingly want to use both organization-issued and personally owned T S. mobile devices to access enterprise services, data, and other resources to perform work-related P 1. activities. Despite the increased security risks posed by the coexistence of enterprise data with 8 0 0 personally owned devices, organizations are under pressure to accept them due to several factors, - 4 . including anticipated cost savings, increased productivity, and users’ demand for more convenience. 1.2 The Solution This NIST Cybersecurity Practice Guide demonstrates how commercially available technologies can enable secure access to the organization’s sensitive email, contacts, and calendar information from users’ mobile devices. In our lab at the National Cybersecurity Center of Excellence (NCCoE) at NIST, we built an environment to simulate a lightweight enterprise architecture, including common components present in most organizations such as directory services. Our approach to mobile device security (MDS) includes… NIST SP 1800-4B: Mobile Device Security 1▪ determining the security characteristics required to mitigate in large part the risks of storing enterprise data on mobile devices and transmitting enterprise data to and from mobile devices ▪ mapping security characteristics to standards and best practices from NIST and other organizations recognized for promulgating security information, such as the National Security Agency (NSA) and the Defense Information Systems Agency ▪ architecting a design for our example solutions T h si ▪ selecting mobile devices and EMM systems that provide the necessary controls p u b ▪ evaluating our example solutions cil a t Although corporately owned, personally enabled (COPE) and bring your own device (BYOD) scenarios oi n are not specifically addressed by this project, the necessary features to enable a secure demonstration si a of either scenario are available. Those making information technology (IT) policy and infrastructure v a decisions within an organization will need to use their own judgment to decide where on the device ali b management spectrum they choose to exist. To make these security controls available, organizations el f must securely configure and implement each layer of the technology stack, including mobile hardware, r e e firmware, operating system (OS), management agent, and the applications used to accomplish business o c f objectives. This document provides but one method of accomplishing this task. h a r eg 1.3 Benefits f r o m Our proposed solutions provide the following value to organizations: h : tt ▪ reduce risk so that employees are able to access the necessary enterprise data from nearly any p s /: location, over any network, when using a wide variety of mobile devices / d o ▪ enable the use of BYOD, COPE, and other mobile device deployment models, which may provide o.i r cost savings and increased flexibility for organizations g / 1 0 ▪ enhance visibility for system administrators into mobile security events, quickly providing 6. 0 notification and identification of device and data compromise 2 8 / ▪ implement industry standard mobile security controls, reducing long-term costs and decreasing N SI the risk of vendor lock-in T S. P 1. 2 How to Use This Guide 8 0 0 - 4 This NIST Cybersecurity Practice Guide demonstrates a standards-based reference design and provides . users with the information they need to replicate this approach to mobile security. This reference design is modular and can be deployed in whole or in part. Before implementing this guide, readers may also want to review other mobile security efforts such as those from the National Information Assurance Partnership (NIAP), the U.S. Government Chief Information Officer (CIO) Council, and the Open Web Application Security Project. This guide contains three volumes: NIST SP 1800-4B: Mobile Device Security 2▪ NIST SP 1800-4A: Executive Summary ▪ NIST SP 1800-4B: Approach, Architecture, and Security Characteristics — what we built and why (you are here) ▪ NIST SP 1800-4C: How-To Guides — instructions for building the example solution Depending on your role in your organization, you might use this guide in different ways: T h Business decision makers, including chief security and technology officers, will be interested in the si p Executive Summary, NIST SP 1800-4A, which describes the following topics: u b cil ▪ challenges enterprises face in implementing and using mobile devices a t oi ▪ example solutions built at the NCCoE n si a ▪ benefits of adopting the example solutions v a ali Technology or security program managers who are concerned with how to identify, understand, assess, b el and mitigate risk will be interested in this part of the guide, NIST SP 1800-4B, which describes what we r f did and why. The following sections will be of particular interest: e e o ▪ Section 3.4.3, Risk, which provides a description of the risk analysis we performed f c ah ▪ Section 3.4.4, Security Control Map, which maps the security characteristics of this example r g solution to cybersecurity standards and best practices e f r o You might share the Executive Summary, NIST SP 1800-4A, with your leadership team to help them m h : understand the importance of adopting standards-based access management approaches to protect t t your organization’s mobile and digital assets. p s /: / d IT professionals who want to implement an approach like this will find the entire practice guide useful. o o.i You can use the How-To portion of the guide, NIST SP 1800-4C, to replicate all or parts of the build r g created in our lab. The How-To guide provides specific product installation, configuration, and / 1 0 integration instructions for implementing the example solutions. We do not re-create the product 6. 0 manufacturers’ documentation, which is generally widely available. Rather, we show how we 2 8 / incorporated the products in our environment to create an example solution. N SI T This guide assumes that IT professionals have experience implementing security products within the S. P enterprise. Although we have used a suite of commercial products to address this challenge, this guide 1. 08 does not endorse these particular products. Your organization can adopt this solution or one that 0 - 4 adheres to these guidelines in whole, or you can use this guide as a starting point for tailoring and . implementing parts of a mobile device management solution. Your organization’s security experts should identify the products that will best integrate with your existing tools and IT system infrastructure. We hope that you will seek products that are congruent with applicable standards and best practices. Section 3.5, Technologies, lists the products we used and maps them to the cybersecurity controls provided by the reference solutions. A NIST Cybersecurity Practice Guide does not describe “the” solution, but a possible solution. Comments, suggestions, and success stories will improve subsequent versions of this guide. Please contribute your thoughts to mobile-nccoe@nist.gov. NIST SP 1800-4B: Mobile Device Security 32.1 Typographic Conventions The following table presents typographic conventions used in this volume. Typeface/ Meaning Example Symbol T sih Italics file names and path names; For detailed definitions of terms, see up references to documents that the NCCoE Glossary. b cil are not hyperlinks; new terms; a t and placeholders oi n a si Bold names of menus, options, Choose File > Edit. v a command buttons, and fields ali b el Monospace mkdir f command-line input, on-screen r ee computer output, sample code o examples, and status codes f c h a gr Monospace Bold command-line user input service sshd start e f contrasted with computer r o m output h : t pt blue text link to other parts of the All publications from NIST’s NCCoE s /: document, a web URL, or an are available at / d o email address https://nccoe.nist.gov/. o.i r g / 1 0 3 Approach 6. 0 2 8 Enterprises traditionally established boundaries to separate their trusted internal IT network(s) from / N SI untrusted external networks. When enterprise users consume and generate enterprise data on mobile T S. devices, this traditional boundary erodes. Due to the rapid changes in today’s mobile platforms, P 1. enterprises have the challenge of ensuring that mobile devices connected to their networks can be 8 0 trusted to protect sensitive data as it is stored, processed, and transmitted while still giving users the 0 - 4 features they have come to expect from mobile devices. Additionally, some enterprises host enterprise . data in a public cloud infrastructure, which also needs to be protected. This guide proposes a system of commercially available technologies that provides enterprise-class protection for mobile platforms accessing and interacting with enterprise resources. The implementations presented here can be used by any organization interested in implementing an EMM solution. This project contains two distinct builds: one focuses on cloud-based data, management, and services; the other leverages the same EMM infrastructure in-house. The cloud build may be useful to smaller organizations wanting to rapidly deploy a mobile solution or offload services hosted in-house to the NIST SP 1800-4B: Mobile Device Security 4cloud. The hybrid build uses the same services as the cloud build but hosts services and data on site within an organization’s premises. When conceptualizing the project, the project team looked to EMM systems deployed by industry. Users were sometimes frustrated with policies pushed from enterprises, and system administrators were confused about the most appropriate policies to push to mobile devices. This information was the impetus for creating the scenarios included in the building block definition document . T h p si A number of security characteristics and capabilities are documented within the building block u b definition. We analyzed the content and concepts from multiple standards to generate the necessary acil security characteristics. These include NIST Special Publication (SP) 800-124, Guidelines for Managing t oi the Security of Mobile Devices in the Enterprise ; NIST SP 800-164 (DRAFT), Guidelines on Hardware- n si Rooted Security in Mobile Devices ; NSA mobile access capability package  and the appropriate a v NIAP protection profiles , , . a ali b el 3.1 Audience f r e o e The cloud build is geared toward organizations wanting to operate and maintain systems external to f c their enterprise environment to lower operational expenses. These organizations elect to leverage a h a software as a service cloud provider for services such as office productivity tools for workstations. The r g e addition of mobile devices into this environment adds complexity because the organization requires f r o protection of its sensitive data, but this data is not under its direct control. m h : t The hybrid build is meant for organizations that are concerned with the risks associated with storing and t p s processing confidential enterprise information in the cloud. These organizations have the willingness /: / d and technical expertise to implement and manage the necessary infrastructure to host the services on o o.i premises and may need to prevent cloud-based authentication and not wish to expose their existing r g identity repository to the cloud. The hybrid build includes a combination of enterprise assets likely to be / 1 0 present in an organization’s existing network and adds cloud services for EMM, making it a starting point 6. 0 for an organization that has significant investment in or dependence on an internal Active Directory (AD) 2 8 / server. N SI T S. 3.2 Scope P 1. 8 This publication seeks to assist organizations in developing and implementing sound EMM deployments 0 0 - for securely accessing email, contacts, and calendaring. It provides practical, real-world guidance on 4 . developing, implementing, and maintaining secure, effective mobile devices, mobile applications, and EMM solutions in an enterprise. The publication presents EMM technologies from a high-level viewpoint and then provides a step-by-step guide to implementing a specific solution. The OSes and applications storing and transmitting the data must be securely configured and implemented. The EMM used within this build accomplishes this by sending policies to the mobile device and enforcing these policies by leveraging the device’s OS protections. The problem statement for this building block  describes a large number of security and functional characteristics and capabilities. It is important to note that this document does not employ each and every one of them. For instance, topics such as mobile application vetting, privacy, continuous NIST SP 1800-4B: Mobile Device Security 5monitoring, and comprehensive security testing of our build are important complementary steps to securing devices in an enterprise but are out of scope for this phase of the building block. The specific security characteristics and capabilities used in the cloud and hybrid builds are noted later in Section 4.3. The scope of these two builds demonstrates the following objectives: ▪ secure implementation of email, contacts, and calendaring T h ▪ installation, implementation, and configuration of an EMM system si p u ▪ hardened mobile devices securely accessing enterprise data for which the user and device are b cil authorized a t oi Privacy issues can be complex and difficult to implement, particularly since these issues often span a n si broad range of topics, from law and policy to technology. Although privacy protections are listed within a v our desired capabilities, these goals are out of scope for this publication and will be addressed in a ali subsequent efforts. In the meantime, organizations may want to follow a more comprehensive privacy b el engineering effort to satisfy these goals, such as National Institute of Standards and Technology Internal f r e Report 8062, An Introduction to Privacy Engineering and Risk Management in Federal Systems . e o f c Finally, the breadth of technologies in this building block was intentionally limited to organizations that h a have entered into a National Cybersecurity Excellence Partnership (NCEP) with the NCCoE, meaning that r g e only NCEP partners of the NCCoE were allowed to participate in the build phase of this project. We f r o anticipate significantly expanding on the technologies used within the next phase of this MDS project by m h : leveraging Cooperative Research and Development Agreements (CRADAs) with other interested t t collaborators. Organizations wishing to participate in future efforts should visit the NCCoE’s website for p s /: more information about participating. / d o o.i 3.3 Assumptions r g / 1 0 The following assumptions exist for this project: 6. 0 2 ▪ Both the cloud and hybrid builds are highly dependent on Microsoft’s cloud platform, including 8 / N Microsoft Office 365 and Microsoft Intune. Organizations trust these services to function SI T properly and to appropriately handle sensitive information S. P 1. ▪ Organizations manage their own domains with the ability to alter Domain Name System (DNS) 8 0 information on an ad hoc basis to prove ownership of a DNS name space so it can be associated 0 - 4 to Office 365 services, email authority, mail exchanger records, and establishment of federation . services ▪ Within the hybrid build, organizations place a system outside a perimeter firewall that proxies the connection between their Active Directory Domain Services and Microsoftʼs cloud services ▪ Organizations trust the mobile OSes within this build (e.g., Android, iOS, Windows) to store and process sensitive information 3.4 Risk Assessment NIST Special Publication (SP) 800-30, Guide for Conducting Risk Assessments, states that risk is “a measure of the extent to which an entity is threatened by a potential circumstance or event, and typically a function of (i) the adverse impacts that would arise if the circumstance or event occurs and NIST SP 1800-4B: Mobile Device Security 6(ii) the likelihood of occurrence.” The guide further defines risk assessment as “the process of identifying, estimating, and prioritizing risks to organizational operations (including mission, functions, image, reputation), organizational assets, individuals, other organizations, and the Nation, resulting from the operation of an information system. Part of risk management incorporates threat and vulnerability analyses, and considers mitigations provided by security controls planned or in place.” The NCCoE recommends that any discussion of risk management, particularly at the enterprise level, T h si begins with a comprehensive review of NIST 800-39, Managing Information Security Risk , which is p freely available to the public. NIST SP 800-37, Guide for Applying the Risk Management Framework to u b cil Federal Information Systems , proved invaluable in giving us a baseline to assess risks, from which a t we developed the project, the security characteristics of the build, and this guide. oi n si The nature of mobile devices creates a set of unique risks in the modern enterprise. Future phases of a v this guide will include a NIST SP 800-30 based risk assessment, but it is currently out of scope for this a ali effort. However, it is useful to highlight broad categories of threats and vulnerabilities. b el r f We have used NIST SP 800-124 ; NIST SP 800-163 ; and the United States Computer Emergency e e o Readiness Team (US-CERT) Technical Information Paper-TIP-10-105-01, Cyber Threats to Mobile Devices f c , as sources for this section, which is not an exhaustive list of threats to mobile devices. Although h a this practice guide focuses only on the threats and vulnerabilities related to the mobile device, readers r g e should also consider broader threats to services that provide mobile device management (MDM) f r o capabilities while assessing risk. Additional consideration should be given to threats posed from cloud m h : services and the mobile ecosystem supporting the device. Cloud MDM services that leverage the Federal t pt Risk and Authorization Management Program (FedRAMP), for example, can increase confidence in the s /: security of these solutions with consistent security authorizations using a baseline set of agreed-upon / d o standards . o.i r g To further address comments received in the public comment period of 1800-4, Mobile Device Security: / 1 0 Cloud and Hybrid Builds draft publication, the NCCoE Mobile Device Security Project team has produced 6. 0 National Institute of Standards and Technology Interagency Report 8144, Assessing Threats to Mobile 2 8 / Devices & Infrastructure. This publication accompanies the Mobile Threat Catalogue, which describes, N SI identifies, and structures the threats posed to mobile information systems. We received many T S. comments with a common theme that the example architectures in 1800-4 did not address the entire P 1. mobile security ecosystem. We encourage readers to review National Institute of Standards and 8 0 0 Technology Interagency Report 8144 and the Mobile Threat Catalogue to assist in developing risk - 4 . assessments, building threat models, enumerating the attack surface of their mobile infrastructure, and identifying mitigations for their mobile deployments. 3.4.1 Threats Below are common threats to mobile devices: NIST SP 1800-4B: Mobile Device Security 7▪ mobile malware ▪ social engineers ▪ stolen data due to loss, theft, or disposal ▪ unauthorized access ▪ electronic eavesdropping T h si ▪ electronic tracking p u b ▪ access to data by legitimate third-party applications cil a oit 3.4.2 Vulnerabilities n a si Vulnerabilities are commonly associated with applications that are installed on mobile devices. v a However, it is important to recognize that vulnerabilities can be exploited at all levels in the mobile ali b device stack, which is outlined below in Figure 3-1. el f er Figure 3-1 Mobile Technology Stack e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 Applications that can be exploited can come from various sources — they may be installed by the device 0 - 4 owner, preinstalled by a mobile network operator (i.e., carrier), or natively bundled with the OS. . Although carrier and bundled applications can add valuable functionality to the device, the attack surface is also broadened. Further, carrier-installed applications can be particularly troublesome because they can be difficult to remove. Applications may be intentionally malicious, particularly those installed by the device owner. Mobile applications specifically developed to do harm to a device are categorized as mobile malware and often exploit design flaws or vulnerabilities in the mobile OS to achieve malicious design goals. Note that on mobile devices, the firmware and hardware levels are not as clearly defined as Figure 3-1 depicts. Mobile devices with access to a cellular network contain a baseband processor comprising a distinct telephony subsystem used solely for telephony services (e.g., voice calls, texts, data transfer via the cellular network) . This processor and the associated software/firmware on which it operates NIST SP 1800-4B: Mobile Device Security 8are separated from the mobile OS running on the application processor. Furthermore, some mobile devices contain additional security-specific hardware and firmware used to assist with making security decisions and storing important information, such as encryption keys, certificates, and credentials , , . For up-to-date information regarding vulnerabilities, we recommend that security professionals leverage the National Vulnerability Database (NVD). The NVD is the U.S. government repository of standards- T h si based vulnerability management data . p u b cil 3.4.3 Risk a t oi Using the common threats identified previously as a guide, we identified risks that an organization might n si face when deploying mobile devices. In general, these risks focus on data leakage and compromise. a v Because modern mobile devices process many types of information (e.g., personal, enterprise, financial, a ali medical), there are many types of data leakages, each with its own level of severity in a given context. b el The following are potential reasons for data leakage and/or compromise: f r e e ▪ lack of mobile access control (e.g., loss of the mobile device, lock screen protection, enabling o c f smudge attacks) h a r ▪ lack of confidentiality protection (e.g., encryption of data in transit) of information due to g e f operating on unsafe or untrusted networks (e.g., Wi-Fi, cellular) r o m ▪ unpatched firmware, OS, or application software bypassing the OS security architecture (e.g., h : rooted/jailbroken device) t t p /:s ▪ users running malicious mobile applications which may glean information via misuse of inter- / d process communication or other access control mechanisms o o.i ▪ device interaction with cloud services outside corporate control r g / 1 ▪ misuse or misconfiguration of location services, such as global positioning system 0 6. 0 ▪ acceptance of fake mobility management profiles, providing malicious actors with a high degree 2 8 / of device control N SI T ▪ social engineering via voice, short message service /multimedia messaging service, third-party S. P text communication, or email communication 1. 8 0 0 3.4.4 Security Control Map - 4 . Using this risk information, NCCoE engineers identified the security characteristics of the solution. Table 3-1 through Table 3-6 map these characteristics to the Subcategories from the NIST Cybersecurity Framework , NIST SP 800-53 Revision 4 , International Organization for Standardization (ISO) and International Electrotechnical Commission (IEC) 27002 , and the Council on CyberSecurityʼs Critical Security Controls for Effective Cyber Defense . Note: Before transfer to the Council on Cybersecurity,  was informally known as the Sysadmin, Audit, Networking, and Security Consensus Audit Guidelines (CAG) 20. The following tables identify security characteristic standards mappings for data protection, data isolation, device integrity, monitoring, identity and authorization, and privacy. For more information on each of these, reference Section 6. NIST SP 1800-4B: Mobile Device Security 9Table 3-1 Security Characteristic Standards Mapping (Data Protection) Cybersecurity Security NIST SP 800-53 Framework IEC/ISO 27002 CAG 20 Characteristic rev4 Subcategory device encryption PR.AC-3, PR.DS-1, AC-19(5), MP-5(4), 6.2.1, 8.3.1, CSC 17-1, CSC 17-2 T PR.DS-5, PR.PT-2 SC-13, SC-28(1) 10.1.1, 11.2.7, h si 18.1.5 p bu application-level PR.DS-1 SC-28(1) 6.2.1, 8.3.1, CSC 17-1, CSC 17-2, cil encryption 10.1.1, 18.1.5 CSC 17-3 a t oi secure containers ID.AM-3, PR.AC-4, AC-3, AC-3(8), AC- 6.2.1, 8.3.1, CSC 15-4, CSC 15-5, n si PR.DS-1, PR.DS-3, 4, MP-6(8), SC-13, 9.4.1, 10.1.1, CSC 17-1, CSC 17-2, a v PR.DS-5 SC-28(1) 18.1.5 CSC 17-3 a ali trusted key PR.DS-5, PR.PT-3 AC-3(5), SC-12, SC- 10.1.1, 10.1.2, CSC 12-13, CSC 16- b el storage 13, SC-3, SC-3(1) 14.1.3 15, CSC 16-17 f r e e hardware security PR.DS-1, PR.DS-5, IA-7, SC-3, SC-3(1), 10.1.1, 10.1.2, CSC 17-15 o f modules PR.PT-3 SC-34 18.1.5 c h a remote wipe PR.DS-1, PR.DS-3, MP-6(8), SC-28(1) 6.2.1, 8.1.2, r g e PR.IP-6 8.1.4, 8.3.2, f or 11.2.7 m h : selective wipe PR.DS-1, PR.DS-3, MP-6(8), SC-28(1) 6.2.1, 8.1.2, t t PR.IP-6 8.1.4, 8.3.2, p s /: 11.2.7 / d o automatic wipe DE.AE-2, PR.DS-1, AC-7, AC-7(2), MP- 6.2.1, 8.1.2, o.i PR.DS-3, PR.IP-6 6(8), SC-28(1) 8.3.2, 11.2.7, r g 1/ 11.2.8 0 6. encrypted PR.DS-1, PR.DS-5 SC-13, SC-28(1) 10.1.1 CSC 17-3 0 2 8 memory / N SI protected PR.DS-2, PR.DS-5 SC-8, SC-8(1), SC- 9.1.2, 9.4.2, CSC 3-7, CSC 7-6, T S. communications 13 10.1.1, 13.1.1, CSC 15-4, CSC 16- P 1. 13.2.1, 13.2.3, 15, CSC 16-16, CSC 8 0 14.1.3 17-7 0 - 4 protected PR.AC-4, PR.DS-5 AC-6(4), SC-11, SC- 14.1.3 . execution 3, SC-39, SC-39(1) environments Table 3-2 Security Characteristic Standards Mapping (Data Isolation) Cybersecurity Security NIST SP 800-53 Framework IEC/ISO 27002 CAG 20 Characteristic rev4 Subcategory virtualization PR.AC-3, PR.AC-4, AC-20(3), AC-6(4), 6.2.2 CSC 2-8 PR.AC-5 SC-7(21) NIST SP 1800-4B: Mobile Device Security 10Cybersecurity Security NIST SP 800-53 Framework IEC/ISO 27002 CAG 20 Characteristic rev4 Subcategory sandboxing PR.AC-5, PR.DS-5 SC-39, SC-7(21) memory isolation PR.DS-5 SC-39 trusted execution PR.DS-5 SA-13, SC-3, SC-11 14.1.3 T h si device resource PR.AC-3, PR.AC-5, AC-4, AC-19, CM-2, 6.1.2, 6.2.1, CSC 3-1, CSC 7-5, p u management PR.DS-5, PR.IP-1 SC-7(21) 9.1.2, 11.1.5, CSC 7-8, CSC 7-9, b cil 13.2.1 CSC 11-1, CSC 17-8 a t oi data flow control PR.DS-5 AC-4 6.2.1, 8.2.1, CSC 15-5 n si 8.2.3, 9.1.1, a v 9.4.1, 13.2.1 a ali data tagging ID.AM-3, PR.AC-4 AC-4(1), AC-16 8.2.1, 8.2.2 CSC 15-5 b el f baseband PR.DS-5 SC-39, SC-39(1) r e e isolation o c f h a gr Table 3-3 Security Characteristic Standards Mapping (Device Integrity) e f r o m Cybersecurity Security NIST SP 800-53 h : Framework IEC/ISO 27002 CAG 20 t Characteristic rev4 t Subcategory p s //: baseband PR.DS-6 SI-7, SI-7(1), SI-7(9) 12.2.1 d o integrity checks o.i gr application DE.CM-3, PR.IP-1 CM-7(4), CM-7(5), 6.2.1, 12.2.1, CSC 2-1, CSC 2-2, / 1 whitelisting/ CM-11 12.6.2 CSC 6-1 0 6. blacklisting 0 2 /8 boot validation PR.DS-6 SI-7, SI-7(6), SI-7(9), 12.2.1 N SI SI-7(10), SI-7(12) T S. application PR.DS-6 SI-7, SI-7(1), SI-7(6) 12.2.1 CSC 3-8 P 1. verification 8 0 0 verified PR.DS-6 SI-7, SI-7(1), SI-7(6) 12.2.1 CSC 3-8 - 4 . application and OS updates mobile malware DE.AE-2, DE.CM- MP-7, SI-3, SI-3(2), 6.2.1, 12.2.1, CSC 5-1, CSC 5-2, detection 4, PR.PT-2 SI-3(7), SI-4(7) 13.2.1 CSC 5-8 trusted integrity PR.PT-1, PR.DS-6 AU-9, AU-9(3), IA- 18.2.3 CSC 3-8, CSC 13-8 reports 3(4), SA-13, SI-7, SI- 7(1) policy integrity PR.DS-6 SI-7, SI-7(1), SI-7(6) 18.2.3 CSC 3-8 verification NIST SP 1800-4B: Mobile Device Security 11Table 3-4 Security Characteristic Standards Mapping (Monitoring) Cybersecurity Security NIST SP 800-53 Framework IEC/ISO 27002 CAG 20 Characteristic rev4 Subcategory inventory of ID.AM-1, ID.AM-2 CM-8, CM-8(2) 8.1.1, 8.3.1, CSC 1-1, CSC 1-3, T mobile device 12.2.1, 12.6.1, CSC 1-4, CSC 2-4, h si hardware, 18.1.2 CSC 2-5 p u firmware, and b cil software a oit asset ID.RA-1, PR.AC-3, AC-19, CM-2, CM- 6.2.1, 8.1.1, CSC 3-1, CSC 3-3, n si management PR.IP-1 6, SC-43, SI-2 9.1.2, 11.2.8, CSC 3-7, CSC 3-10, a 11.2.9, 12.1.1, CSC 16-5, CSC 16-6, v a ali 12.1.2, 12.5.1, CSC 16-8, CSC 16-9 b 12.6.1, 12.6.2, el f 18.1.2 r e e o compliance DE.CM-3, ID.AM- AC-19, AC-20, AC- 12.1.2, 12.2.1, CSC 2-3, CSC 3-1, f c checks 3, ID.AM-4, 20(1), CA-9, CA- 18.2.3 CSC 7-1, CSC 13-8d h a PR.AC-3, PR.IP-1 9(1), CM-6(1), CM- r g e 6(2), CM-11(1) f r o root and jailbreak PR.DS-6 SI-7, SI-7(1), SI- 12.2.1 CSC 7-1, CSC 13-8 m h : detection 7(2), SI-7(6), SI- t t 7(9) p s /: anomalous DE.AE-2, DE.CM-4 IA-10, SI-4, SI-4(5), 9.4.2, 12.2.1 CSC 5-8 / d o behavior SI-4(11), SI-4(24), o.i detection SI-15 r g / 1 auditing and PR.PT-1, RS.AN-1 AU-2, AU-3, AU-8, 12.1.1, 12.4.1, CSC 14-1, CSC 14-2 0 6. logging AU-9, AU-12, IR-5 12.4.2, 12.4.3, 0 2 8 12.4.4, 12.7.1, / N 16.1.1 SI T S. canned reports PR.PT-1 AU-7, AU-7(1), AU- P 1. and ad hoc 7(2) 8 0 queries 0 - 4 geofencing DE.CM-7, ID.AM- AC-4AC-4(3), AC- 9.1.2 . 3, PR.AC-4, PR.AC- 4(8), AC-6, CM-8(8) 5, PR.PT-1 NIST SP 1800-4B: Mobile Device Security 12Table 3-5 Security Characteristic Standards Mapping (Identity and Authorization) Cybersecurity Security NIST SP 800-53 Framework IEC/ISO 27002 CAG 20 Characteristic rev4 Subcategory local PR.AC-4, PR.DS-5 AC-3, IA-6 6.2.1, 9.3.1, CSC 16-8 T authentication of 9.4.1, 9.4.2, h si user to device 10.1.1 p bu local user PR.AC-4, PR.DS-5 AC-3, IA-6 6.2.1, 9.1.1, CSC 16-8 cil authentication to 9.3.1, 9.4.1, a oit applications 9.4.2, 10.1.1 n si remote user PR.AC-1, PR.AC-4, AC-3, AC-17, IA-2, 6.2.1, 9.1.1, CSC 7-1, CSC 12-8, a v authentication PR.DS-5 IA-2(2), IA-2(11), 9.1.2, 9.3.1, CSC 13-7, CSC 16-8, a ali IA-6 9.4.1, 9.4.2, CSC 16-14 b el 10.1.1, 13.1.1, f r 14.1.3 e e o remote device PR.AC-1, PR.AC-3, AC-3, AC-17, AC- 6.2.1, 9.1.1, CSC 1-7, CSC 7-1, f hc authentication PR.AC-4 19, IA-3, IA-3(1), 9.4.1, 10.1.1, CSC 7-7, CSC 13-8 a r IA-3(4) 13.1.1, 14.1.3 g e rf implementation PR.AC-4 AC-3, AC-3(7), AC-6 6.2.1, 9.1.1 o m of user and device h : roles for t t p authorization s /: / device ID.AM-1, PR.AC-3, AC-19, CM-7(3), 6.2.1, 8.1.2, CSC 5-7, CSC 7-1, d o o.i provisioning and PR.PT-1, PR.PT-2, CM-8(4), MP-5(3), 8.1.4, 8.2.3, CSC 13-8 gr enrollment PR.PT-3 MP-7(1) 8.3.1, 8.3.2, / 1 9.2.2, 11.2.5 0 6. 0 credential and PR.AC-1 IA-2, IA-2(10), IA- 9.2.3, 9.2.4, CSC 1-7, CSC 12-13, 2 8 token storage and 2(11), IA-2(12), IA- 9.3.1, 9.4.2, CSC 12-12, CSC 16- / N SI use 5, IA-5(1), IA-5(2), 10.1.1, 10.1.2, 8, CSC 16-14, CSC T S. IA-5(4), IA-5(6), IA- 14.1.3 16-15, CSC 16-16 P 1. 5(9), IA-5(10), IA- 8 0 5(11), IA-5(12), IA- 0 - 4 5(13) . Table 3-6 Security Characteristic Standards Mapping (Privacy) Cybersecurity Security Characteristic Framework NIST SP 800-53 rev4 IEC/ISO 27002 Subcategory informed consent of ID.GV-3 AC-8, PS-6 8.1.3, 9.4.2 user NIST SP 1800-4B: Mobile Device Security 13Cybersecurity Security Characteristic Framework NIST SP 800-53 rev4 IEC/ISO 27002 Subcategory data monitoring ID.GV-3 DM-1 minimization T custom privacy ID.GV-3 TR-1 h si statement p u b cil 3.5 Technologies a t oi n Following the draft publication of NIST SP 800-164 , NIST began looking for additional ways to foster si a mobile security in the enterprise. The three primary mobility security principles of NIST SP 800-164 (i.e., v a device integrity, isolation, and protected storage) were used as a baseline. Moving forward, NCCoE ali b engineers used other standards and guidance relating to mobility to build upon these principles to el f create the full list of security characteristics and capabilities in Section 4.3. r e e o The initial document describing this projectʼs security challenge was released in 2014 . After f c h incorporating public comments and revising the document, the NCCoE MDS team consulted with the a gr NCCoE’s NCEP partners to understand which technologies would be applicable to this project. The e f technologies used in this project are listed in Table 3-7. Note that this represents a best effort in r o m reflecting how key security functions of each product can support an organization’s standards-based h : approach to cybersecurity risk management. These products may have additional security functions not t t p s represented here. /: / d o Table 3-7 Technology Security Characteristic Mapping o.i r g / Cybersecurity 1 NIST SP 800-53 Rev4 0 Technology Use Product Framework 6. Controls 0 Subcategory 2 8 N/ EMM Web service Microsoft DE.CM-3, ID.AM-1, AC-3, AC-6(1), AC-6(3), TSI used to define Intune ID.AM-2, ID.AM-3, AC-17(2), AC-19, AU-2, PS. and send ID.AM-4, ID-RA-1, AU-3, AU-7, AU-7(1), 1. policies to PR.AC-3, PR.AC-4, AU-7(2), AU-8, AU-9, 8 0 0 mobile devices PR.DS-3, PR.DS-6, AU-12, AC-20, AC-20(1), - 4 . PR.IP-1, PR.IP-6, CA-9, CA-9(1), CM-2, PR.PT-1, PR.PT-2, CM-6, CM-6(1), CM- PR.PT-3, RS.AN-1 6(2), CM-7, CM-7(3), CM-7(4), CM-7(5), CM- 8, CM-8(2), CM-8(4), CM-11, CM-11(1), IR-5, MP-5(3), MP-6(8), MP- 7(1), SC-8, SC-8(1), SI-2, SI-7(1), SI-7(2), SI-7(5) NIST SP 1800-4B: Mobile Device Security 14Cybersecurity NIST SP 800-53 Rev4 Technology Use Product Framework Controls Subcategory Microsoft ID.AM-1, ID.AM-2, AC-2, AC-3, AC-6(1), AC- Office 365 ID.AM-3, ID.AM-4, 6(3), AC-17(2), AC-19, MDM ID.RA-1, PR.AC-3, AC-20, AC-20(1), AU-2, T PR.AC-4, PR.DS-3, AU-3, AU-7, AU-7(1), h si PR.DS-6, PR.IP-1, AU-8, AU-9, CA-9, CA- p u PR.IP-6, PR.PT-1, 9(1), CM-2, CM-6, CM- b cil PR.PT-2, PR.PT-3, 6(1), CM-6(2), CM-7, a oit RS.AN-1 CM-7(3), CM-8, CM- n si 8(2), CM-8(4), IR-5, MP- a 5(3), MP-6(8), MP-7(1), v alia SC-8, SC-8(1), SI-2, SI- b 7(1), SI-7(2), SI-7(5) el r f Cloud Platform Provides Microsoft PR.AC-1, PR.AC-4, AC-2, AC-3, AC-17, IA-2, e o e directory Office 365 PR.DS-2, PR.DS-5 IA-2(10), IA-5, IA-6, SC- c f services and Enterprise E3 8, SC-8(1) h a web-based r g e productivity f or applications m h : Federation Allows service Microsoft ID.GV-3, PR.AC-4, AC-17, AC-24(1), SC-8, tt Services providers to Active PR.DS-2 SC-8(1), TR-1 p /:s authenticate Directory / d users who are Federation o o.i managed by a Services r g trusted identity / 1 0 provider 6. 0 2 Inventory and Provides Microsoft DE.CM-3, ID.AM-1, AU-2, AU-3, AU-6, AU-7, 8 / Configuration centralized IT System Center ID.AM-2, ID.AM-4, AU-7(1), AU-7(2), AU-8, N SI Management asset inventory, 2012 R2 ID.RA-1, PR.AC-3, AU-9, AU-12, AC-19, AC- T S. configuration, Configuration PR.PT-1, PR.IP-1, 20, AC-20(1), CM-2, CM- P 1. and Manager RS.AN-1 5, CM-6, CM-6(1), CM- 8 0 management 6(2), CM-7(4), CM-7(5), 0 - 4 CM-8, CM-8(2), CM- . 8(4), CM-8(7), CM-11, CM-11(1), IR-5, SI-2 Mobile Device Mobile malware Lookout DE.CM-4, PR.AC-1, AU-2, AU-3, AU-6, AU- End Point detection and Mobile Threat PR.DS-6, PR.IP-1, 7(2), AU-12, CM-6(2), Protection OS integrity Protection PR.PT-1, PR.PT-2, CM-7(3), IA-2(13), MP- verification (MTP) PR.PT-3 7, SI-3(2), SI-3, SI-3(7), SI-7, SI-7(1), SI-7(2), SI- 7(5), SI-7(6) NIST SP 1800-4B: Mobile Device Security 15Cybersecurity NIST SP 800-53 Rev4 Technology Use Product Framework Controls Subcategory Mobile Device Provides remote iPhone 6 (iOS DE.AE-1, PR.AC-1, AC-3, AC-3(5), AC-6(4), access to 8.3), Motorola PR.AC-3, PR.AC-4, AC-7, AC-7(2), AC-19(5), organizational Nexus 6 PR.AC-5, PR.DS-1, CM-2, CM-5(3), IA-5, IA- T services and (Android 5.1), PR.DS-2, PR.DS-3, 6, MP-5(4), MP-6, MP- h si data Nokia Lumia PR.DS-5, PR.DS-6, 6(8), SA-13, SC-3, SC- p u 830 (Windows PR.IP-1, PR.IP-6, 7(21), SC-3(1), SC-8, SC- b cil Phone 8.1) PR.PT-2, PR.PT-3 8(1), SC-11, SC-12, SC- a oit 13, SC-17, SC-28, SC- n si 28(1), SC-3(1), SC-39, a SC-39(1), SC-8(1), SI-7, v alia SI-7(1), SI-7(6), SI-7(9), b SI-7(10), SI-7(12) el r f Secure Protects the Transport PR.DS-2, PR.DS-5 SC-8, SC-8(1), SC-13 e o e communications confidentiality Layer Security c f protocol and integrity of (TLS) h a data r g e communicated f or between end m points h : tt E-mail, contacts, Provides core Microsoft PR.AC-1, PR.DS-2, IA-6, SC-8, SC-8(1), SC- p /:s and calendar business Outlook PR.DS-5 13 / d application productivity Application o o.i MDM Agent Client Microsoft DE.CM-3, ID.GV-3, AC-3, AC-4, AC-19, CM- r g / application with Company PR.AC-3, PR.AC-4, 2, CM-5, CM-6, CM-7(4), 1 0 6. administrative Portal PR.AC-5, PR.DS-5, CM-7(5), CM-11, CM- 0 2 control that Application PR.IP-1, PR.IP-6 11(1), IA-6, SC-7(21), 8 / enforces MDM SC-8, SC-8(1), SI-7(1), SI- N SI policies on the 7(2), SI-7(6) T S. device P 1. 8 Digital Used for Symantec PR.DS-5 SC-13 0 0 Certificate authentication Digital - 4 . of end points in Certificate federated services The following mobile devices were used throughout this project: NIST SP 1800-4B: Mobile Device Security 16▪ Dell Venue 8 Pro (Intel) ▪ Lenovo Miix 2 (Intel) ▪ Nexus 6 ▪ Nokia Lumina 830 ▪ iPhone 6 T h si ▪ Samsung Galaxy S5 p u b cil 4 Architecture a t oi n This section documents the functional and network architectures of both the cloud and hybrid builds. a si Before continuing, it is useful to describe a notional EMM deployment. An EMM can consist of multiple v a services, including MDM, mobile application management (MAM), and other mobile computing services. ali b Enterprises use EMMs to define a set of policies, push those policies to a mobile device, and then el f enforce these policies on a mobile device via an enforcement mechanism on the device (e.g., OS, mobile r e e application). Before policies can be pushed to a given device, an enterprise must enroll that device into o f the management services. Once enrolled, policies, such as the requirement to use an eight-digit c h a passcode, are defined and then pushed to the device via a secure communications channel. These r g e processes and technologies enable users to work inside and outside the enterprise network with a f or securely configured mobile device with the following functional and security capabilities: m h : ▪ Device encryption: cryptographic protection of all or portions of a device’s data storage locations t t p to prevent unauthorized disclosure of enterprise data s /: / d ▪ Application-level encryption: an alternative or additional layer of cryptographic protection o o.i applied only to application data to prevent unauthorized disclosure when device encryption is gr either undesirable or has been defeated / 1 6.0 ▪ Trusted key storage: protected locations in software, firmware, or hardware in which long-term 20 cryptographic keys or secrets are safeguarded from unauthorized disclosure or modification 8 / N ▪ Protected communications: strong cryptographic protection of data transmitted over untrusted SI T networks to mitigate unauthorized disclosure or modification S. P 1. ▪ Remote wipe: action that prevents the unauthorized access of data stored on a lost or stolen 8 0 device by rendering data recovery techniques infeasible 0 - 4 . ▪ Selective wipe: remote wipe that affects only enterprise data, leaving personal data intact; also occurs automatically as a consequence of a device user unenrolling their device from enterprise management ▪ Automatic wipe: action that reactively wipes all device data in response to multiple subsequent failed attempts to unlock a locked device, which may occur before the loss or theft of a mobile device is discovered ▪ Hardware security modules: embedded or removable tamper-resistant hardware used to perform cryptographic operations and provide secure storage to protect security operations or data from unauthorized access or modification NIST SP 1800-4B: Mobile Device Security 17▪ Sandboxing: OS or application-level virtualization, isolation, and integrity mechanisms utilizing multiple protection, isolation, and integrity capabilities to achieve higher levels of overall process isolation ▪ Memory isolation: OS-enforced separation of memory spaces allocated to running processes to protect their integrity, which secondarily protects the confidentiality, integrity, and availability of data in process T h ▪ Trusted execution: protection of security processes within an isolated and trustworthy si p environment using distinct memory spaces and controlled interfaces to provide higher levels of u b isolation than memory isolation alone cil a t ▪ Device resource management: ability to selectively disable unused or unnecessary peripherals to oi n prevent their abuse and preserve other resources (e.g., battery life, data limits) si va ▪ Application whitelisting/blacklisting: allowing or disallowing the use of applications based on a a ali prespecified list to prevent the execution of malicious, vulnerable, or flawed applications b el ▪ Boot validation: integrity checks on the content of boot files and the execution of boot processes f r e to verify the OS has been launched into a known-good and trustworthy state e o f ▪ Application verification: integrity checks on application installation packages and validation of c ah the digital signature to verify that applications come from a trusted source and have not been r g modified prior to installation e f r o ▪ Verified application and OS updates: application verification techniques, as above, are applied to m h : application and OS update packages prior to execution t t p ▪ Mobile malware detection: identification of malicious software on mobile platforms to facilitate s /: remediation and limit their potential to cause harm / d o o.i ▪ Inventory of mobile device hardware and software: maintain version information for the gr hardware, firmware, OS, and installed applications on devices in order to respond effectively to / 01 discovered vulnerabilities 6. 0 ▪ Asset management: identify, configure, and maintain the security configuration of devices, 2 8 / components, software, and services residing on a network to reduce the potential for N SI compromise T S. P ▪ Compliance checks: determine a device’s level of compliance with mandated security policies to 1. 8 prevent granting access to improperly configured and vulnerable devices 0 0 - 4 ▪ Root and jailbreak detection: verification that the security architecture for a mobile device has . not been compromised to prevent granting access to untrustworthy devices ▪ Auditing and logging: capture and store security events for devices, including enrollment, failed compliance checks, administrative actions, and unenrollment ▪ Canned reports and ad hoc queries: use preconfigured reports or active searches or filters on security logs to manage incidents and audit compliance ▪ Local authentication of user to device: require a user to provide a personal identification number (PIN), password, cryptographic token, or other authentication mechanism to prevent granting unauthorized access to sensitive device functionality or accessible data ▪ Local user authentication to applications: as above, but specific to an application NIST SP 1800-4B: Mobile Device Security 18▪ Remote user authentication: as above, but for networked applications that require successful authentication to a remote service before granting full access to its functionality and data ▪ Device provisioning and enrollment: identification and association of specific mobile devices with organizational user accounts to ensure that remote access is granted only to authorized users using approved devices ▪ Custom privacy statement: inform users about the implications to privacy or changes to device T h functionality as a result of accepting organizational management of their personal device or si p remotely accessing enterprise resources u b cil This project installs, configures, and integrates two distinct MDMs from Microsoft: Office 365 (included a t in most Office 365 deployments) and Microsoft Intune. These MDMs offer varying levels of functionality oi n si — security and otherwise. a av The integration of the various technologies within these builds would be extremely difficult without the ali use of standards and best practices. The following standards are crucial to a successful implementation: b el r f ▪ NIST SP 800-124 Rev 1: Guidelines for Managing the Security of Mobile Devices in the Enterprise e e o  f hc ▪ NIST SP 800-164 (Draft): Guidelines on Hardware-Rooted Security in Mobile Devices  a r eg ▪ NIST SP 800-147: BIOS Protection Guidelines  f r o ▪ NIST SP 800-155: BIOS Integrity Measurement Guidelines  m h : ▪ NIST SP 800-88 Rev 1: Guidelines for Media Sanitization  t t p /:s ▪ NIST SP 800-163: Vetting the Security of Mobile Applications  / d o ▪ NSA: Mobility Capability Package 2.3  o.i gr ▪ Department of Defense Commercial Mobile Device Implementation Plan  / 1 6.0 ▪ CIO Council: Government Mobile and Wireless Security Baseline  0 82 ▪ GSA Managed Mobility Program Request for Technical Capabilities  / N SI ▪ NIAP: Protection Profile for Mobile Device Management Version 1.1  T S. P ▪ NIAP: Protection Profile for Mobile Device Fundamentals Version 2.0  1. 8 0 ▪ NIAP: Extended Package for Mobile Device Management Agents Version 2.0  0 - .4 ▪ GlobalPlatform: specifications for Secure Element and Trusted Execution Environment ,  ▪ Trusted Computing Group: specifications for Trusted Platform Module  Section 4.1, Cloud Build: Architecture Description and Section 4.2, Hybrid Build: Architecture Description describe the cloud and hybrid architectures, respectively, as well as their benefits and security features. 4.1 Cloud Build: Architecture Description The cloud build is intended to assist organizations wanting to leverage mobile devices and manage these devices via the cloud. These organizations may include entities needing to stand up mobile deployments with minimal effort and entities with established enterprise mobile deployments wanting to leverage NIST SP 1800-4B: Mobile Device Security 19the benefits of cloud computing. This build can be quickly deployed within enterprises without an internal AD server. Although this build uses the MDM system included with Office 365, an organization could choose to leverage Intune instead in this instance. Office 365 was chosen to diversify the MDMs used within this project. This solution can be easily configured and operated as a cloud service to onboard personally or enterprise-owned mobile devices into the EMM, allowing users to access enterprise resources and T h si enterprise managers to push policies to mobile devices. Office 365 allows for a variety of policies to be p pushed to the device (detailed in Appendix C) but offers a significantly reduced feature set when u b cil compared with Microsoft Intune. a t oi Figure 4-1 provides the overall architecture of the cloud build. n si a Figure 4-1 Cloud Build Architecture v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 Mobile devices communicate with Office 365 over a public communications network, which then 0 - 4 accesses Microsoft’s mobile applications such as Word and Excel. System administrators manage devices . via the Office 365 admin center. In order to make full use of cloud services, a globally recognized commercial domain is required. For test purposes, the NCCoE acquired cmdsbb.org (CMDSBB is an acronym for cloud mobile device security building block) from a commercial domain registrar and used it throughout this guide. The exact method for DNS acquisition and management is unique for each registrar and enterprise and is therefore unable to be addressed by this guide. 4.1.1 Cloud Architecture Benefits The security benefits of a cloud architecture will depend heavily on the service provider that is chosen. NIST SP 800-146 states that in a public cloud scenario, “the details of provider system operation are usually considered proprietary information and are not divulged to consumers. … Consequently, NIST SP 1800-4B: Mobile Device Security 20consumers do not (at the time of this writing) have a guaranteed way to monitor or authorize access to their resources in the cloud” . However, organizations that lack security subject matter experts can realize a benefit because “clouds may be able to improve on some security update and response issues.” We recommend that readers consider the recommendations in Section 9.3 of NIST SP 800-146  before choosing a cloud service provider. Functionally, the cloud architecture benefits from the rapid development of features — a trait found in T h si modern web-based services. The MDM service used within the cloud build is able to keep pace with the p quick-changing landscape of mobile devices. For example, mobile device vendors can add device u b cil management features as they iterate through OS versions. These features can be immediately available a t through the cloud service rather than delayed by a traditional on-premises software upgrade cycle. oi n si Another benefit of the cloud architecture is the ability to manage mobile devices from any physical a v location. Our cloud MDM portal is available to administrators through a web interface; the only a ali requirements are a modern web browser and an internet connection. This allows administrators to take b el action while outside the boundaries of the enterprise network. Further, it reduces reliance on desktop f r e applications that may not be available on all workstations. e o f hc 4.1.2 Cloud Build Security Characteristics a r g e Much of the security of the cloud build relies on the protections provided by the mobile device, the f r o policies implemented by the MDM, and the Microsoft Outlook mobile application installed on the m h : device. The initial selection of the mobile device makes a large difference in the security features tt available due to low-level boot firmware and/or OS integrity checks. Some mobile devices provide some p s /: form of secure boot rooted in hardware or firmware by default, while other devices offer no boot / od integrity at all. Another feature available only on certain mobile devices is secure key storage, which o.i may or may not be rooted in hardware. Organizations may wish to ensure that the devices they support r g / include these desirable hardware/firmware capabilities. 1 0 6. 0 An individual who decides to participate in a managed scenario must download the Microsoft 2 8 Community Portal application and input the required information. Then the device is provisioned into / N SI the EMM, and the default set of policies listed in Appendix C is applied to the device. This includes local T S. authentication to the mobile OS via a lock screen and the encryption capabilities provided by the mobile P 1. OS to protect data on the device. The Outlook application provides an additional layer of application- 8 00 level encryption to email and Outlook application-related data via the Microsoft managed application - .4 policies . The Outlook application uses a TLS 1.2 tunnel to communicate with the Office 365 email, calendaring, and contact services, and does the same for the cloud-based AD service offered by Office 365. The management interface to access the Office 365 EMM and other administrative functions is also protected via a TLS 1.2 tunnel over the internet. Further, if a user is not in compliance with the policies specified in Appendix C, the system administrator is notified. As an additional layer of protection, inclusion of the Lookout for Enterprise application also provides anti-malware protection alongside jailbreak/root detection. NIST SP 1800-4B: Mobile Device Security 214.2 Hybrid Build: Architecture Description The hybrid build leverages the same cloud-based services from the cloud build but integrates them into the network in a different manner. It includes a combination of enterprise assets likely to be present within an organization’s existing network, including EMM capabilities, and adds cloud services for MDM. This build might be a starting point for an organization that has significant investment in or dependence on an internal AD server. The cornerstone of the hybrid build is the existing AD server housing user data T h si and associated credentials. Figure 4-2 depicts the high-level hybrid build architecture. p u b Figure 4-2 Hybrid Build Architecture cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 22Table 4-1 Legend for Hybrid Build Architecture Diagram Acronym Term AD DS Active Directory Domain Services T AD FS Active Directory Federation Services h si p DMZ Demilitarized Zone u b cil a t oi Microsoft Intune functions as the EMM for this solution, which can be easily configured and operated as n si a cloud service to onboard personally or enterprise-owned mobile devices into the EMM. This allows a v users to access enterprise resources and allows those involved with enterprise management to push a ali policies to mobile devices. b el f The hybrid build contains the following elements: r e e o ▪ In the cloud: f c h a • Intune provides MDM, MAM, and end point management capabilities. Devices outside the r g e enterprise firewall can connect to Intune for configuration management and monitoring f r mo • Office 365 synchronizes with AD Domain Services (DS) 2012R2 to provide email, contacts, h : and calendaring services. It also has its own user database, which can be selectively synced t t with AD DS via the Azure AD Sync Tool p s /: / • The Lookout Security Platform provides the back end to the threat protection mobile d o o.i application to identify risks on the device r g ▪ In the enterprise intranet: / 1 0 6. • AD DS stores directory data and manages communication between users and domains, 0 2 including user log-on processes, authentication, and directory searches. It is used to 8 N/ centrally manage servers and users, and information is synchronized with cloud services TSI https://technet.microsoft.com/en-us/library/Cc770946(v=WS.10).aspx S. P 1. • AD Federation Services (FS) 2012R2 is a standards-based service that allows the secure 8 0 sharing of AD DS identity information between trusted business partners across an 0 - extranet. https://msdn.microsoft.com/en-us/library/Bb897402.aspx 4 . • Azure AD Sync Services is used to mirror Azure AD and Office 365 with a single-forest or multiforest on-premises AD. It does not require access to the Azure AD tenant that is created with the associated Office 365 subscription. Systems Center Configuration Manager (SCCM) provides unified management across on-premises, service provider, and Azure environments for both Windows computers and mobile devices. http://www.microsoft.com/en-us/server-cloud/products/system-center-2012-r2/ ▪ In the enterprise demilitarized zone: • The Web Application Proxy (WAP) provides reverse proxy functionality for AD FS to allow access to users on any device from outside the enterprise network. It acts as a security NIST SP 1800-4B: Mobile Device Security 23barrier by not allowing direct access into the AD environment from the internet and is not joined to the domain itself ▪ From the internet: • Mobile applications (Lookout MTP, Intune MDM client, Outlook) deployed to the device that support the functional and security characteristics of this build T Additional components not pictured: h si p Making full use of cloud services requires a globally recognized commercial domain. For our test u b cil purposes, we acquired hmdsbb.org from a commercial domain registrar and used it throughout this a t practice guide. The exact method for DNS management will be unique for each registrar and oi n organization and is therefore unable to be addressed by this guide. si a v The build team generated a certificate from the Symantec Secure Site Pro Secure Sockets Layer a ali Certificates service to fulfill prerequisite requirements from AD FS to federate with Office 365. b el f A router/firewall is used to simulate various network and security domains within an organization. r e e o c f 4.2.1 Hybrid Architecture Benefits h a gr The hybrid architecture leverages the flexibility of cloud services discussed in Section 4.1 while e f benefiting from security enhancements by using on-premises services. First, we made the architectural r o m decision to use identity federation services that are realized through AD FS and Microsoftʼs AD h : Authentication Library (ADAL) service. This build leverages federation when the device owner is required t t p to authenticate to Intune and Office 365 cloud services. This allows an organization to act as an identity s /: / provider — device owner passwords are shared only with on-premises systems and never with third- d o o.i party cloud services. r g / The NCCoE made the architectural decision in this build to use a WAP. The WAP serves as a front end for 1 0 6. requests to the on-premises AD FS system. This setup has the security benefit of adding a layer of 0 2 defense by isolating front-end requests from the corresponding back-end requests to the protected 8 / N federation service. This is important because the AD FS holds sensitive cryptographic keys such as the SI T token-signing and service identity key. In this way, the AD FS system is protected within the enterprise S. P network boundaries and not exposed to internet-facing networks . 1. 8 0 0 Functionally, the architecture provides the benefit of managing enterprise identities within the - 4 . traditional workflow of an on-premises AD system. Many organizations utilize identity management systems that require on-premises AD services but would also like to leverage cloud services without having two disparate identity systems. To solve this issue, we made the architectural decision to add an on-premises system dedicated to syncing identities between the on-premises AD and the cloud-based Office 365 environment. SCCM is another instance of how our hybrid architecture benefits from on-premises and cloud services. This build could leverage traditional workstation configuration capabilities while enjoying the benefits of using a cloud MDM service. This is possible because the on-premises SCCM system is integrated with the Intune cloud service. Therefore, administrators can continue their normal workflow from the SCCM console and have a complete picture of enterprise assets from a single view. NIST SP 1800-4B: Mobile Device Security 244.2.2 Hybrid Build Security Characteristics The security characteristics of the hybrid build closely resemble the characteristics in Section 4.1.2, Cloud Build Security Characteristics. The Outlook mobile application uses a TLS tunnel to communicate with the Office 365 email, calendaring, and contact services that live in the cloud. However, in the hybrid build, mobile traffic is directed through a proxy before communicating with internal enterprise services when interacting with the enterprise for authentication services. Additionally, on-premises systems T h si communicate with Microsoft cloud services via a TLS tunnel. This includes the SCCM system and the AD up Sync systems. b cil ta 4.3 Security Characteristics and Capabilities oi n si The security characteristics and capabilities presented in Appendix C are based on the principles a v identified in NIST SP 800-164 and NIST SP 800-124. Security characteristics are the goals that this build is a ali trying to achieve, while security capabilities are the individual mechanisms to accomplish these goals. A b el goal would be to implement the identified characteristics and capabilities with verifiable integrity via f r e continued assertions that the device has not been compromised. This would ensure that key firmware e o or OS files have not been tampered with, that the device has not been rooted or jailbroken, and that the f c h device’s security policies are verified as those being issued by the enterprise. Therefore, these a r g characteristics and capabilities should be implemented at the lowest possible level; for instance, e rf firmware is preferred to an application layer service. o m h : The original problem definition document  defines a superset of security characteristics and t pt capabilities. This project does not implement every item within that document. What is specifically s /: achieved in the context of this project is detailed in Appendix C, along with implementation notes for / d o the build. Finally, note that many of the terms used below are not standardized throughout industry. o.i Therefore, the descriptions provided alongside the capabilities reflect the term’s meaning in the context r g 1/ of this project. 0 6. 0 2 4.3.1 Default Policies 8 / N SI Multiple standards espouse management policies that should be applied to user devices. Specifically, T S. NIST SP 800-124 Revision 1 and the NIAP protection profile for MDMs suggest desirable features and P 1. functionality for an enterprise MDM policy. Table 4-2 shows the default policy used in this project and 8 00 pushed to devices within this building block, fulfilling our goals of a reasonable balance between security - .4 and user functionality. Suggested policies such as turning off Bluetooth and Wi-Fi, while reducing the threat surface to which a mobile device is exposed, remove important functionality desired by users. Some of these policies may be accomplished by the underlying mobile OS (e.g., Android, iOS, Windows Phone) while others require application-level features, and still others are accomplished via the MDM. Although the following policies were used for the building block, organizations need to perform their own assessments to understand the risks associated with their systems. Guidance for performing this assessment and selecting appropriate policies can be found within NIST 800-124 r1 . NIST SP 1800-4B: Mobile Device Security 25Table 4-2 SP 800-124 Mapping to Security Characteristic NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Automatically Compliance Company Portal, Intune, • Intune and Office 365 MDM T h monitor device checks and Office 365 MDM si periodically query the p configuration and automatically monitor u Company Portal MDM agent b detect policy managed devices for cil for a deviceʼs current level a violations policy compliance t of compliance oi n si • The Company Portal MDM a agent monitors the device v a ali for policy compliance and b enforces policy settings on el f local device functionality r e e (e.g., access to location o f services or removable c h a media) r g e f Automatically report SCCM can log the policy Auditing and When configuring an r o m when policy violations for subsequent logging MDM policy in SCCM, h : violations occur, reporting and review, which setting noncompliance t t such as changes can be optionally sent to severity for reports to the p s /: from the approved Event Viewer to enable least information will log / d security additional monitoring and violations of any included o o.i configuration reporting functionality settings in Configuration r /g baseline Manager.  1 0 6. Automatically take Intune and SCCM offer policy Asset Most MDM policy sections 0 2 action in response to settings that authorize the management configurable by 8 N/ policy violations Company Portal MDM agent Intune/SCCM have a SI when possible and to attempt to restore non- remediate noncompliant T S. appropriate compliance settings back to a settings option. Note that P 1. compliant state automatic remediation for 8 0 0 any given policy setting - 4 may not be supported on . all OS versions NIST SP 1800-4B: Mobile Device Security 26NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Limit or prevent Root and Conditional access is set • Intune and Office 365 MDM access to enterprise jailbreak through SCCM Exchange can block access to services based on detection connector. Mobile users T enterprise resources when h si whether the device the device is detected as are not allowed to access p has been enterprise email services u being jailbroken or rooted b cil rooted/jailbroken until the target device is a • Intune and SCCM via Intune compliant (i.e., phone is t noi have MAM policy settings encrypted and not si that block user access to rooted/jailbroken) a v managed applications when a ali the device is not compliant b el with MDM policy f r ee • The Conditional Access o Extension for SCCM enables f c h blocking access to an on- a gr premises Exchange server, e f Exchange Online, and r o m SharePoint online for h : noncompliant devices t t p s Limit or prevent Intune/SCCM must be Device When creating an MDM /: / d access to enterprise explicitly configured to allow provisioning and policy using SCCM, the o o.i services based on enrollment of iOS and enrollment Platform Applicability step gr the mobile deviceʼs Android devices. Each MDM of the Create / 1 0 OS version policy created using Configuration Item Wizard 06. Intune/SCCM can apply to a will list policy settings that 2 8 different set of specific OS are not supported by / N versions selected OS versions SI T S. Limit or prevent Intune enables a device Device P 1. access to enterprise enrollment manager to enroll provisioning and 8 0 services based on usersʼ devices on their behalf, enrollment 0 - 4 the mobile deviceʼs allowing an organization to . vendor/brand or manually control which model models of mobile devices will be enrolled Limit or prevent N/A N/A access to enterprise services based on the MDM software client version (if applicable) NIST SP 1800-4B: Mobile Device Security 27NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Strongly encrypt Each of the mobile devices Protected The Company Portal and data and OSes used in the build are communications Microsoft Outlook communications capable of secure applications initiate T h si between the mobile communications that use TLS secure communications p device and the with Microsoft Intune and u b cil organization Office 365 using TLS by a default t oi n Strongly encrypt Device Device encryption si • Intune/SCCM and Office 365 va stored data on built- MDM offer a policy setting encryption implementation varies a in storage. among device ali requiring that built-in device b manufacturers. Encrypting el storage be encrypted f the application data r ee • Intune/SCCM offer a MAM setting may not provide o policy setting enforcing additional cryptographic f hc encryption of application protection over full-device a gr data encryption. However, e f when device encryption is r o m undesirable, this setting is h : an alternative t t p s Strongly encrypt Intune/SCCM offer a policy N/A If removable storage is not /: / stored data on setting to force encryption of a necessary feature and d o removable storage removable media, which is encryption of removable o.i r advertised to work with storage is not supported, g / 1 Windows Phone 8.1 consider disabling the use 0 6. of removable storage 0 2 media 8 / N Wipe the device (to Intune/SCCM and Office 365 Remote wipe Administrators are able to SI T scrub its stored MDM can trigger a full or fully wipe devices by S. P data) before selective wipe of data selecting the device from 1. 8 reissuing it to remotely the SCCM console 0 0 - another user, 4 . retiring the device, etc. NIST SP 1800-4B: Mobile Device Security 28NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Remotely wipe the Intune/SCCM and Office 365 Remote wipe Administrators are able to device (to scrub its MDM can trigger a full or selectively or fully wipe stored data) if it is selective wipe of data devices by choosing the T h si suspected that the remotely device from the SCCM p device has been lost, console u b cil stolen, or has a otherwise fallen into t oi n untrusted hands and si is at risk of having its a v data recovered by a ali an untrusted party. b el f A device often can Intune/SCCM and Office 365 Device wipe r ee also be configured offer a policy setting that after o to wipe itself after a activates this feature and sets unsuccessful f c h certain number of the number of allowed unlock unlock attempts a gr incorrect attempts e f authentication r o m attempts th : Require a device Intune/SCCM and Office 365 Local This setting is a t p s unlock code be set offer a policy setting that authentication prerequisite for device /: / before authorizing requires a managed device to of user to device encryption d o access to the have a device unlock code set o.i r organization’s g / 1 resources 0 6. 0 Require basic • Intune/SCCM and Office 365 N/A Longer or more complex 2 8 parameters for device unlock codes / have a policy setting that N password strength increase the cryptographic SI requires that a device T strength of derived device S. unlock code possesses a P encryption key and are 1. minimum length 8 more resistant to 0 0 - • Intune/SCCM and Office 365 discovery (e.g., shoulder 4 . have a policy setting that surfing attacks) requires that the device unlock code meets certain complexity requirements NIST SP 1800-4B: Mobile Device Security 29NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Optionally require Intune/SCCM offer a MAM Local other authentication policy setting that forces a authentication (e.g., token-based four-digit PIN or corporate of user to T h si authentication, credentials to be entered applications p network-based before Company Portal will u b cil device allow managed applications a authentication, to be accessed locally by the t oi n domain device user si authentication) a v before accessing the a ali organizationʼs b el resources f r ee Require a limit on Intune/SCCM offer a MAM N/A o the number of policy setting that sets a limit f c h retries permitted on the maximum number of a gr without negative managed application e f consequences (e.g., authentication attempts (via r o m locking out the PIN or corporate credentials) h : account, wiping the before the PIN will be reset. t pt device) s /: / If device account Intune/SCCM have a policy N/A d o lockout is enabled or setting that allows a password o.i r the device reset PIN to be synchronized g / 1 password/passcode with a Microsoft Exchange 0 6. is forgotten, an server; advertised for 0 2 administrator can Windows devices only 8 / N reset this remotely TSI to restore access to PS. the device 1. 8 Have the device Intune/SCCM and Office 365 N/A If an attacker has access 0 0 - automatically lock have a policy setting that to an unlocked device, 4 . itself after it is idle requires that the device they likewise will have for a period (e.g., automatically locks after a access to any data not five minutes) specified number of minutes protected by additional of inactivity authentication NIST SP 1800-4B: Mobile Device Security 30NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Under the direction Intune/SCCM can issue a N/A Administrators are able to of an administrator, remote lock instruction to remotely lock devices remotely lock the managed devices from the SCCM console T h si device if it is p suspected that the u b cil device has been left a in an unlocked state t oi n in an unsecured si location a v a Restrict the use of Intune/SCCM offer a series of Device resource As support for this feature ali b OS and application policy settings applicable to management varies across OS versions, el f synchronization iOS and Samsung Android and restriction of r ee services (e.g., local with KNOX that block synchronization can o device synchronization of various significantly impact device f c h synchronization, kinds of content (photos, files, functionality, we did not a gr remote application backups) with choose to block e f synchronization either locally connected synchronization. Consider r o m services, and computers or cloud services using MAM policies to h : websites) restrict the data-sharing t pt functions accessible to s /: managed applications / d o Verify digital Intune/SCCM offer MDM Application Each of the mobile device o.i r signatures on policy settings that block verification, OSes used supports g / 1 applications to installation of unsigned verified verification of digital 0 6. ensure that only applications or files application, and signatures for applications 0 2 applications from OS updates and application and OS 8 / N trusted entities are updates TSI installed on the PS. device and that code 81. has not been 0 0 modified - 4 . Query the current Intune/SCCM and Office 365 Inventory of version of the MDM automatically query mobile device hardware model of and record device hardware hardware, the device and OS versions for enrolled firmware, and devices. Additionally, SCCM software incorporates this information with its centralized asset inventory NIST SP 1800-4B: Mobile Device Security 31NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Alert the Intune/SCCM offer alert-level Auditing and When configuring an administrator to settings for each category of logging, MDM policy in SCCM, if security events policy settings (e.g., compliance the noncompliance T h si encryption or cloud); detected checks severity for reports setting p violations of any setting for a given policy section u b cil within that group. is set to critical with a Additionally, by default, event, then in addition to t oi n deployment of a configuration logging by Configuration si baseline is configured to Manager, a Windows a v automatically send alerts to event will be generated, a ali when overall policy enabling additional b el compliance falls below a notification features by f er specified compliance using Event Viewer e o threshold (90% by default) f c h Import keys/secrets Trusted key This is accomplished at a • Intune/SCCM allow digital egr into the secure key certificates to be storage the OS level of iOS, f storage locations Android, and Windows r automatically installed onto o m Phone 8.1. Note: Use of mobile devices upon th : enrollment OS-managed secure key pt storage by any given s /: • iOS 8.3, Android 5.3, and application is optional / d Windows Phone 8.1 allow o o.i application to store r g cryptographic keys/secrets / 1 0 in OS-managed secure key 6. 0 storage locations (e.g., 2 8 Android Keychain) / N SI T Restrict which Intune and SCCM offer a Whitelisting/ Note that blocking the S. P application stores policy setting that restricts blacklisting installation of third-party 1. 8 may be used enrolled devices to installing applications is currently 0 0 applications from the official incompatible with the use - 4 . application store for its OS. of an organization- Additionally, Intune/SCCM managed application store can block user access to the official application store Restrict which Intune/SCCM offer policy Whitelisting/ applications may be settings to establish both blacklisting installed through whitelists and blacklists of whitelisting applications; lists are specific (preferable) or to each mobile OS blacklisting NIST SP 1800-4B: Mobile Device Security 32NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Restrict the Device resource • Intune/SCCM offer policy permissions (e.g., management, settings that can block use camera access, data protection T of certain specific device h si location access) peripherals or OS p assigned to each u functionality for all b cil application applications (e.g., camera, a oit location services) n si • Intune/SCCM offer MAM a v policy settings that can a ali block access to specific OS- b el provided functions (e.g., f r cut-and-paste, data transfer e e o between applications, or f c screen capture) for h a managed iOS or Android r g e applications f r o m Install, update, and Intune has MAM functionality N/A h : remove applications that allows it to automatically t t p install, update (may require s /: manual deployment), and / d o remove applications from o.i managed devices r g / 1 Safeguard the Access to the policies and N/A The SCCM built-in role of 0 6. mechanisms used to software functions that will Application Deployment 0 82 install, update, or install, upgrade, or remove Manager can be used to / N remove applications applications from managed manage which SI T devices is managed by a role- administrators can install S. P based access management and remove applications 1. 8 scheme using AD groups from managed devices 0 0 - Keep a current Intune and SCCM receive Inventory of 4 . inventory of all application information from mobile device applications Company Portal; the installed hardware, installed on each applications with version firmware, and device information are inventoried software for each device NIST SP 1800-4B: Mobile Device Security 33NIST SP 800-124 NIST SP 1800-4 rev1 EMM/MDM Related Technical Functions Security Note Security Services Characteristic Distribute the Intune and SCCM have MAM N/A At the time of this organization’s functionality that allows an document, no mobile OS applications from a organization to upload differentiates between an T h si dedicated mobile internally developed and organizationʼs private p application store publicly available applications application store and any u b cil to a private application store other third-party a accessible only to managed (unofficial) application t oi n devices store. If a private si application store is used a v without an explicit a ali whitelist of applications, b el those from unofficial f er application stores could e o also be downloaded f c h a r 5 Outcome g e f r o This section discusses the building block from the perspective of the user and the system administrator. m h : We define system administrator as a person within the organization who has elevated privileges on the t pt management systems in the build. s /: / d o 5.1 The User’s Experience o.i r g When users access enterprise services on their device, their devices will be enrolled into an EMM. / 1 0 Access to email, contacts, and calendaring services occurs via the Microsoft Outlook mobile application. 6. 0 Device enrollment is accomplished by downloading and installing the Microsoft Company Portal 2 8 / application, available in the iOS and Android application store. Windows Phone devices have some N SI management capability built into the OS, but they also require the Company Portal application to relay T S. information to the enterprise. The Company Portal application can be downloaded directly onto the P 1. device from the Windows Application Store. 8 0 0 - 4 In general, the specific hardware of a mobile device will make little difference in how information is . presented to the user. Accordingly, boot integrity has little impact on the workflow unless a user needs the capability to modify the mobile OS (e.g., jailbreaking, rooting) or if boot integrity is compromised. Enrolling a mobile device into the EMM causes a number of policies to be applied to it. One of the items most affecting a user’s experience is the case in which a user does not have local authentication on the device because the default EMM policies espoused within Appendix C require authentication to the OS lock screen. The exact complexity of the authentication solution (e.g., PIN, passcode, gesture) is subject to the needs of the enterprise, although NIST SP 800-63-3  provides enterprises with guidance on this topic. The user’s enrollment authentication experience remains largely the same between the cloud and hybrid builds, even though the hybrid build supports identity federation between the enterprise and NIST SP 1800-4B: Mobile Device Security 34Microsoft cloud services. The hybrid build leverages ADAL-based sign-in — which uses a Security Assertion Markup Language-based AD FS identity provider. This allows the user to keep a familiar workflow with the added security benefit of keeping passwords within the enterprise boundary. To receive the Lookout security services, which provide mobile malware protection, users should download the Lookout application from their device’s application store in one of two ways. First, during the EMM enrollment process, users are presented with a direct link to the device’s application store in T h si the Company Portal. Second, the user is sent an invitation to enroll with Lookout through email. There is p no technical control in this build, however, to require the installation of the Lookout application. u b cil Implementers of this build may wish to implement a MAM policy as a means to enforce the installation a t of the Lookout application. oi n si To enroll in the Lookout service, a user will have to supply the application with his or her email address a v and a unique code received via email. The Lookout application generally interacts with users only if a ali there is a security violation on the device. b el r f Figure 5-1, Figure 5-2, and Figure 5-3 present the high-level workflow of device owner enrollment on e e o the Android, iOS, and Windows Phone platforms, respectively. f c h Figure 5-1 Android Workflow a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 35Figure 5-2 iOS Workflow T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 36Figure 5-3 Windows Phone Workflow T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / 5.2 The System Administrator’s Experience N SI T S. The experience of the system administrator will be different based on whether they are using the hybrid P 1. or cloud builds, mostly due to the type and granularity of policies available via the EMM interfaces. 8 0 Installation, configuration, and deployment of the management systems are relatively simple if an 0 - 4 organization decides to adopt the cloud-based EMM services, where setup can be accomplished in less . than a few hours. The installation of the EMM and associated services on premises is significantly more complex, with installation time estimated in hours at least. Defining EMM policies within the web interface of the EMMs is relatively simple, as is distribution to mobile devices. Provisioning and de-provisioning email, contacts, and calendaring services on mobile devices is an important capability of this build. The process by which provisioning occurs will differ for the system administrator in the cloud and hybrid scenarios. Because the MDM functions are embedded within Office 365, provisioning mobile devices is quite simple in the cloud scenario. While creating a new user within the Office 365 administrative console, the system administrator has the option to allow the user mobile access. NIST SP 1800-4B: Mobile Device Security 37The complex nature of the hybrid architecture, however, necessitates a slightly more intricate process. The high-level process is as follows: 1. A new enterprise user is created in the on-premises AD. The means by which this happens is outside the scope of this building block; however, many organizations choose to use a third- party identity management system T 2. The user is placed within a specific group within AD that is configured to sync identities. The h p si user is synchronized by the on-premises Azure AD Sync system to the cloud Azure AD service u b cil 3. The on-premises SCCM system detects the new user, who is automatically added to the Intune a t collection. A collection represents a group of users who have mobile devices to be managed oi n si 4. The Windows Intune Connector extension installed on the SCCM system syncs the new user to a av the Intune cloud service ali b el 5. The new user can now enroll in the Intune service by using the Company Portal application f r e e De-provisioning is a simple task for the system administrator in both the cloud and hybrid builds. In the o f cloud build, de-provisioning a user can be as simple as disabling or deleting the user from the Office 365 c h a administrative console. In the hybrid build, the user is removed from the Intune collection on the SCCM r eg system. Implementers should note that de-provisioning actions may not be immediate. They will depend f r on the syncing periodicity configured in the Intune extension. o m h : While Lookout services offer direct integration with selected EMM providers, this build did not use a t t p compatible EMM. As a result, the system operator would not receive predefined alerts (e.g., malware on s //: a device) through the SCCM workflow. The system operator must configure the Lookout administrative d o console to send email alerts to designated personnel when threats are present on user devices. In o.i r practice, the operator would receive an email with a warning of malware on a user’s device. The g / 1 operator would then find the user within SCCM and take appropriate action on the device. Further, in 0 6. this build there is no technical mechanism to enforce the installation and use of Lookout technologies. 0 2 8 An administrator could, however, periodically compare the list of enrolled users in Lookout and the / N EMM. Users who were absent from the Lookout enrollment could be encouraged to download and SI T S. install the application through an out-of-band means. P 1. 8 A step-by-step description of setup, installation, and configuration is available in NIST SP 1800-4C. 0 0 - 4 . 6 Security Characteristic Analysis The purpose of the security characteristic analysis is to understand the extent to which the project meets its objective of demonstrating a method of protecting organizational data while permitting users the freedom to access and process data via mobile devices. In addition, it seeks to understand the security benefits and drawbacks of the example solution. 6.1 Assumptions and Limitations The security characteristic analysis has the following limitations: NIST SP 1800-4B: Mobile Device Security 38▪ It is neither a comprehensive test of all security components nor a red team exercise ▪ It cannot identify all weaknesses ▪ It does not include the lab infrastructure. It is assumed that devices are hardened. Testing these devices would reveal only weaknesses in implementation that would not be relevant to those adopting this reference architecture T h 6.2 Build Testing si p u The evaluation included an analysis of the project to identify weaknesses and discuss mitigations. The b cil focus of this portion of the evaluation was hands-on testing of the laboratory build and examination of a t oi product manuals and documentation. Our objective was to evaluate the example solution and not n si specific products. However, the presence of three primary OSes for mobile devices (Android, iOS, and a v Windows) made complete product independent hands-on testing unrealistic. a ali b Table 6-1 describes the goals of each test case. el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 39Table 6-1 Cybersecurity Framework Subcategory Evaluation Cybersecurity Related NIST SP Test ID Framework Evaluation Objective 800-53 Controls Subcategory Data Protection T 1 PR.DS-1: Data at SC-28 Protection of Data is accessible only to authorized users and h p si rest is protected Information at Rest services. Data is protected during storage and u processing b cil a t 2 PR.DS-2: Data in SC-8 Transmission The confidentiality and integrity of information is oi n transit is Confidentiality and protected while in transit (SC-8) by using a a si protected Integrity cryptographic mechanism. A Federal Information v a SC-13 Processing Standard (FIPS) 140-2-compliant bali Cryptographic mechanism is used to secure data in transit el f Protection r e e Data Isolation o f c 14 PR.DS-5: SC-7 Boundary Monitor and control communications at the h a Protections Protection external boundary of the system and at key r g e against data internal boundaries within the system f r o leaks are m h : implemented t pt Device Integrity s //: 16 PR.DS-6: SI-7 Software, Integrity mechanisms are running to check the d o Integrity- Firmware, and integrity of software and information files o.i r checking Information g / 1 mechanisms are Integrity 0 6. used to verify 0 2 software, 8 N/ firmware, and SI information T PS. integrity 1. 8 17 DE.CM-4: SI-3 Malicious Code Malicious code protection is installed on mobile 0 0 - Malicious code is Protection devices. Anti-malware software (e.g., anti-virus 4 . detected software) is installed 18 DE.CM-5: SC-18 Mobile Code Only mission-appropriate content may be Unauthorized uploaded within the application. The application mobile code is should employ functionality to restrict upload of detected file types to those expressly required for operations (e.g., TIFF, JPEG, and PDF) Monitoring NIST SP 1800-4B: Mobile Device Security 40Cybersecurity Related NIST SP Test ID Framework Evaluation Objective 800-53 Controls Subcategory 20 ID.AM-1: Physical CM-8 Information Mobile devices are inventoried within the SCCM devices and System Component database systems within Inventory T the organization h si are inventoried p u b 21 ID.AM-2: CM-8 Information Software and licensing are inventoried within the acil Software System Component SCCM database t oi platforms and Inventory n si applications a v within the a ali organization are b el inventoried f r e 28 DE.AE-5: IR-5 Incident When alerts exceed the established threshold, e o Incident-alert Monitoring the administrator is notified f c thresholds are h a r established g e f 37 DE.CM-8: RA-5 Vulnerability Scanning mechanisms are implemented and r o m Vulnerability Scanning effective. Vulnerability scanners provide h : scans are comprehensive coverage and employ best t t p performed practices s /: / Identity and Authorization d o o.i 41 PR.AC-1: IA Controls The architecture accounts for multiple user roles r g Identities and with access privileges assigned to each role. / 1 0 credentials are Access controls are documented. 6. 0 managed for 2 8 authorized / N SI devices and users T S. 42 PR.AC-1 AC-2 Account Only enrolled/managed devices can access email, P 1. Management; contacts, and calendaring. Information is 8 00 Identification and available only to authorized devices - .4 Authentication Controls 6.3 Scenarios and Findings One aspect of our security evaluation involved assessing how well the reference design addresses the security characteristics it was intended to support. The NIST Cybersecurity Framework subcategories were used to provide structure to the security assessment by consulting the specific sections of each standard that are cited in reference to a subcategory. The cited sections provide validation points that the example solution would be expected to exhibit. Using the Cybersecurity Framework subcategories as a basis for organizing our analysis allowed us to systematically consider how well the reference design supports the intended security characteristics. NIST SP 1800-4B: Mobile Device Security 41The remainder of this subsection discusses how the reference architecture solution addresses the six desired security characteristics that are listed in Table 3-1 through Table 3-6. 6.3.1 Data Protection We chose to examine the capability of protecting data at rest. The primary means used by this building block to accomplish data protection is encryption. Android, iOS, and Windows Phone devices used as T h part of this build deployed device encryption. The Android devices used dm-crypt, a disk encryption si p subsystem that calls a number of cryptographic libraries. The Android implementation of this has not u b cil been FIPS 140-2 validated, although it uses the same crypto library as the Red Hat Enterprise Linux ta validation. For environments where FIPS 140-2 validation is necessary, organizations could consider oi n using a third-party data and application isolation solution, such as a secure container providing si a application-level encryption. v a ali Our Apple devices use Apple OS X CoreCrypto Kernel Module v5.0. As of 2015, it has received FIPS 140-2 b el level 1 validation on iOS 8.x devices. The Windows phones used in this exercise are FIPS 140-2 f er compliant. The Microsoft Kernel Mode Cryptographic Primitives Library has met FIPS 140-2 compliance e o at level 1 by using a Qualcomm Snapdragon 800 system on a chip. f c h a Finally, the Outlook application provides an additional level of encryption. Microsoft protects the r g e Outlook data via AES-128 encryption in cipher block chaining mode utilizing Android’s cryptography f r o libraries. The iOS application-level encryption was not evaluated as Microsoft indicated that information m h : is encrypted via the OS cryptographic engine. t t p /:s 6.3.2 Data Isolation / d o o.i When a device is utilized for organizational and personal activities, the ability to isolate data is essential. gr We inspected the sandboxing capability of devices and found that each of the OSes in use offers native / 1 isolation functions. Android, iOS, and Windows run applications in a sandbox that prevents a third-party 0 06. application from accessing, gathering, or modifying information from other applications. While this is a 2 8 valuable security feature, it does not replace the need to educate device users on the potential dangers / N SI of downloading unknown and untrusted applications. T S. P 1. 6.3.3 Device Integrity 8 0 0 Each of the mobile platforms has integrity-checking mechanisms. We examined the native file integrity - 4 . mechanisms as well as malicious code protection. Each platform requires application authors to digitally sign applications before the applications are available for users. The integrity-checking mechanism does not ensure that the application itself is secure or free of malware. To protect devices from malware, the MDS building block specifies that anti-virus software be installed on mobile devices and that the configuration “allow unknown sources” is not enabled. The build restricts the ability to download file types via email by enabling the file attachment filter in Office 365. We verified this by disallowing PDF file types. A user then attempted to send an email with a PDF file attached. The intended recipient was notified that an email addressed to them was blocked according to policy. NIST SP 1800-4B: Mobile Device Security 426.3.4 Monitoring Our examination of security monitoring provided evidence of basic monitoring and scanning being performed. Devices enrolled in the MDM tool were displayed within the configuration management system console. This can be used for hardware inventory reporting as the MDM tools have customizable reports. We were able to use software reporting to only a limited degree. Intune provided software reporting only for applications published under the organization’s application store. It did not monitor T h si and conduct an inventory of applications downloaded from other sources such as Google Play. p u b The MDM provides the capability to tailor compliance policy for devices. When a device exceeds the cil a organization-defined threshold for compliance, the administrator receives an alert showing which device t oi is out of compliance. As an additional precaution, an organization may desire to restrict devices from n si downloading outside its own organizational application store if the potential for unknown applications a v exceeds the organization’s risk appetite. a ali b el Finally, the Lookout MTP service provides monitoring of enrolled devices for malware risks on Android r f devices. In this build, the administrator periodically reviewed the status of enrolled devices in the e e o enterprise through the MTP web console. More sophisticated notification systems, however, could be f c developed for larger deployments. h a r g e 6.3.5 Identity and Authorization f r o m Identity and authorization are integrated within the enterprise. The NCCoE needed to verify that only th : users with authorized access via mobile devices were able to exercise that access. Because the lab was t p s built as a Microsoft environment, access control was implemented via AD. Test users were members of a /: / d domain users’ group synchronized through AD FS. We had users who were not members of the o o.i appropriate group attempt to access their email on an enrolled mobile device, and those attempts r g failed. / 1 0 6. We also sought to verify device authorization. We wanted to ensure that only currently enrolled devices 0 2 could access organizational resources. Our verification included devices never enrolled and devices 8 / N previously enrolled. SI T S. Access attempts for devices not enrolled produced the following results: P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 43▪ iOS redirected the user to the organization portal, then directed the user to enroll his or her device. Email was not accessible until the device was enrolled and compliant with the organization’s mobile device policy. ▪ Android attempted to enroll the device with the active sync policy when not managed by Intune. Android would not retrieve email until the device was enrolled in SCCM and compliant with policy. T h ▪ When attempting to access Office 365 services from out-of-compliance devices, users could si p activate the email client on the device but were unable to retrieve email. u b acil 7 Future Build Considerations t oi n si As we expand this work to future builds, our objective is to solicit feedback from the user community a v toward prioritization of additional capabilities and to solicit suggestions from the EMM vendor a ali community on commercial products that provide those capabilities. b el f There is potential for the development and implementation of new MDS architectures under this build. r e e To explore these various architectures, the NCCoE would like to engage with any individual or company o c f with commercially or publicly available technology relevant to MDS. The NCCoE published a Federal h a Register notice (https://www.federalregister.gov/articles/2015/08/14/2015-20040/national- r g e cybersecurity-center-of-excellence-mobile-device-security-building-block) inviting parties to submit f r o a Letter of Interest to express their desire and ability to contribute to this effort. Interested parties m h : would be required to enter into a consortium CRADA partnership. t t p s Some topics of interest for future builds include… /: / d o ▪ sector-specific MDM policy configurations o.i gr ▪ mobile application vetting / 1 0 ▪ baseband integrity 6. 0 2 ▪ containerization technology 8 / N SI ▪ rogue wireless access point detection T PS. ▪ enhanced identity services, such as two-factor authentication, derived personal identity 1. verification (PIV) as demonstrated in NIST Interagency Report 8055, or use of the FIDO Alliance’s 8 0 0 technology - 4 . All interested parties are encouraged to engage the NCCoE with additional ideas and system requirements by reaching out to mobile-nccoe@nist.gov. NIST SP 1800-4B: Mobile Device Security 44Acronyms AD Active Directory ADAL Active Directory Authentication Library AD DS Active Directory Domain Services AD FS Active Directory Federation Services T h si BYOD Bring Your Own Device p u b CAG Consensus Audit Guidelines cil ta CIO Chief Information Officer oi n si DNS Domain Name System a v DoD Department of Defense a ali EMM Enterprise Mobility Management b el f FIPS Federal Information Processing Standard r e e o HTTP Hypertext Transfer Protocol f hc IEC International Electrotechnical Commission a r g ISO International Organization for Standardization e f or IT Information Technology m h : MAM Mobile Application Management t t p MDM Mobile Device Management s /: / d MDS Mobile Device Security o o.i MTP Mobile Threat Protection r g 1/ NCCoE National Cybersecurity Center of Excellence 0 6. NCEP National Cybersecurity Excellence Partnership 0 2 8 NFC Near Field Communication / N SI NIAP National Information Assurance Partnership T S. P NIST National Institute of Standards and Technology 1. 8 0 NSA National Security Agency 0 - 4 NVD National Vulnerability Database . OS Operating System PHA Potentially Harmful Application PIV Personal Identity Verification SCCM Systems Center Configuration Manager NIST SP 1800-4B: Mobile Device Security 45SP Special Publication TEE Trusted Execution Environment TLS Transport Layer Security TPM Trusted Platform Module US-CERT United States Computer Emergency Readiness Team T h WAP Web Application Proxy si p u b cil a t noi si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 46References  Nat ional Cybersecurity Center of Excellence, Mobile Device Security for Enterprises, Sept. 2014. Available: https://www.nccoe.nist.gov/projects/building-blocks/mobile-device- security/enterprise.  M. Souppaya and K. Scarfone, Guidelines for Managing the Security of Mobile Devices in the T Enterprise, National Institute of Standards and Technology (NIST) Special Publication (SP) 800- h p si 124 Revision 1, Gaithersburg, Md., June 2013. Available: bu http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-124r1.pdf. cil a  L. C hen et al., Guidelines on Hardware-Rooted Security in Mobile Devices (Draft), NIST SP 800-164 t oi (Draft), Gaithersburg, Md., Oct. 2012. Available: http://csrc.nist.gov/publications/drafts/800- n si 164/sp800_164_draft.pdf. a av  Nat ional Security Agency, Mobile Access Capability Package 2.0, Aug. 2017. Available: ali https://www.nsa.gov/Portals/70/documents/resources/everyone/csfc/capability- b el f packages/mobile-access-cp.pdf. r ee  Nat ional Information Assurance Partnership (NIAP), Protection Profile for Mobile Device o f Management Version 1.1, March 2014. Available: https://www.niap- c h ccevs.org/MMO/PP/pp_mdm_v1.1.pdf. a r eg  NIA P, Protection Profile for Mobile Device Fundamentals Version 2.0, September 2014. f r https://www.niap-ccevs.org/MMO/PP/pp_md_v2.0.pdf. o m h :  NIA P, Extended Package for Mobile Device Management Agents Version 2.0, Dec. 2014. tt Available: https://www.niap-ccevs.org/MMO/PP/pp_mdm_agent_v2.0.pdf. p s /:  S. B rooks et al., An Introduction to Privacy Engineering and Risk Management in Federal Systems, / d o National Institute of Standards and Technology Internal Report 8062, NIST, Gaithersburg, Md., o.i Jan. 2017. Available: https://doi.org/10.6028/NIST.IR.8062. r g 1/  NIS T, Managing Information Security Risk, NIST SP 800-39 Revision 1, Gaithersburg, Md., Mar. 0 6. 2011. Available: http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800- 0 2 39.pdf. 8 / N  NIS T, Guide for Applying the Risk Management Framework to Federal Information Systems, NIST SI T SP 800-37 Revision 1, Gaithersburg, Md., Feb. 2010. Available: S. P https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-37r1.pdf. 1. 8 0  S. Q uirolgico et al., Vetting the Security of Mobile Applications, NIST SP 800-163, Gaithersburg, 0 - 4 Md., Jan. 2015. Available: http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800- . 163.pdf.  Uni ted States Computer Emergency Readiness Team (US-CERT), Cyber Threats to Mobile Devices, Technical Information Paper-TIP-10-105-01, US-CERT, Apr. 2010. Available: https://www.us- cert.gov/sites/default/files/publications/TIP10-105-01.pdf. NIST SP 1800-4B: Mobile Device Security 47 Fed eral Risk and Authorization Management Program, Program Overview. Available: https://www.fedramp.gov/about/.  G. D elugré, Reverse engineering a Qualcomm baseband, Sogeti/ESEC R&D, 2011. Available: https://events.ccc.de/congress/2011/Fahrplan/attachments/2022_11-ccc-qcombbdbg.pdf.  Glo bal Platform, Introduction to Secure Element. May 2018. Available: https://globalplatform.org/wp-content/uploads/2018/05/Introduction-to-Secure-Element- T h 15May2018.pdf. si p  Glo bal Platform, Introduction to Trusted Execution Environment (TEE) Guide. May 2018. u cilb Available: https://globalplatform.org/wp-content/uploads/2018/05/Introduction-to-Trusted- a Execution-Environment-15May2018.pdf. t oi n  Tru sted Computing Group, TPM Main Specification. Available: si a http://www.trustedcomputinggroup.org/resources/tpm_main_specification. v a ali  NIS T, National Vulnerability Database, Gaithersburg, Md., 2015. Available: http://nvd.nist.gov. b el  NIS T, Framework for Improving Critical Infrastructure Cybersecurity, Version 1.1, Gaithersburg, f r Md., Apr. 16, 2018. Available: https://www.nist.gov/cyberframework. e e o  NIS T, Security and Privacy Controls for Federal Information Systems and Organizations, NIST SP f c 800-53 Revision 4, Gaithersburg, Md., Apr. 2013. Available: h a r http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf. g e f  Inte rnational Organization for Standardization (ISO) and International Electrotechnical r o m Commission (IEC), Information technology — Security techniques — Code of practice for h : information security management, ISO/IEC 27002, 2013. t t p s  Cou ncil on CyberSecurity, The Critical Security Controls for Effective Cyber Defense, Version 6.0, /: / d May 2016. Available: https://www.sans.org/media/critical-security-controls/CSC-5.pdf. o o.i  D. C ooper et.al., BIOS Protection Guidelines, NIST SP 800-147, Gaithersburg, Md., Apr. 2011. r g Available: https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-147.pdf. / 1 0  A. R egenscheid and K. Scarfone, BIOS Integrity Measurement Guidelines (Draft), NIST SP 800-155 6. 0 (Draft), Gaithersburg, Md., Dec. 2011. Available: http://csrc.nist.gov/publications/drafts/800- 2 8 / 155/draft-SP800-155_Dec2011.pdf. N SI  R. K issel et al., Guidelines for Media Sanitization, NIST SP 800-88 Revision 1, Gaithersburg, Md., T PS. Dec. 2014. Available: http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800- 1. 88r1.pdf. 8 0 0  Dep artment of Defense (DoD), DoD Commercial Mobile Device Implementation Plan, Feb. 15, - 4 . 2013. Available: http://archive.defense.gov/news/DoDCMDImplementationPlan.pdf.  U.S . Government Chief Information Officer Council, Government Mobile and Wireless Security Baseline, May 23, 2013. Available: https://s3.amazonaws.com/sitesusa/wp- content/uploads/sites/1151/downloads/2013/05/Federal-Mobile-Security-Baseline.pdf. NIST SP 1800-4B: Mobile Device Security 48 Gen eral Services Administration (GSA), GSA Managed Mobility Program Request for Technical Capabilities, Available: https://www.gsa.gov/cdnstatic/Managed_Mobility_ML%26EM_RFTC_- _FINAL.pdf.  Nat ional Information Assurance Partnership (NIAP), Protection Profile for Mobile Device Management Version 2.0, Dec. 2014. Available: https://www.niap- ccevs.org/MMO/PP/pp_mdm_v2.0.pdf. T h  L. B adger et al., Cloud Computing Synopsis and Recommendations, NIST SP 800-146, si p Gaithersburg, Md., May 2012. Available: http://csrc.nist.gov/publications/nistpubs/800- u b 146/sp800-146.pdf. cil a  Mic rosoft, How to create and assign app protection policies, Microsoft Technet, Nov. 30, 2018. t oi Available: https://technet.microsoft.com/en-us/library/dn878026.aspx. n si a  Mic rosoft, “Office 365 Single Sign-On with AD FS 2.0 whitepaper,” June 2012. Available: v a https://www.microsoft.com/en-us/download/details.aspx?id=28971. ali b  Mic rosoft, Compliance Policies in Configuration Manager, Microsoft Technet, Apr. 7, 2016. el f Available: https://docs.microsoft.com/en-us/previous-versions/system-center/system-center- r e e 2012-R2/mt131417(v=technet.10). o c f  NIS T, Digital Identity Guidelines, NIST SP 800-63-3, Gaithersburg, Md., June 2017. Available: h ra https://pages.nist.gov/800-63-3. g e f  Mic rosoft, Windows Phone 8.1 Security Overview, Apr. 2014. Available: r o m http://download.microsoft.com/download/B/9/A/B9A00269-28D5-4ACA-9E8E- h : E2E722B35A7D/Windows-Phone-8-1-Security-Overview.pdf. t t p  Loo kout, Change to sideloading apps in iOS 9 is a security win. Available: s //: https://blog.lookout.com/blog/2015/09/10/ios-9-sideloading/. d o o.i  The White House, Bring Your Own Device — A Toolkit to Support Federal Agencies Implementing gr Bring Your Own Device (BYOD) Programs, Aug. 23, 2012. Available: / 1 https://obamawhitehouse.archives.gov/digitalgov/bring-your-own-device. 0 6. 0  Goo gle, Help protect against harmful apps with Google Play Protect. Available: 2 8 https://support.google.com/accounts/answer/2812853?hl=en. / N SI  Mic rosoft, Windows Phone Library, Apr. 2014. Available: https://technet.microsoft.com/en- T PS. us/windows/dn771706.aspx. 1. 8  NIS T, Best Practices for Privileged User PIV Authentication, NIST Cybersecurity White Paper, 0 0 Gaithersburg, Md., Apr. 2016. Available: http://csrc.nist.gov/publications/papers/2016/best- - 4 . practices-privileged-user-piv-authentication.pdf. NIST SP 1800-4B: Mobile Device Security 49Security Characteristics and Capabilities T h si Security Security Capability and p Implementation Note Example Mitigated Threats u Characteristic Capability Description b cil a Data Device encryption: Operating system (OS)-level capability Unauthorized access to corporate data t oi Protection cryptographic protection provided by each mobile OS, often a stored on a locked lost/stolen mobile n si of all or portions of a combination of full disk encryption and file- device a v deviceʼs data storage level encryption a ali locations — primarily b el flash memory locations f r e Data Application-level Due to variations in implementation of Unauthorized access to corporate data e o Protection encryption: potential encryption on mobile devices, per- stored on a lost/stolen device, particularly f c additional layer of application encryption may only provide when device-level encryption is not in use h a r cryptographic protection additional protection over device or has been bypassed g e f on managed application encryption for certain devices in certain r o data states (e.g., encrypted application data not m h : in use and device locked) t t p Data Trusted key storage: Cryptographic key theft when keys are /: • Android not in use: Android Keystore. / Protection protected locations in stored in unprotected memory locations d The underlying implementation is device- x d. software, firmware, or specific but is typically backed by o o.i hardware in which long- firmware or hardware capabilities to r term cryptographic keys g securely store keys and perform / 1 can be held 0 cryptographic operations 6. 0 2 • iOS: provided by Secure Enclave 8 / N SI • Windows Phone: has a Trusted Platform T S. Module (TPM) capable of trusted key P 1. storage  8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 50Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h si p Data Protected Communication between mobile devices, Eavesdropping or manipulation of u b Protection communications: The cloud services, and on-premises unencrypted data transmitted over cil confidentiality of data components are protected by Transport untrusted networks a t oi transmitted over Layer Security n si untrusted networks is a protected by strong v a ali encryption b el Data Remote wipe: renders Unauthorized access to personal and f • Android: Device Policy Manager er Protection access to both personal application program interface which is corporate data when an attacker is e o and enterprise data used by enterprise mobility management suspected of having physical access to a f c stored on lost/stolen lost or stolen device h / mobile device management gra devices infeasible, but (EMM/MDM) agents, Googleʼs Android e may wipe only a portion f Device Manager, and numerous third- r o of flash memory m party applications h : t • iOS: provided by iCloud and can t p /: additionally be provided by an / d EMM/MDM system when the device is x d. enrolled into enterprise management o o.i r • Windows Phone: provided by g 1/ windowsphone.com 0 6. 0 • Microsoft Intune and Office 365 MDM: 2 8 can trigger a full wipe of enrolled devices / N SI remotely T PS. • Due to variations in implementation of 1. wipe operations on mobile devices, the 8 0 0 inability to recover data may be - .4 contingent on device- or application-level NIST SP 1800-4B: Mobile Device Security 51Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si encryption to achieve a cryptographic u wipe by destroying the decryption key b cil a oit Data Selective wipe: Render • Microsoft Intune/ Systems Center • Unauthorized access to enterprise data n Protection access to enterprise data a si stored on a device C Oo ffn icfi eg u 3r 6a 5t i Mon D M Ma : n Aa ng ae dr m(S iC nC isM tr) a ta on rd c an w coh ne tn ro a l om f a an na uge nd tr ud se tv eic de u i ss e u rn , bd ue tr the v alia i an ff fe ea cts ii nb gle p w erit sh oo nu at l data wipe only organizational data from an destruction of personal data is b enrolled device, leaving personal data undesirable el f intact er • Accidental disclosure of corporate data e o • Android: Disabling the device that may be accessible to personal f c administrator associated with Company applications once the user has opted to h a Portal performs a selective wipe and unenroll their personal device from r g e unenrolls the device from Intune/Office enterprise management f r o 365 MDM m h : • iOS: Removing the device management t t p profile created during enrollment /: / performs a selective wipe and unenrolls d x d. the device from Intune/Office 365 MDM o o.i • Windows Phone: Deleting the workplace r g / created during the enrollment process 1 0 performs a selective wipe and unenrolls 6. 0 the device from Intune/Office 365 MDM 2 8 / N Data Automatic wipe: Unauthorized access to personal and SI • OS-level capability provided by each T Protection Multiple failed unlock corporate data when an attacker S. mobile OS P attempts of lost/stolen attempts brute-force attacks against the 1. 8 devices can render • Microsoft Intune/SCCM and Office 365 unlock mechanism for a lost or stolen 0 0 access to both personal MDM: Offer a policy setting to enforce device - 4 . and enterprise data activation of automatic wipe infeasible functionality NIST SP 1800-4B: Mobile Device Security 52Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h si p Data Hardware security • Android: Device implementation specific, Cryptographic key theft when keys are u b Protection modules: tamper- stored in memory locations accessible to cil resistant hardware used may be discrete hardware, or may be untrusted code a implemented in firmware (e.g., by using t oi to perform cryptographic n ARM TrustZone) si operations and secure a storage that may be • iOS: provided by Secure Enclave v a ali removable or physically • Windows Phone: has a Trusted Platform b el part of the device Module capable of common f er cryptographic operations, which may be e o discrete hardware or may be f c implemented in firmware h a r g Data Isolation Sandboxing: OS or OS-level capability provided by each mobile e • Exploitation of vulnerabilities in rf application-level OS o standard-process isolation mechanisms m mechanisms utilizing h : multiple protection, that would allow a process to access the t instructions or data stored in the t p isolation, and integrity /: memory space or storage locations of d/ capabilities to achieve another process x d. higher levels of overall o o.i isolation • Exploitation of vulnerabilities in the OS r by compromised or malicious mobile g / 1 applications 0 6. 0 • Loss of availability of some OS 2 8 / functionality by flawed mobile N SI applications that enter an T S. unrecoverable execution state (e.g., P 1. application crashes) 8 0 0 Data Isolation Memory isolation: OS-level capability provided by each mobile Unauthorized access by a running process - 4 . Processes should be OS to the data in use by another running unable to access or process, or manipulation of the NIST SP 1800-4B: Mobile Device Security 53Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si modify another processʼs instructions loaded into another processʼs u memory memory space b cil a Data Isolation Trusted execution: A OS-level capability provided by each mobile Exploitation of vulnerabilities in standard- t oi process is created and OS process isolation mechanisms in which n si runs in a trustworthy and the attacking and target processes run in a v isolated execution the same security context a ali environment leveraging b el distinct memory spaces rf and controlled interfaces e e o Data Isolation Device resource Microsoft Intune/SCCM and Office 365 f • Compromise of the mobile OS via hc management: ability to MDM: Offer policy settings to restrict or exploits delivered over unused wireless a r enable/disable device disable peripherals and functions, which g communications protocols (e.g., e rf peripherals and certain are applied and enforced on a mobile Bluetooth or near field communication o OS-provided device by the Company Portal mobile m (NFC) h : functionality application tt • Exfiltration of personal or enterprise p /: data by malware or compromised / d x mobile applications using unsecured d. o and often unmonitored wireless o.i communications protocols (e.g., r g / Bluetooth or NFC) 1 0 6. • Tracking the physical location of a 0 2 8 mobile device using unused wireless / N communications protocols SI T S. • Loss of availability of mobile device P 1. functionality resulting from an increase 8 0 of power consumption by unused 0 - 4 device peripherals (e.g., Bluetooth, NFC, . Wi-Fi, location services) NIST SP 1800-4B: Mobile Device Security 54Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si • Behavior tracking by malware or u b potentially harmful applications (PHAs) cil leveraging data obtained from device a t oi peripherals (e.g., Wi-Fi, location n si services, accelerometer) a v • Compromise of enterprise data, which a ali can be recorded inconspicuously by b el Trojan or other malicious applications f er using accessible device peripherals e o (camera, microphone, location services) f c h a Data Isolation Data flow control: Microsoft Intune/SCCM: MDM and MAM Loss of confidentiality of and enterprise r eg application-level access policies can restrict how data is permitted control over enterprise data that can be rf policies on OS-provided to flow in or out of managed applications shared between mobile applications o m functionality that would h : transfer data into or out t t p of its control /: / d d.x Device Integrity Application whitelisting/ Microsoft Intune/SCCM and Office 365 • Installation of mobile malware or PHAs, o blacklisting: allowing or MDM: can create device policies that deny particularly repackaged versions of o.i disallowing installation installation of applications from unofficial r legitimate applications g / of applications based on application stores 1 0 a prespecified list • Exploitation of vulnerabilities in a third- 6. 0 party library (e.g., advertisement 2 8 library) embedded in an application / N SI T Device Integrity Application Microsoft Intune/SCCM: can additionally S. • Installation of vulnerable applications, P whitelisting/blacklisting specify a whitelist or blacklist of specific 1. which increases the probability of 8 applications and prohibit unsigned 0 application and device compromise 0 applications from being installed - 4 . NIST SP 1800-4B: Mobile Device Security 55Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si • Installation of untrusted applications, u b which handle sensitive data in an cil insecure manner a t oi n Device Integrity Boot validation: Compromise of the mobile OS via a si validation that the • A wn itd hr o di ed v: i co ep -t si po en ca il f iV ce ar vif aie ild a bB ilo ito yt . capability modification of code executed during the v a device is in a known boot process ali working state and Additionally, other optional device- b specific boot-loader protections may be el unmodified at boot (e.g., f present r e basic input-output e o system integrity checks) • iOS: provide by Secure Boot Chain f c h • Windows Phone: provide by Secure Boot a r g e f Device Integrity Application verification: • OS-level capability provided by each Installation of applications that contain r o ensures that applications malicious code introduced after m mobile OS to verify the digital signature h : being installed come of applications submission from the developer or, for tt from a valid source applications downloaded from an official p /: • Android: ability in device settings to application store, after review by the / xd enable/disable installation of application store authority (e.g., Google, d. o applications from untrusted sources Apple, Microsoft) o.i (typically meaning the Google Play Store) r g / 1 • iOS: For applications side-loaded in iOS 9, 0 6. the user must explicitly trust the 0 2 application developer before the 8 / N application can be used  unless the SI T application is installed through an MDM S. P system that the device is enrolled in 1. 8 0 Device Integrity Verified application and OS-level capability provided by each mobile 0 • Introduction of malicious code into an - 4 OS updates: Ensure that OS to verify the digital signature of . installed (and thus trusted) application application and OS applications and OS updates NIST SP 1800-4B: Mobile Device Security 56Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si updates being installed via an update that was modified since u come from a valid source submission or review b cil a • Exploitation of publicly known t oi n vulnerabilities on unpatched devices si a • Introduction of malicious code into the v alia OS via an update that was modified b since submission el f r e Device Integrity Mobile malware Lookout Mobile Threat Protection (MTP) Installation of mobile malware, PHAs, e o detection: identification performs signature and non-signature- particularly repackaged versions of f c of malicious software on based analysis of installed mobile legitimate applications h a r mobile platforms applications g e f Monitoring Inventory of mobile Microsoft Intune/SCCM and Office 365 Compromise of mobile devices through r o m device hardware and MDM inventory enrolled devices, including known and unpatched vulnerabilities in h : software: Provide hardware, firmware, and OS versions device firmware or the mobile OS t t p version information for /: / the hardware, firmware, d x d. OS, and installed o o.i applications for enrolled r mobile devices g / 1 0 Monitoring Inventory of mobile Intune/SCCM inventory installed 6. • Compromise of mobile devices or data 0 device hardware and applications on enrolled mobile devices 2 through known and unpatched 8 software / vulnerabilities in installed applications N SI T • Data compromise through flawed S. P applications known to handle sensitive 1. 8 data insecurely (e.g., store it 0 0 - unencrypted in areas normally 4 . accessible to other applications) NIST SP 1800-4B: Mobile Device Security 57Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si • Data compromise through applications u b that are known to harvest sensitive or cil user behavior data unnecessary for their a t oi advertised purposes n a si Monitoring Asset management: Provided by SCCM for hybrid build and Lower the likelihood of device or v a identifies, configures, Office 365 Enterprise E3 for cloud build application compromise by configuring ali and tracks devices, the device to restrict or disable the use of b el components, software, vulnerable components or applications f r e and services residing on e o a network f c h Monitoring Compliance checks: Microsoft Intune/SCCM and Office 365 Mobile devices with unapproved a r g Provide information MDM: Periodically audit and log device configurations of hardware, firmware, OS, e rf about whether a device policy compliance via Company Portal applications, and device settings are used o m is compliant with a to access, store, or process enterprise h : mandated set of policies data t t p /: Monitoring Root and jailbreak • Microsoft Intune/SCCM and Office 365 • Loss of confidentiality, integrity, or / d detection: ensures that x MDM: can create device policies that availability of personal or enterprise d. the security architecture o enforce jailbreak detection on enrolled data accessed, stored, or processed on a o.i for a mobile device has mobile devices mobile device running a compromised r g not been compromised 1/ OS 0 • Company Portal: performs jailbreak and 06. root detection on devices running iOS, • For Lookout MTP, include losses on 2 8 Android, and Windows Phone 8.1 devices in which compromise of the OS / N may not be detected by the MDM agent SI • Lookout MTP: performs jailbreak and T S. root detection on device running iOS and P 1. Android 8 0 0 - Monitoring Auditing and logging: Microsoft Intune/SCCM and Office 365 Repeated compromise via exploits that 4 . Capture and store MDM: Routinely audit enrolled devices for could be mitigated following review of security events for compliance audit logs NIST SP 1800-4B: Mobile Device Security 58Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si devices, including u enrollment, failed b cil compliance checks, a oit administrative actions, n si and unenrollment a v Monitoring Canned reports and ad Repeated compromise via exploits that a • Provided by Intune/SCCM and Lookout ali hoc queries: produces MTP components could be mitigated following review of b el preconfigured reports audit logs rf from audit logs and the • Microsoft Intune/SCCM: additionally, e o e ability to actively search maintains a log of administrative actions c f or filter logs for specific and compliance check results to support h a data reporting and alerting functions r g e f • Lookout MTP: routinely scans devices r o and logs any detected malware or m h : indicators of OS compromise via rooting t t or jailbreaking p /: / d Identity and Local authentication of OS-level capability provided by each mobile Unauthorized access to or modification of x d. Authorization user to device: OS enterprise or personal data accessible to o o.i requirement of a applications that do not require r g personal identification authentication when an attacker has / 1 0 number (PIN), password, physical access to a mobile device 6. 0 gesture, token, or other 2 8 mechanism before the / N SI device can be fully used T S. Identity and Local user authentication Application-specific functionality that Unauthorized access to or modification of P 1. Authorization to applications: prevents usage of the application until the enterprise data locally accessible to the 8 0 application requires a user successfully authenticates. May be application when an attacker has physical 0 - 4 PIN, password, token, or contingent on remote authentication, as access to an unlocked mobile device . other authentication with Company Portal NIST SP 1800-4B: Mobile Device Security 59Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h p si mechanism to be fully u used b cil a Identity and Local user authentication Microsoft Intune/SCCM: Offer a MAM Unauthorized access to or modification of t oi Authorization to applications policy setting that requires entry of a PIN enterprise data locally accessible to a n si to use the application, which is enforced by managed application when an attacker a v Company Portal has physical access to an unlocked mobile a ali device b el Identity and Remote user Outlook and Company Portal: Require Unauthorized remote access to enterprise f r e Authorization authentication: successful authentication to Office 365 resources when an attacker has access to e o Networked managed Enterprise E3 for full functionality a networked application for which f hc applications require application- or device-level authentication a r authentication to a does not exist or has been bypassed g e f remote service to be r o fully used m h : Identity and Device provisioning and Company Portal: provisions mobile devices t • Remote access to enterprise resources t p Authorization enrollment: restricts into Microsoft Intune or Office 365 MDM /: from untrusted mobile devices / access to organization d d.x resources to provisioned • Compromise of enterprise systems by o.io mobile devices malware executed on untrusted mobile r devices g / 1 0 Privacy Custom privacy Microsoft ADFS: allows the organization to Violation of an employeeʼs expectation of 6. 0 statement: notification customize the authentication portal, privacy as a result of monitoring an 2 8 / provided to users about including a privacy statement employeeʼs personal mobile device during N SI the implications to remote access sessions of enterprise T S. privacy by the use of resources P 1. organizational resources 8 0 and to privacy and 0 - 4 device and application . functionality for enrolled devices NIST SP 1800-4B: Mobile Device Security 60Security Security Capability and Implementation Note Example Mitigated Threats Characteristic Capability Description T h si p Privacy Custom privacy Company Portal: notifies the user of the Violation of an employeeʼs expectation of u b statement implications of enrolling their device into privacy as a result of monitoring an cil an MDM employeeʼs personal mobile device a t oi following enrollment in an enterprise n si MDM a v a ali b el f r e e o f c h a r g e f r o m h : t t p /: / d x d. o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4B: Mobile Device Security 61NIST SPECIAL PUBLICATION 1800-4C Mobile Device Security Cloud and Hybrid Builds Volume C: How-to Guides Joshua Franklin National Institute of Standards and Technology Information Technology Laboratory Kevin Bowler Christopher Brown Spike E. Dog Sallie Edwards Neil McNab Matthew Steele The MITRE Corporation McLean, VA February 2019 This publication is available free of charge from: https://doi.org/10.6028/NIST.SP.1800-4 The original draft of this publication is available free of charge from: https://www.nccoe.nist.gov/projects/building-blocks/mobile-device-security/cloud-hybridDISCLAIMER Certain commercial entities, equipment, products, or materials may be identified in this document in order to describe an experimental procedure or concept adequately. Such identification is not intended to imply recommendation or endorsement by NIST or NCCoE, nor is it intended to imply that the entities, equipment, products, or materials are necessarily the best available for the purpose. T h si p u b cil a t oi n si a National Institute of Standards and Technology Special Publication 1800-4C, Natl. Inst. Stand. Technol. v a ali Spec. Publ. 1800-4C, 109 pages, February 2019, CODEN: NSPUE2 b el f r e e o f c h a r g e rf FEEDBACK o m h : As a private-public partnership, we are always seeking feedback on our Practice Guides. We are t t p particularly interested in seeing how businesses apply NCCoE reference designs in the real world. If you s /: / have implemented the reference design, or have questions about applying it in your environment, d o o.i please email us at mobile-nccoe@nist.gov. r g / All comments are subject to release under the Freedom of Information Act (FOIA). 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . National Cybersecurity Center of Excellence National Institute of Standards and Technology 100 Bureau Drive Mailstop 2002 Gaithersburg, MD 20899 Email: nccoe@nist.gov NIST SP 1800-4C: Mobile Device Security iNATIONAL CYBERSECURITY CENTER OF EXCELLENCE The National Cybersecurity Center of Excellence (NCCoE), a part of the National Institute of Standards and Technology (NIST), is a collaborative hub where industry organizations, government agencies, and academic institutions work together to address businesses’ most pressing cybersecurity issues. This public-private partnership enables the creation of practical cybersecurity solutions for specific industries as well as for broad, cross-sector technology challenges. Through consortia under Cooperative Research and Development Agreements (CRADAs), including technology partners — from Fortune 50 market leaders to smaller companies specializing in IT security — the NCCoE applies standards and best T h practices to develop modular, easily adaptable example cybersecurity solutions using commercially si p available technology. The NCCoE documents these example solutions in the NIST Special Publication u b cil 1800 series, which maps capabilities to the NIST Cyber Security Framework and details the steps needed a t for another entity to recreate the example solution. The NCCoE was established in 2012 by NIST in oi n partnership with the State of Maryland and Montgomery County, Md. si a av To learn more about the NCCoE, visit https://nccoe.nist.gov. To learn more about NIST, visit ali https://www.nist.gov. b el f er NIST CYBERSECURITY PRACTICE GUIDES e o f c NIST Cybersecurity Practice Guides (Special Publication Series 1800) target specific cybersecurity h a r challenges in the public and private sectors. They are practical, user-friendly guides that facilitate the g e f adoption of standards-based approaches to cybersecurity. They show members of the information r o m security community how to implement example solutions that help them align more easily with relevant h : standards and best practices and provide users with the materials lists, configuration files, and other t t p information they need to implement a similar approach. s /: / d The documents in this series describe example implementations of cybersecurity practices that o o.i businesses and other organizations may voluntarily adopt. These documents do not describe regulations r g / or mandatory practices, nor do they carry statutory authority. 1 0 6. 0 ABSTRACT 2 8 / N SI This document proposes a reference design on how to architect enterprise-class protection for mobile T S. devices accessing corporate resources. The example solutions presented here can be used by any P 1. organization implementing an enterprise mobility management solution. This project contains two 8 0 distinct builds: cloud and hybrid. The cloud build makes use of cloud-based services and solutions, while 0 - 4 the hybrid build achieves the same functionality but hosts the data and services within an enterpriseʼs . own infrastructure. The example solutions and architectures presented here are based upon standards- based, commercially available products. KEYWORDS mobile; mobile device; mobile device management; mobility management; mobile security NIST SP 1800-4C: Mobile Device Security iiACKNOWLEDGMENTS We are grateful to the following individuals for their generous contributions of expertise and time. Name Organization Rick Engle Microsoft T h si Kevin Fiftel Intel p u b cil Paul Fox Microsoft a t oi n si Steve Kruse Symantec a v a ali Tim LeMaster Lookout b el rf Nate Lesser NIST National Cybersecurity Center of Excellence e e o f c Adam Madlin Symantec h a r g e f Kevin McPeak Symantec r o m h : Rene Peralta Microsoft t t p s /: / Atul Shah Microsoft d o o.i gr Steve Taylor Intel / 1 0 6. 0 2 /8 The Technology Partners/Collaborators who participated in this build submitted their capabilities in N SI response to a notice in the Federal Register. Respondents with relevant capabilities or product T S. components were invited to sign a Cooperative Research and Development Agreement (CRADA) with P 1. NIST, allowing them to participate in a consortium to build the example solutions. We worked with… 8 0 0 - 4 . Technology Partner/Collaborator Build Involvement Intel Lenovo Miix 2.8 Mobile Device Lookout Enterprise Mobility Management Application Microsoft Microsoft Cloud Service, Company Portal, Intune, Office 365 Enterprise E3, Outlook & Community Portal Mobile NIST SP 1800-4C: Mobile Device Security iiiTechnology Partner/Collaborator Build Involvement Applications, System Center 2012 R2 Configuration Man- ager SP1, Windows Phone Operating System Symantec X.509 Certificate T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security ivContents T h si p u b 2.1.1 Cloud Build Components .............................................................................................. 4 cil a t 2.1.2 Office 365 Setup............................................................................................................ 5 oi n si 2.1.3 Office 365 MDM Setup ...............................................................................................14 a v a ali b el f r e e o c f 3.2.1 Hybrid Build Components ...........................................................................................27 h a r 3.2.2 Enterprise Network and Firewall ................................................................................28 g e f 3.2.3 Enterprise Software Components for Hybrid .............................................................31 r o m 3.2.4 Cloud Services Instances .............................................................................................34 h : t t 3.2.5 Hybrid Integration .......................................................................................................37 p s /: / d o o.i r g / 1 4.1.1 iOS ...............................................................................................................................84 0 6. 0 4.1.2 Android .......................................................................................................................88 2 8 N/ 4.1.3 Windows Phone 8.1 ....................................................................................................90 SI T 4.1.4 Email Setup .................................................................................................................94 S. P 1. 4.1.5 Lookout MTP Enrollment ..........................................................................................103 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security vList of Figures Figure 2-1 Cloud Build Process ............................................................................................................5 Figure 3-1 Hybrid Build Process ........................................................................................................ 25 Figure 3-2 Detailed Architecture ....................................................................................................... 26 Figure 3-3 Detailed Architecture with Network Addresses and Host Names ....................................... 27 Figure 3-4 List of Configured Interfaces ............................................................................................. 28 T h Figure 3-5 WAN ................................................................................................................................ 29 si p u Figure 3-6 WAN Firewall Rules .......................................................................................................... 29 b cil a Figure 3-7 DMZ Firewall Rules .......................................................................................................... 30 t oi n si Figure 3-8 LAN Firewall Rules ........................................................................................................... 30 a v Figure 3-9 Management Firewall Rules ............................................................................................. 31 a ali b el f r e e List of Tables o f c ah Table 1-1 Typographic Conventions ....................................................................................................2 r g e f Table 2-1 Cloud Build Components .....................................................................................................4 r o m Table 3-1 Legend for Detailed Architecture Diagrams ........................................................................ 26 h : t t Table 3-2 Hybrid Build Components .................................................................................................. 27 p s /: / Table 3-3 On-Premise Components of the Hybrid Build ..................................................................... 31 d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security vi1 Introduction The following volumes of this guide show information technology (IT) professionals and security engineers how we implemented the example solutions to the challenge of securing email, contacts, and calendaring in mobile devices. We cover all the products that we employed in this reference design. We do not recreate the product manufacturer’s documentation, which is presumed to be widely available. Rather, these volumes show how we incorporated the products together in our environment. T h si NOTE: These are not comprehensive tutorials. There are many possible service and security p u configurations for these products that are out of scope for this reference design. b cil a t oi si n 1.1 Practice Guide Structure a v a This National Institute of Standards and Technology (NIST) Cybersecurity Practice Guide demonstrates bali standards-based reference designs and provides users with the information they need to replicate this el f approach to mobile device security. This reference design is modular and can be deployed in whole or in r e e part. o f c This guide contains three volumes: h a r g e ▪ NIST SP 1800-4A: Executive Summary f r mo ▪ NIST SP 1800-4B: Approach, Architecture, and Security Characteristics – what we built and why h : ▪ NIST SP 1800-4C: How-To guides – instructions for building the example solution (you are here) t t p /s : Depending on your role in your organization, you might use this guide in different ways: / d o Business decision makers, including chief security and technology officers, will be interested in the ro.i Executive Summary (NIST SP 1800-4A), which describes the following topics: g / 01 ▪ challenges enterprises face in implementing and using mobile devices 6. 20 ▪ example solutions built at the NCCoE 8 / N ▪ benefits of adopting the example solutions SI T S. Technology or security program managers who are concerned with how to identify, understand, assess, P 1. and mitigate risk will be interested in NIST SP 1800-4B, which describes what we did and why. The 8 0 following sections will be of particular interest: 0 - 4 . ▪ Section 3.4.3, Risk, which provides a description of the risk analysis we performed ▪ Section 3.4.4, Security Control Map, which maps the security characteristics of this example solution to cybersecurity standards and best practices You might share the Executive Summary, NIST SP 1800-4A, with your leadership team members to help them understand the importance of adopting standards-based enterprise mobility management (EMM) approaches to protect your organization’s digital assets. NIST SP 1800-4C: Mobile Device Security 1IT professionals who want to implement an approach like this will find the whole practice guide useful. You can use the How-To portion of the guide, NIST SP 1800-4C, to replicate all or parts of the build created in our lab. The How-To guide provides specific product installation, configuration, and integration instructions for implementing the example solutions. We do not re-create the product manufacturers’ documentation, which is generally widely available. Rather, we show how we incorporated the products together in our environment to create an example solution. This guide assumes that IT professionals have experience implementing security products within the enterprise. While we have used a suite of commercial products to address this challenge, this guide does T not endorse these particular products. Your organization can adopt this solution or one that adheres to h p si these guidelines in whole, or you can use this guide as a starting point for tailoring and implementing u b parts of a solution that would support the deployment of mobile devices and the corresponding cil business processes. Your organization’s security experts should identify the products that will best a t oi integrate with your existing tools and IT system infrastructure. We hope that you will seek products that n si are congruent with applicable standards and best practices. a v a ali 1.2 Build Overview b el f The NCCoE constructed the Mobile Device Security building block by using a virtualized environment and r e e a physical wireless access point. The servers hosted by the virtualized environment were built to satisfy o c f the hardware specifications of the specific software components in a small test environment (hard drive h a capacity, memory, etc.). The wireless access point was configured to use a closed lab network rather r g e than directly internet connected. The mobile devices used in the build were configured to use this f r o access point to simulate usage outside the traditional corporate network boundaries. Readers of this m h : guide should assess the hardware needs of their environment carefully before implementation. Further, tt this build requires internet accessibility for some of the on-premise components that connect to p s /: commercial cloud services. We recommend configuring your firewall or other equipment to allow only / d o internet access from on-premise systems to a specific internet protocol (IP) space provided by your o.i cloud provider. r g / 1 0 Finally, this document makes heavy use of screenshots from cloud services set up through a web 6. 0 browser. The reader should be aware that the rapid development of cloud services may cause some 2 8 differences in what is presented here with screenshots and what the implementer experiences. Refer to / N SI vendor documentation to address significant variations. T S. P 1. 1.3 Typographic Conventions 8 0 0 - The following table presents typographic conventions used in this volume. 4 . Table 1-1 Typographic Conventions NIST SP 1800-4C: Mobile Device Security 2Typeface/ Symbol Meaning Example Italics File names and path names; For detailed definitions of terms, see the references to documents that NCCoE Glossary. are not hyperlinks; new terms; and placeholders Bold names of menus, options, Choose File > Edit. command buttons, and fields T h si p Monospace mkdir u command-line input, on-screen b cil computer output, sample code a t examples, status codes oi n a si Monospace Bold command-line user input con- service sshd start v a trasted with computer output ali b f el blue text link to other parts of the docu- All publications from NIST’s NCCoE are r e ment, a web URL, or an email available at https://nccoe.nist.gov. e o address f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 32 How-To: Build a Cloud-Based Solution to Mobile Device Security This section of the practice guide contains detailed instructions for creating and configuring the cloud architecture depicted below. No software resources are necessary for this build because it is completely cloud based. The only hardware requirement is that the organization that implements this build uses mobile devices that are compatible with the cloud mobile device management (MDM). This building block chose to use mobile devices running iOS, Android, and Windows Phone — the top three operating T systems in terms of market share . h si p This How-To guide details the creation, configuration, and enrollment aspects of each cloud service. u b cil Keep in mind, a prerequisite to the cloud is an internet domain name. If the implementer does not a t already have a domain name, one can be obtained from an accredited registrar . You will need to be oi n able to edit the resource records to prove ownership of the domain. si a v The implementer will also need access to an Apple developer account to generate a push notification a ali certificate for iOS devices. A push certificate allows the Office 365 instance to send push notifications to b el enrolled devices. Refer to the Apple website for pricing information and more details regarding f r e certificates . e o c f Further, during the configuration of the Office 365 MDM, you will be prompted to allow or block devices h a from Office 365 that cannot be managed. This can occur when a user has a device with an unsupported r g e operating system. Select Block during this step to enhance the security of Office 365 services. f r o m Finally, we have chosen in this simple cloud build to leverage the MDM capabilities that are available th : within Office 365. This offers a more limited feature set than what is available through the Intune MDM t p s service. Implementers looking for more capabilities should consider the Intune portion of the Hybrid /: d/ How-To guide. o o.i gr 2.1 Cloud Build Setup and Configuration / 1 0 6. 0 2.1.1 Cloud Build Components 2 8 / N The following components are used for this building block: SI T S. Table 2-1 Cloud Build Components P 1. 8 0 0 Make Model Version Quantity - 4 . Microsoft Office 365 Tenant Business Premium 1 Google Nexus (Android) 6 (5.1) 1 Apple iPhone (iOS) 6 (8.3) 1 Nokia Lumia (Windows Phone) 830 (8.10.14219.341) 1 N/A Public Domain Name N/A 1 NIST SP 1800-4C: Mobile Device Security 4The cloud building block build process can be completed with the following high-level steps in Figure 2- 1. The following sections in the How-To guide will focus on the final two steps. Figure 2-1 Cloud Build Process T h 2.1.2 Office 365 Setup si p u Office 365 is the central piece to the functionality of the cloud building block. The only prerequisite to b cil this step is a public domain name. Keep in mind these steps may change as this is a web-based a t oi procedure. n si a To start the process, use a web browser to access the following URL to start the process: v a https://products.office.com/en-us/business/office-365-enterprise-e3-business-software. ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 1. Choose a commitment level 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 5T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 6T h si 2. Fill in the requested information in the next several screens p u b cil a t oi n si a v a ali b el f r e e o 3. Choose Admin from the set of services f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 4. In the next steps, we will configure the domain name with Office 365. Choose the Domains option NIST SP 1800-4C: Mobile Device Security 7T h si p u b cil a t oi n si a v alia 5. Choose Add domain b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 6. Choose Let's get started 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 8T h si p u b cil a t oi n si a v a ali 7. Enter your public domain name b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. 8. Choose Next P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 9T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a 9. At this point you need to add this information to the TXT record of your domain name. This r g e functionality should be available from your registrar f r o m h : t t p s /: / d o o.i r 10. Verify the Domain Name System (DNS) settings. The TXT record should match what was g / 1 presented in the previous step. Note that it may take several minutes for the record to 0 6. propagate to the Office 365 DNS servers 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 11. Choose Next NIST SP 1800-4C: Mobile Device Security 10T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : 12. Choose Update selected users t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 81. 13. Sign out to complete the change, and then sign in with your identification. 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 11T h si p u b cil a t oi n si a v a ali b el f r e e 14. Choose Next o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 15. Choose Next NIST SP 1800-4C: Mobile Device Security 12T h si p u b cil a t oi n si a v a ali b el f 16. Choose Next r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 13T h si p u b cil 17. Add the resource records presented in this step to your domain name. These are necessary for a t oi full functionality of the Office 365 tenant n si va 2.1.3 Office 365 MDM Setup a ali b In the next section, you will be guided through the device management setup through Office 365. el f er https://portal.office.com/Admin/Default.aspx#IntuneInventoryPage e o c f 1. Choose Get Started h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 14T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g 2. Next, a security group needs to be created in order to apply the policy to a group of users. e rf Navigate to Office 365 > Admin Center > Groups > + o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3. Add a title and description for the group NIST SP 1800-4C: Mobile Device Security 15T h si p u b cil a t oi n si a v a ali b el f r e e o f c 4. Add members to the group to be managed h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 5. Go to Office 365 > Admin Center > Mobile Devices > Manage device security policies to configure a device policy to apply to enrolled devices NIST SP 1800-4C: Mobile Device Security 16T h si p u b cil a t oi n si a v a ali b el f r e 6. Choose to Block unsupported devices e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 7. Set the name for the actual device policy NIST SP 1800-4C: Mobile Device Security 17T h si p u b cil a t oi n si a v a ali b el rf e e o 8. Set rules for the device policy f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 9. Set additional restrictions NIST SP 1800-4C: Mobile Device Security 18T h si p u b cil a t oi n si a v a ali b el rf e e o 10. Select whether to deploy the policy and to what group f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 11. Select the group created earlier to apply the policy 2.1.3.1 Configure Push Certificate for iOS Devices As noted in the introduction to this section, an Apple push notification (APN) certificate is required for full functionality with Apple iOS devices. Only Apple can sign these certificates. NIST SP 1800-4C: Mobile Device Security 19T h si p u b cil a t oi n si a v a ali b el f r e e o f 1. Set up APN in Office 365 > Admin Center > MobileDevices > Manage Settings c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. Configure an APNs Certificate for iOS devices > Set up NIST SP 1800-4C: Mobile Device Security 20T h si p u b cil a t oi n si a v a ali b el f r e e o f c 3. Download certificate signing request (CSR). Once the CSR is generated, it can be submitted to h a r Apple for signing. Use a browser to visit: https://identity.apple.com/pushcert/. g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 4. You will be prompted for your Apple Developer account credentials. Sign in NIST SP 1800-4C: Mobile Device Security 21T h si p u b cil a t oi n si a v a ali b el f r e e o c f h a r g e f r o 5. Once authenticated, choose Create a certificate. Review the terms and conditions screen m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 226. When creating the certificate, you will be presented with a screen to submit your CSR. Use the Browse button to navigate to where you stored your CSR file and choose Upload T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e rf o m h : 7. After the upload, refresh the page. You will be presented with a list of signed certificates. tt Choose the download option for your new certificate, which will allow you to save the signed p s /: certificate in privacy enhanced mail (PEM) format / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 23T h si p u b cil a t oi n si a v a ali b el f r e e o f c h 8. Return to Office 365, and upload the signed APN certificate from Apple’s developer portal a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 9. Verify that the APN is working correctly. It should have an expiration date listed NIST SP 1800-4C: Mobile Device Security 243 How-To: Build an On-Premises Solution for Mobile Device Security 3.1 Hybrid Build Setup and Configuration Figure 3-1 depicts the high-level procedures to reproduce the hybrid build used in this building block. First, the implementer must own an internet domain name or have permission to edit resource records within a domain. This is a prerequisite to integration with the cloud services used within this build. The T next set of steps configure the on-premise components. The procedures assume that no on-premise h p si components have been installed, however implementers may wish to skip to the configuration sections u b if these components are already in place. In general, this guide defers to vendor documentation for cil installation procedures. The final set of steps instantiate the cloud services and integrate them into the a t oi on-premise components. n si a Figure 3-1 Hybrid Build Process v a ali b el f r e e o f c h a r g e rf An important prerequisite to using Active Directory Federation Services (ADFS) in this hybrid o m arrangement is a third-party public key certificate issued from a reputable certificate authority. In this h : t build we used Symantec’s Secure Site Pro service. You may also want to purchase a third-party t p s certificate to secure the Transport Layer Security channel on the system that hosts the application proxy /: d/ to avoid web browser warnings/errors when users authenticate to the enterprise. Please refer to o o.i TechNet articles  and  for specific requirements. r g / 1 Finally, there are several cloud-based services that provide functionality similar to the one chosen in this 0 6. build. We use Microsoft’s Office 365 for email/calendaring/contacts management and Intune to manage 0 2 8 mobile devices. The implementer should note that email/calendaring/contact and MDM from different / N vendors may not offer the same out-of-the-box integration as what we have chosen here. For example, SI T we have set a compliance rule that forces the mobile device to be enrolled with the MDM before it is S. P 1. given access to email/calendaring/contacts. 8 0 0 - 3.2 Hybrid Detailed Architecture 4 . The following architecture diagrams depict the final architecture of the hybrid build after implementing this guide. Figure 3-2 calls out the various protocols implemented among the on-premise, cloud, and mobile device components. Figure 3-3 is a similar view but details the network addressing and host names that were used during the build. NIST SP 1800-4C: Mobile Device Security 25Figure 3-2 Detailed Architecture T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t pt s /: / d Table 3-1 Legend for Detailed Architecture Diagrams o o.i r /g Acronym Term 1 0 6. AD Active Directory 0 2 8 ADDS Active Directory Domain Service / N SI ADFS Active Directory Federation Services T S. DMZ Demilitarized Zone P 1. HTTPS Hyper Text Transfer Protocol Secure 8 0 0 ISP Internet Service Provider - 4 . LDAP Lightweight Directory Access Protocol MGMT Management Network TLS Transport Layer Security WAP Wireless Access Point NIST SP 1800-4C: Mobile Device Security 26Figure 3-3 Detailed Architecture with Network Addresses and Host Names T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t 3.2.1 Hybrid Build Components p s /: d/ The following components are used for this building block: o o.i r Table 3-2 Hybrid Build Components g / 1 0 6. Make Model Version Quantity 0 2 8 Lookout Mobile Security Lookout Security for Work Ap- 2.0.150 1 / N SI plication T S. Lookout Mobile Security Mobile Threat Protection 1 P 1. 8 Microsoft Office 365 Tenant Business Premium 1 0 0 - Lenovo Miix (Windows) 2.8 (8.1) 1 4 . Google Nexus (Android) 6 (5.1) 1 Apple iPhone (iOS) 6 (8.3) 1 Nokia Lumia (Windows Phone) 830 (8.10.14219.341) 1 Microsoft Windows Server 2012 R2 5 Open Source pfSense 1 Microsoft Windows 7 1 NIST SP 1800-4C: Mobile Device Security 27Make Model Version Quantity Microsoft System Center Configuration 1 Manager (SCCM) Microsoft AD DS 1 Microsoft AD FS 1 Microsoft AAD Sync 1 Microsoft Web Application Proxy 1 T h Microsoft Intune N/A 1 si p Symantec Public Certificates N/A u b cil N/A Public Domain Name N/A 1 a t oi n si 3.2.2 Enterprise Network and Firewall a v a The build uses pfSense for the organization router/firewall (see figure above). It is a combination router bali and firewall configured as a virtual device. This subsection describes the configuration used in the build el f and how to create it. r e e o A single firewall configuration was chosen for simplicity and flexibility in a lab environment, but a dual f c firewall configuration could also be implemented. Only IPv4 is used and IPv6 is disabled for simplicity. h a r g e To install and configure pfSense, implementers should refer to pfSense documentation for installation f r o and configuration instructions. To re-create the build’s configuration, follow the instructions in the m h : documentation and use the configuration files made available by pfSense (pfSense Configuration Files: tt Interfaces — interfaces-config-pfSense.localdomain-20150402160851.xml; NAT — nat-config- p /s : pfSense.localdomain-20150402160838.xml; Firewall — filter-config-pfSense.localdomain- / d 20150402160823.xml) o o.i r The following screenshots show the final configuration of the pfSense device. Access pfSense through its g / 1 web interface. The default screen includes a list of interfaces described as part of the architecture in the 0 06. Hybrid Build Architecture section. The individual interfaces are described below with the firewall rules. 2 8 N/ Figure 3-4 List of Configured Interfaces SI T S. P 1. 8 0 0 - 4 . The build network is configured to use network address translation (NAT). The following port forwarding is set up to allow communication from outside the lab into the build network. NIST SP 1800-4C: Mobile Device Security 28Figure 3-5 WAN T h si p u b cil ta oi n si Several firewall rules are configured to control access through the subnetworks. The following a screenshots show these rules for the wide-area network (WAN), demilitarized zone (DMZ), local area v a ali network (LAN), and management network (MGMT). b el f Figure 3-6 WAN Firewall Rules r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI The WAN configuration information is specific to our Internet Service Provider (ISP). In this lab, we T S. provided the 10.33.1.0/24 network from which to statically assign addresses. 10.33.1.105 is the pfSense P 1. device’s IP address, and 10.33.1.104 is also assigned as a virtual IP address for the WAP service. Firewall 8 0 rules are configured to allow internet access to the WAP in the DMZ in order for Microsoft’s ADFS to 0 - 4 function. . NIST SP 1800-4C: Mobile Device Security 29Figure 3-7 DMZ Firewall Rules T h si p u b cil a t oi n si a v a ali b el f r e In pfSense our DMZ is assigned as DMZ (OPT2) using the network 192.168.3.0/24. It is not allowed to e fo access the intranet or management networks, except for specific rules for DNS and ADFS access. c h 192.168.1.10 is the IP address of the Active Directory server. 192.168.1.20 is the IP address of the ADFS a r g server. e f r mo Figure 3-8 LAN Firewall Rules h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - In pfSense our LAN is using the network 192.168.1.0/24. It is not allowed to access the MGMT network. 4 . NIST SP 1800-4C: Mobile Device Security 30Figure 3-9 Management Firewall Rules T h si p u b cil a t oi n si In pfSense our management network is assigned as MGMT (OPT1) using the network 192.168.2.0/24. It a has access to all networks. v a ali elb 3.2.3 Enterprise Software Components for Hybrid f r ee The following section describes installation of the on-premise components of the hybrid build. As noted o f previously, this guide provides references to the vendor’s documentation for installation to better c h customize the component to the target environment. Alternatively, implementers may replicate this a r g build exactly by using the following table, which maps each component to the exact system used in e rf architecture diagram Figure 3-2, Detailed Architecture. o m h : Table 3-3 On-Premise Components of the Hybrid Build t t p s /: Component Host Name IP Address / d o o.i Active Directory Domain Services mds00 192.168.1.10 r /g Active Directory Federation Services mds-adfs 192.168.1.20 1 0 6. Active Directory Federation Services Proxy wap 192.168.3.104 0 2 8 Systems Center Configuration Manager mdssccm 192.168.1.102 / N SI Azure Active Directory Sync Services mds-adsync 192.168.1.21 T S. P 1. 08 In order to increase security from the default server configuration, the Security Configuration Wizard 0 - 4 (SCW) included with Windows Server 2012 R2 was used on each server after installation. These policies . were saved as XML files and are available for download. They can be viewed, edited, and applied with the SCW tool. 3.2.3.1 Active Directory Domain Services The Active Directory Domain Services (ADDS) instance used in the hybrid build was created by using basic configuration settings offered through the Add Roles and Features Wizard. The system was deployed as a new forest with a domain name of nccoe.local. Implementers of this guide who seek more NIST SP 1800-4C: Mobile Device Security 31details of an ADDS installation can consult an Install Active Directory Domain Services  TechNet article. Alternatively, implementers may wish to use a lab environment for their development . After installation, the implementer should create an organizational unit (OU) to hold users who are to be synced with the Office 365 tenant. Create test accounts in this OU of users that will represent individual device owners. Or, as mentioned previously, create users from a production environment. The domain controller will find the user’s account based upon the userPrincipalName in the certificate’s Subject Alternative Name field. The original domain controller was set up with a domain of nccoe.local. However, a more likely scenario would have an organization create an instance under a well-known top- T h si level domain. We have addressed this issue by adding a User Principal Name (UPN) for hmdsbb.org in p the ADDS configuration. All users in this configuration are required to have a UPN of u b cil <user>@hmdsbb.org. Identity federation between Intune and on-premise ADFS will fail if the users do a t not have the appropriate UPN. oi n si The procedures to configure a UPN suffix are as follows: a v a ali 1. Launch Active Directory Domain and Trusts snap-in elb 2. Right-click on the top-level Active Directory Domains and Trusts rf 3. Select Properties e e o 4. In UPN Suffixes tab add hmdsbb.org and ad.hmdsbb.org domain suffixes f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T PS. 1. 8 0 3.2.3.2 Active Directory Federation Service 0 - 4 . Readers of this guide should refer to Microsoft documentation for specific installation instructions for their environment. Consult the referenced articles as a starting point for installation , . Implementers should note the requirement of a certificate issued from a certificate authority that is recognized/trusted by Microsoft. In this demonstration, the build team procured certificates from Symantec’s Secure Site Pro Secure Sockets Layer (SSL) service. Ensure that the provider is able to populate the Subject Alternative Name extension of the certificates used in the implementation. Screenshots below are of the certificates from Symantec used in the build. NIST SP 1800-4C: Mobile Device Security 32T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 3.2.3.3 Active Directory Federation Services Proxy 4 . Refer to the articles referenced in the Active Directory Federation Service section for specific installation instructions. 3.2.3.4 Systems Center Configuration Manager Readers of this guide should refer to Microsoft documentation for specific installation instructions for their environment. Consult the following Test Lab Guide as a starting point for installation . NIST SP 1800-4C: Mobile Device Security 333.2.3.5 Azure Active Directory Sync Services Refer to the referenced article for Azure Active Directory Sync Tool installation procedures . Default options were used for this build. 3.2.4 Cloud Services Instances After the on-premise components have been installed, the cloud services must be created. This section walks the implementer through the basic steps of creating Office 365, Intune, and Lookout accounts. T 3.2.4.1 Office 365 Setup h si p u The setup of the Office 365 service is the same as what has been previously described for the cloud build b cil in section 3.1. We replaced cmdsbb.org with hmdsbb.org for this build. a t oi n 3.2.4.2 Intune Setup si a Use a browser to access the following URL to start the Intune creation process: v a ali http://www.microsoft.com/en-us/server-cloud/products/microsoft-intune/ b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 82 / N SI 1. Choose Try Now T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 34T h si p u b cil a t oi n si a v a ali b el f r e e o f hc a r g 2. Sign up for a trial license when prompted e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. 3. Choose Try Now P 1. 8 Sign-up is complete, and you should be redirected to the Intune management console at 0 0 - https://manage.microsoft.com. 4 . Note that the Silverlight 3.0 browser support is required to load the management console. NIST SP 1800-4C: Mobile Device Security 35T h si p u b cil a t oi n si a v a ali b el f er Important! Do not proceed any further with Intune if you want to manage devices via SCCM. e o f c 3.2.4.3 Lookout Setup h a r g Contact the enterprise sales team at support@lookout.com to create an account. e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 1. After your account has been created, the designated administrators will receive an email 0 - 4 instructing them to reset their password. Click the link and reset the password . NIST SP 1800-4C: Mobile Device Security 36T h si p u b cil a t oi n si a v a ali 2. Open the Lookout administrative console to access the Lookout administrator functions by using b el a browser and navigating to https://mtp.lookout.com/les f r e e o 3.2.5 Hybrid Integration f c h a This section documents the integration of cloud and on-premise services. r g e rf 3.2.5.1 Office 365 with Active Directory Federation Setup o m h : In this step, an on-premise ADFS server is integrated with the Office 365 service. The purpose of this t t integration is to provide identity federation between Office 365 and enterprise authentication service. p s /: You should have previously added your public domain to Office 365 in the Office 365 Setup section. If / d o not, follow the procedures from TechNet Magazine . Detailed integration information can be found o.i in the referenced TechNet article . r g / 1 0 1. Connect ADFS with your Office 365 instance by issuing the following two commands. This step 6. 0 will automatically exchange the required metadata to implement federation with Office 365 2 8 / N Set-MsolAdfscontext -Computer <AD FS server FQDN> SI T S. Convert-MsolDomainToFederated -DomainName <domain name> P 1. 8 3.2.5.2 Azure Active Directory Sync Services 0 0 - 4 For this step, we configure synchronization of the organization’s enterprise Active Directory with the . Office 365 directory. This service will periodically sync identities — adding, deleting, or otherwise modifying from the on-premise Active Directory to the Azure Active Directory instance when this step is completed. This build accepted the default syncing schedule, but it may be tuned at a later time. NIST SP 1800-4C: Mobile Device Security 37T h si p u b cil a t oi n si a v a ali b el f r e e 1. Launch the Sync Services Configuration Tool. Input the global administrator credentials for the o f Office 365 instance and click Next c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. Input the Forest name and credentials of the administrator. Click Add Forest NIST SP 1800-4C: Mobile Device Security 38T h si p u b cil a t oi n si a v a ali b el f r e e 3. Click Next o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 4. Accept the defaults for uniquely identifying your users. Click Next NIST SP 1800-4C: Mobile Device Security 39T h si p u b cil a t oi n si a v a ali b el f r e e 5. Do not choose any of the optional features. Click Next o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 6. Click Configure NIST SP 1800-4C: Mobile Device Security 40T h si p u b cil a t oi n si a v a ali b 7. Choose to Synchronize now and click Finish el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 8. If successful, the added connectors will be displayed in the Synchronization Service Manager 3.2.5.3 Sync Intune with Office 365 Exchange The following steps will establish a back-end connection between the Intune and Office 365 instances, which were created in the Cloud Services Instances section. When this step is completed, Intune will have the ability to enforce conditional access policies on all enrolled mobile devices. NIST SP 1800-4C: Mobile Device Security 41T h si p u b cil 1. Open the Intune administrative console with a browser. Click ADMIN a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 2. Click Set Up Exchange Connection within the Microsoft Exchange section 6. 0 3. Click Set Up Service to Service Connector 2 8 / N The configuration with Office 365 will occur in the background. No further actions are required. SI T S. P 3.2.5.4 Manage Intune with SCCM 1. 8 0 To allow the Intune tenant to be administered remotely, SCCM must be configured on the enterprise 0 - 4 network. The following steps add test accounts to an SCCM user collection and syncs with the Intune . tenant. While Intune will be available through the browser-based administrative console after this exercise, the account will be permanently configured to manage devices through SCCM. 3.2.5.4.1 Configure Active Directory User Discovery When these steps have been completed, the SCCM instance will be able to automatically discover Intune users by way of an Active Directory container. 1. Launch the Configuration Manager console. Navigate to System Center Configuration Manager /Site Database/Site Management/<site name>/Site Settings/Discovery Methods NIST SP 1800-4C: Mobile Device Security 422. Right-click Active Directory User Discovery, and then click Properties 3. On the General tab, click the New icon to specify a new Active Directory container 4. On the New Active Directory Container dialogue box, specify Local Domain T h si p u b cil a t oi n si a v a ali elb 5. Select the AzureAD Synced Users container f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 6. The path will reflect the container chosen in the previous step. Click OK 0 - 4 . NIST SP 1800-4C: Mobile Device Security 43T h si p u b cil a t oi n si a v a ali b el 7. Ensure Enable Active Directory User Discovery is selected. Click OK f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 8. After configuration, the status of the Active Directory User Discovery will be Enabled NIST SP 1800-4C: Mobile Device Security 44T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a gr e f r 9. Navigate to Users > All Users to view accounts synced from Active Directory o m h : 3.2.5.4.2 Register SCCM with Intune t t p The following sequence of steps enrolls an SCCM instance with the Intune tenant. After this step you will s //: no longer be able to create and deploy policies from the Intune web management portal. d o o.i 1. Start the Intune Subscription wizard by opening the Configuration Manager. In the r g / Administration section, expand Cloud Services, and click Microsoft Intune Subscriptions. Click 1 0 6. on the Home tab and then Add Microsoft Intune Subscription 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 45T h si p u b cil a t oi n si a v a ali b el rf e e o 2. Click Next f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3. Click the Sign In button NIST SP 1800-4C: Mobile Device Security 46T h si p u b cil a t oi n si a v a ali b 4. Sign in using an administrative user from the Intune tenant el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 5. Authorize a collection of users to enroll with Intune. Click Next NIST SP 1800-4C: Mobile Device Security 47T h si p u b cil a t oi n si a v a ali b el f r e e 6. You may choose to configure device types in this step. However, we chose to configure these in o c f a later step. Click Next h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 7. Enter the contact information for your organization. This is optional. Click Next NIST SP 1800-4C: Mobile Device Security 48T h si p u b cil a t oi n si a v a ali b el rf e e o 8. Submit an organizational logo, if desired. Click Next f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 9. Review the settings and click Next NIST SP 1800-4C: Mobile Device Security 49T h si p u b cil a t oi n si a v a ali b el f r e e o c f 10. Close the wizard after the configuration completes. A green check mark indicates success for h a that task r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 11. The Intune administrative console reflects SCCM management after configuration has been completed 3.2.5.4.3 Configure Push Certificate for iOS Devices A push notification certificate is required for full functionality with Apple iOS devices. Only Apple can sign these certificates. Once the CSR is generated, it can be submitted to Apple for signing. The following procedure shows how to create the CSR within SCCM. NIST SP 1800-4C: Mobile Device Security 50T h si p u b cil a t oi n si a v a ali b el f r e e o f hc a r g 1. Click Create APNs certificate request in the SCCM console e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 2. Save the CSR to local storage. Youʼll need this file for the next step 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 51T h si p u b cil a t oi n si a v a ali b 3. Use a browser to visit https://identity.apple.com/pushcert/. You will be prompted for your el f Apple Developer account credentials. r e e o f c h a r g e f r o m h : tt p s //: 4. Once authenticated, choose Create a certificate d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 52T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a 5. Review the terms and conditions screen. You will be presented with a screen to submit your r g e CSR. Use the Browse… button to navigate to where you stored your CSR file, and choose Upload f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 536. After the upload, refresh the page. You will be presented with a list of signed certificates. Choose the download option for your new certificate, which will allow you to save the signed certificate in PEM format T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i gr 7. Load the signed certificate into SCCM. Navigate to Administration > Overview > Cloud Services / 1 0 > Windows Intune Subscriptions. Right-click on Windows Intune Subscription and choose 6. 0 Properties 2 8 8. Check the box to enable iOS enrollment and use the Browse… button to import the PEM / N SI certificate you downloaded from Apple. Click OK T S. P 3.2.5.4.4 Mobile Policy Creation 1. 8 The following section depicts creation and deployment of a security policy to mobile devices in the 0 0 - building block test environment. The reader should note that not all options are available to every 4 . mobile operating system. Generally, iOS offers more fine-grain device management capabilities than Android; however, a KNOX-enabled Samsung Android device augments the base Android capabilities with additional management functions. More information regarding specific capabilities of supported mobile platforms can be found on TechNet . 1. Launch the Create Configuration Item Wizard from the SCCM Configuration Manager. In the Assets and Compliance section, click Configuration Items in the Compliance Settings folder. Click Create Configuration Item from the toolbar NIST SP 1800-4C: Mobile Device Security 54T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : 2. Give the configuration a name and specify in the drop-down that this configuration item is for t t p mobile devices. Click Categories… s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3. Select the Client category. Click OK NIST SP 1800-4C: Mobile Device Security 55T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e 4. Select Password, Device, Security, and Encryption setting groups. Click Next f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 5. Configure the password requirements based on your local requirements NIST SP 1800-4C: Mobile Device Security 56T h si p u b cil a t oi n si a v a ali b el f r e e o 6. Configure the device settings based on your local requirements f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 7. Configure the security settings based on your local requirements NIST SP 1800-4C: Mobile Device Security 57T h si p u b cil a t oi n si a v a ali b el f r e e o 8. Configure the encryption settings based on your local requirements f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 9. Select the mobile platforms you wish to support. Click Next NIST SP 1800-4C: Mobile Device Security 58T h si p u b cil a t oi n si a v a ali b el f r e e 10. Click Next o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 11. Click Next NIST SP 1800-4C: Mobile Device Security 59T h si p u b cil a t oi n si a v a ali b el f r e e 12. Click Close o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 13. Click Create Configuration Baseline by right-clicking Configuration Baseline from the Configuration Manager NIST SP 1800-4C: Mobile Device Security 60T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e 14. Name the baseline policy. Add the baseline configuration created in the previous steps and click f r o OK m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3.2.5.4.5 Create Mobile Application Policy This section describes how to roll out mobile application policy for the Outlook mobile application. The policy is automatically deployed when the device owner installs the application for the first time. First, the SCCM administrator will create a new application management policy, then associate an application NIST SP 1800-4C: Mobile Device Security 61to the newly created policy. The following procedures feature the iOS platform, but the process is essentially the same for other platforms. T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r /g 1. To start the wizard, navigate to Under Software Library > Application Management > 1 0 Application Management Policies: Create Policy in the SCCM console. Name the policy and click 6. 0 Next 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 62T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : tt p s //: 2. Choose the platform type and policy type. In this example, a policy is being deployed to an iOS d o application. Click Next o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 63T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : tt p s //: 3. Set the specifics of the policy as pictured. Click Next d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 64T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : tt p s /: Upon successful creation, an overview is displayed. In order to use this policy, it needs to be matched / d o with an application. o.i r /g In the next section, the Outlook application is linked to the iOS application store through Company 1 0 Portal and associated with the previously created application policy. 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 653.2.5.4.6 Link an Application to a Previously Created Mobile Application Policy T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 1. Navigate to Software Library > Applications and Create Application. The admin will be 0 2 8 prompted for a link to the application store application that they wish to link in the Location / N field. Search for the Outlook application using a search engine, and copy the link SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 66T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 2. Set the Name, Publisher, and Software version information for the application link as pictured r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 67T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 3. Click Next to confirm the settings r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 68T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o 4. Important: Deploy the application to a user collection instead of a device collection o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 69T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o 5. After setting the general settings for deploying the application, the admin will get a chance to o.i link an application profile. Further configuration of the General Settings was not required for our r g 1/ purposes 0 6. 0 3.2.5.4.7 Configure SCCM with Lookout Application 2 8 / This section describes integration of the Lookout mobile application with SCCM. When completed, the N SI mobile device user will receive a link to download the Lookout application after enrollment with the T S. MDM. The link URL will differ based on the mobile platform. Android users will be directed to the P 1. Google Play Store, iOS users to the App Store, and Windows Phone users to the Windows Phone store. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 70T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 1. To start the wizard, navigate to General. Select App Package for Android on Google Play in the r /g Type drop-down. Type 1 0 https://play.google.com/store/apps/details?id=com.lookout.enterprise&hl=en 6. 0 in the Location field. 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 71T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 2. Click Next r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 72T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 3. Use the suggested text in the Name and Publisher fields. Click Next r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 73T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 4. Click Next r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 74T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i 5. Click Close r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 75T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t pt s /: / 6. Open the application deployment wizard. In the Software field, browse for the Lookout d o o.i application. In the Collection field, browse for All Users r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 76T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p /s : / d o 7. Click Next o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 77T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p /s : / d o 8. In the Action drop-down, choose Install. In the Purpose drop-down, choose Available. Click o.i r Next g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 78T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p /s : / d o 9. Click Next o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 79T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t pt s /: / 10. In the User notifications drop-down, choose Display in Software Center and show all d o o.i notifications r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 80T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: d/ 11. Click Next o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 81T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p /s : / d o 12. Click Next o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 82T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p /s : / d o 13. Click Close o.i r /g 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 834 How-To: Device Configuration The following section steps through the configuration of devices. This section is applicable to both the cloud and hybrid builds. Here, we feature enrollment and email configuration with iOS, Android, and Windows Phone operating systems. 4.1 Device Enrollment with Office 365 The following sections depict the enrollment process of an iOS and Android device to the Intune T enterprise mobility management service. The reader should note that the Intune service will h si automatically redirect the user to the Intune tenant owner’s authentication service based on the p u domain part presented in the user’s email address. The authentication service must be accessible via the b cil internet if users enroll remotely. Otherwise, an organization must make its authentication service a t oi available on a local network accessible by device users. n si a Instruct device owners to download the Company Portal application through the application distribution v a point of their platform to start the enrollment process. The URLs for iOS and Android devices are ali b https://itunes.apple.com/us/app/microsoft-intune-company-portal/id719171358?mt=8 and el f https://play.google.com/store/apps/details?id=com.microsoft.windowsintune.companyportal&hl=en r e e respectively. This is not necessary for Windows Phone devices because MDM management through this o c f service is native to the device. h a r eg 4.1.1 iOS f r o m Device enrollment for iOS devices is described in the following material. h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 1. Download the Company Portal application from the application store and log in using Office 365 credentials NIST SP 1800-4C: Mobile Device Security 84T h si p u b cil a t oi n si a v a ali b el f r e e o 2. The user will then be asked to enroll their device and accept the organization’s policies f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3. Before accepting the management profile, the user can see the specifics of the profile and certificates that are issued NIST SP 1800-4C: Mobile Device Security 85T h si p u b cil a t oi n si a v a ali b el f r e e o 4. Upon accepting the management profile, the device will be enrolled, and the user will receive f c this confirmation message h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . In order to gain full access to company resources, the user will need to check their device for compliance. This screen will pop up when the user taps on their device in Company Portal NIST SP 1800-4C: Mobile Device Security 86T h si p u b cil a t oi n si a v a ali b el f r e e o 5. The compliance checking process will take a couple of minutes, and the user can minimize the f c application during this process h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 6. Upon minimizing the Company Portal application during the compliance checking process, the user is presented with the password remediation process, alerting the user to change their passcode within the hour NIST SP 1800-4C: Mobile Device Security 87T h si p u b cil a t oi n si a v a ali b el f r e e o 7. After meeting compliance, the user’s device should be listed in the Company Portal like the f c example above h a r g e 4.1.2 Android f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 1. After launching the Company Portal, click Next NIST SP 1800-4C: Mobile Device Security 88T h si p u b cil a t oi n si a v a ali b el f r e e o 2. Enter your email address f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3. If implementing a hybrid architecture, you will be redirected to your enterprise login site to enter your password. Otherwise, enter password and click Sign In. The user will be notified when they are signing into the Company Portal and when their device is being enrolled NIST SP 1800-4C: Mobile Device Security 89T h si p u b cil a t oi n si a v a ali b el f r e e o 4. Click Activate to allow remote management of the device f c h ra 4.1.3 Windows Phone 8.1 g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 1. First, the user must add a workplace to their device. To do so on Windows Phone 8 and 8.1 devices navigate to settings > system tab > workplace (WP8.1) or settings > system tab > company apps (WP8) NIST SP 1800-4C: Mobile Device Security 90T h si p u b cil a t oi n si a v a ali b el f r e e o 2. The workplace application will attempt to connect to your company’s management portal. We f c used the manage.microsoft.com portal h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 3. After connecting to your company’s portal, the device should now be able to be managed by Office 365. To do this, download Company Portal from the App Store to finish enrolling the device and receive your organization’s policies NIST SP 1800-4C: Mobile Device Security 91T h si p u b cil a t oi n si a v a ali b el f r e e o 4. Upon logging into Company Portal for the first time, the user will be notified that their device f c hasn’t met compliance and that some resources will be restricted h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 5. After the user checks the compliance manually (less than five minutes), the user’s device is fully enrolled and should have the appropriate policies deployed NIST SP 1800-4C: Mobile Device Security 92T h si p u b cil a t oi n si a v a ali b el f r e e o 6. The screenshot above displays the details and policy compliance status of how a compliant and f c fully enrolled device should look h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 7. Once compliance has been met, the user should be able to tap the activation link to activate their email access NIST SP 1800-4C: Mobile Device Security 93T h si p u b cil a t oi n si a v a ali b el f r e e o 8. The activation link will open a browser. Upon successful activation, the user should receive this f c page. At this point, the user should have full access to Exchange email/contacts/calendar h a r g e 4.1.4 Email Setup f r o m The following section steps through the setup of email clients on iOS, Android, and Windows Phone. For h : iOS and Android, we use the Outlook client from Microsoft in the App Store and Play Store. The native t t p s email capabilities are used with Windows Phone. Other third-party applications are available, but this /: d/ guide makes no assumptions regarding the security of these applications. o o.i Implementers may choose to have users configure an email client on their devices manually or create an r g 1/ SCCM profile, which automatically configures enrolled devices. At the time of writing this practice guide, 0 6. only iOS and Microsoft mobile devices were supported. Consult SCCM documentation for the latest 0 2 capabilities. 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 944.1.4.1 iOS T h si p u b cil a t oi n si a v a ali b el f r e e o f c h 1. When the user first opens the settings application — before, during, or after the compliance a r g check — they are prompted for their Office 365 password for the Exchange profile that is e rf provisioned during the onboarding process. (This is a onetime occurrence) o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. The user will receive this email the first time they open their email client NIST SP 1800-4C: Mobile Device Security 95T h si p u b cil a t oi n si a v a ali b el f r e e o 3. To activate their email access, the user will have to tap the link to activate the email and check f c for compliance h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 4. After activating their email, the user will be presented with an enrollment activated confirmation page NIST SP 1800-4C: Mobile Device Security 964.1.4.2 Android T h si p u b cil a t oi n si a v a ali b el f r e e o f c h 1. Open the Outlook application on your device a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. Choose Office 365 NIST SP 1800-4C: Mobile Device Security 97T h si p u b cil a t oi n si a v a ali b el f r e e o 3. Log in with your enterprise credentials f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 4. Note that if you are using the hybrid build, a single sign-on workflow is initiated. The device owner will be redirected to their local sign-in service NIST SP 1800-4C: Mobile Device Security 98T h si p u b cil a t oi n si a v a ali b el f r e e o 5. If the device has not been enrolled with the MDM, a prompt is presented to do so f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 6. A device that is out of compliance with the MDM policy will not have access to Office 365 services. The device owner is forced to remediate the device NIST SP 1800-4C: Mobile Device Security 99T h si p u b cil a t oi n si a v a ali b el f r e e o The device owner is granted access to Office 365 after the device complies with policy f c h a 4.1.4.3 Windows Phone 8.1 r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 1. To get full access to Exchange resources as well as email, use the built-in email client to add an Exchange account. In the email client, tap the three horizontal dots on the bottom right and tap add account to bring up the account select page. Or under settings > email+ accounts add the Office 365 Exchange account credentials 2. Log in using Office 365 credentials; the server information should auto-populate NIST SP 1800-4C: Mobile Device Security 100T h si p u b cil a t oi n si a v a ali b el f r e e o 3. Upon successfully syncing the Exchange account, an email explaining the enrollment process f c should be received requesting that the user enroll/check for compliance h a r g e 4.1.4.4 Windows 8.1 f r o m Email profiles for Windows Mobile 8.1 were configured using the following steps. h : tt 1. The user can add their account to the built-in email application by selecting Exchange account p s /: and adding their email@customdomain and password. The email application should be able to / d pull the settings o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 101T h si p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. Upon connecting to their Exchange account, the user should receive an email asking them to activate their email by clicking the link to check compliance NIST SP 1800-4C: Mobile Device Security 1024.1.5 Lookout MTP Enrollment T h si p u b cil a t oi n si a v a ali b el f r e e o 1. Open the Lookout Mobile Threat Protection (MTP) administrative console with a browser. f c Navigate to https://mtp.lookout.com/les/devices/enroll and type the target user’s email h a r address into the provided web field g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. The mobile device user will receive an email with an activation code that must be used to activate the application NIST SP 1800-4C: Mobile Device Security 1034.1.5.1 Android T h si p u b cil a t oi n si a v a ali b el f r e e o f c ah 1. Find the MTP application from the Google Play Store by searching “lookout” r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 2. Select the Lookout Security for Work application NIST SP 1800-4C: Mobile Device Security 104T h si p u b cil a t oi n si a v a ali b el f r e e o 3. Enter the activation code retrieved from the enrollment email f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 4. Select OK after the activation code is validated NIST SP 1800-4C: Mobile Device Security 105T h si p u b cil a t oi n si a v a ali b el f r e e o 5. The application will proceed to scan the device. f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . 6. The application notifies the user of any threats on the device NIST SP 1800-4C: Mobile Device Security 106Appendix A List of Acronyms AD Active Directory ADDS Active Directory Domain Service ADFS Active Directory Federation Services T h si APN Apple Push Notification p u b cil BYOD Bring Your Own Device a t oi n COPE Corporately Owned, Personally Enabled si a v DMZ Demilitarized Zone a ali b el DNS Domain Name System f r e e EMM Enterprise Mobility Management o f c h HTTP Hypertext Transfer Protocol a r g e f HTTPS Hypertext Transfer Protocol Secure r o m h : ISP Internet Service Provider t t p s /: LAN Local Area Network / d o o.i MDM Mobile Device Management r g / 1 0 MDS Mobile Device Security 6. 0 2 8 MGMT Management Network / N SI T MTP Mobile Threat Protection S. P 1. 8 NCCoE National Cybersecurity Center of Excellence 0 0 - .4 NIST National Institute of Standards and Technology NSA National Security Agency OU Organizational Unit PEM Privacy Enhanced Mail SCW Security Configuration Wizard NIST SP 1800-4C: Mobile Device Security 107SP Special Publication SSL Secure Sockets Layer TLS Transport Layer Security UPN User Principal Name WAN Wide Area Network T h si WAP Wireless Access Point p u b cil a t oi n si a v a ali b el f r e e o f c h a r g e f r o m h : t t p s /: / d o o.i r g / 1 0 6. 0 2 8 / N SI T S. P 1. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 108Appendix B References  International Data Corporation, Android and iOS Squeeze the Competition, Feb. 24, 2015. Availa- ble: https://www.businesswire.com/news/home/20150224006498/en/Android-iOS-Squeeze- Competition-Swelling-96.3-Smartphone.  Internet Corporation for Assigned Names and Numbers-Accredited Registrars, Dec. 11, 2018. Available: https://www.icann.org/registrar-reports/accredited-list.html.  Apple website for pricing information and more details regarding certificates. Available: T https://developer.apple.com. h si  Microsoft, “Plan for third-party SSL certificates for Office 365,” Oct. 23, 2017. Available: p u https://docs.microsoft.com/en-us/office365/enterprise/plan-for-third-party-ssl-certificates. b acil  Microsoft, “Understanding Certificate Requirements,” July 22, 2014. Available: https://docs.mi- t oi crosoft.com/en-us/previous-versions/exchange-server/exchange-141/gg476123(v=exchg.141). n si  Microsoft, “Install Active Directory Domain Services (Level 100),” May 30, 2017. Available: a av https://technet.microsoft.com/en-us/library/hh472162.aspx. ali b  Microsoft, “Use a lab environment for your devops,” May 1, 2017. Available: https://docs.mi- el f crosoft.com/en-us/visualstudio/test/lab-management/using-a-lab-environment-for-your-applica- r ee tion-lifecycle?view=vs-2017. o c f  Microsoft, “How To Install ADFS 2012 R2 For Office 365,” Apr. 28, 2014. Available: h a http://blogs.technet.com/b/rmilne/archive/2014/04/28/how-to-install-adfs-2012-r2-for-of- r eg fice-365.aspx. f r o  Microsoft, Office 365 and ADFS…Active Directory Federation Service Installation, Feb. 10, 2018. m h : Available: https://social.technet.microsoft.com/wiki/contents/articles/9082.office-365-and-adfs- tt active-directory-federation-service-installation.aspx?Redirected=true. p s /:  Microsoft, Test Lab Guide: System Center 2012 Configuration Manager. Available: / od https://www.microsoft.com/en-us/download/confirmation.aspx?id=30443. ro.i  Microsoft, Azure Active Directory Sync, Nov. 8, 2015. Available: https://docs.microsoft.com/en- g 1/ us/previous-versions/azure/azure-services/dn790204(v%3dazure.100). 0 6.  Microsoft, Geek of All Trades: Office 365 SSO: A Simplified Installation Guide, Aug. 30. 2016. Avail- 0 2 8 able: https://docs.microsoft.com/en-us/previous-versions/technet-maga- / N zine/jj631606(v=msdn.10). SI T S.  Microsoft, Manage settings and features on your devices with Intune policies, June 13, 2018. P 1. Available: https://technet.microsoft.com/en-us/library/dn913730.aspx. 8 0 0 - 4 . NIST SP 1800-4C: Mobile Device Security 109